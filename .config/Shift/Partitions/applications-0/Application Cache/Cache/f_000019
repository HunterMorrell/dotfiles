(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[9],{"0447af78a21f7c7312e2":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("dd7710060b79460ec18c");function o(e,t){return new this(e,i.ClonedEventType.Single,t)}function a(e){return new this(null,i.ClonedEventType.Single,e)}t.createSingleEvent=function(e,t,n){var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.logData=t?o:a,n}(i.EventBase);return i.addEventProps(s.prototype,e,t||{},n),s}},"052cdcf43c3b8e9a238f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("dd7710060b79460ec18c"),o=n("d6e6a1e726db94fe6759"),a=n("22e720316fb8bade1b0e");function s(e){var t,n,a={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:i.ClonedEventType[e.eventType]};e.eventType===i.ClonedEventType.End&&(a.Duration=e.endTime-e.startTime);var s=e.eventName.split(",");try{for(var u=r.__values(s),c=u.next();!c.done;c=u.next()){var d=c.value;d&&(a["WebLog_Type_"+d]=1)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}var l=e.data,f=e.context;if(f)for(var p in f)if(Object.prototype.hasOwnProperty.call(f,p)){if(null==(_=f[p]))continue;a[m=o.capitalize(p)]=_}if(l)for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)){var _;if(null==(_=l[h]))continue;var g=e.metadata[h];if(g){var m=g.isPrefixingDisabled?o.capitalize(h):o.capitalize(g.definedInName)+"_"+h,v=g.type;if(4===v)for(var y in _)void 0!==_[y]&&(a[m+"_"+y.replace(".","_")]=_[y]);else a[m]=6===v?g.typeRef[_]:_}}return{name:e.isEventTypePrefixingDisabled?s[s.length-2]:"ev_"+s[s.length-2],values:a}}t.getAriaEventInfo=s,t.buildAriaEvent=function(e,t){var n=s(t),r=n.name,i=n.values,o=new e.EventProperties;return o.name=r,function(e,t,n){var r;try{for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r=i,t.setProperty(i,n[i]))}catch(t){var o=void 0,s=void 0;throw t instanceof e.Exception&&(o=t.ErrorCode(),s=new Error("Aria error: "+t.toString())),s&&(t.handled=!0,a.logError(s,{errorCode:o,propertyKey:r})),t}}(e,o,i),o}},"0b8514f932f40951d460":function(e,t,n){"use strict";n.r(t),n.d(t,"SignalPromise",function(){return G}),n.d(t,"CancelablePromise",function(){return z});var r=n("98bae3dbabd51089d613"),i=n("e1c8dc4e514231c05155");function o(e){window.setTimeout(function(){i.c(q,g,{error:e})},0)}var a,s,u,c,d,l,f,p,h,_,g="error",m="Canceled",v=1;function y(){}function T(e,t){e._value=t,e._setState(q.isPromise(t)?u:f)}function S(e,t,n,r,i,o){return{exception:e,error:t,promise:n,handler:o,id:r,parent:i}}function E(e,t,n,r){var i=n._isException;return S(i?t:null,i?null:t,e,n._errorId,n,r)}function b(e,t,n){var r=n._isException,i=n._errorId;return N(e,i,r),S(r?t:null,r?null:t,e,i,n)}function I(e,t){var n=++v;return N(e,n),S(null,t,e,n)}function R(e,t){var n=++v;return N(e,n,!0),S(t,null,e,n)}function D(e,t,n){P(e,{c:t,e:n})}function w(e,t,n,r){e._value=t,A(e,t,n,r),e._setState(h)}function C(e,t){var n,r,i=e._value,o=e._listeners;if(o)for(e._listeners=null,n=0,r=o.length;n<r;n++){var a=o[n],s=a.c,c=a.promise;if(c){try{c._setCompleteValue(s?s(i):i)}catch(e){c._setExceptionValue(e)}c._state!==u&&c._listeners&&t.push(c)}else V.prototype.done.call(e,s)}}function O(e,t){var n,r,i=e._value,o=e._listeners;if(o)for(e._listeners=null,n=0,r=o.length;n<r;n++){var a=o[n],s=a.e,c=a.promise;if(c){try{s?(s.handlesOnError||A(c,i,E,e,s),c._setCompleteValue(s(i))):c._setChainedErrorValue(i,e)}catch(e){c._setExceptionValue(e)}c._state!==u&&c._listeners&&t.push(c)}else k.prototype.done.call(e,null,s)}}function A(e,t,n,r,o){t instanceof Error&&t.message===m||i.c(q,g,n(e,t,r,o))}function P(e,t){var n=e._listeners;n?n.push(t):n=[t],e._listeners=n}function N(e,t,n){e._isException=n||!1,e._errorId=t}function U(e,t,n,r){e._value=t,A(e,t,n,r),e._setState(_)}function x(e,t){var n;n=q.isPromise(t)?u:p,e._value=t,e._setState(n)}function M(e,t,n){var r=new j(e);return P(e,{promise:r,c:t,e:n}),r}a={name:"created",enter:function(e){e._setState(s)},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y},s={name:"working",enter:y,cancel:function(e){e._setState(d)},done:D,then:M,_completed:T,_error:w,_notify:y,_setCompleteValue:x,_setErrorValue:U},u={name:"waiting",enter:function(e){var t=e._value;if(t instanceof j&&t._state!==_&&t._state!==p)P(t,{promise:e});else{var n=function(r){t._errorId?e._chainedError(r,t):(A(e,r,E,t,n),e._error(r))};n.handlesOnError=!0,t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(c)},done:D,then:M,_completed:T,_error:w,_notify:y,_setCompleteValue:x,_setErrorValue:U},c={name:"waiting_canceled",enter:function(e){e._setState(l);var t=e._value;q.is(t)&&t.cancel()},cancel:y,done:D,then:M,_completed:T,_error:w,_notify:y,_setCompleteValue:x,_setErrorValue:U},d={name:"canceled",enter:function(e){e._setState(l),e._cancelAction()},cancel:y,done:D,then:M,_completed:T,_error:w,_notify:y,_setCompleteValue:x,_setErrorValue:U},l={name:"canceling",enter:function(e){var t=new Error(m);t.name=t.message,t._handled=!0,e._value=t,e._setState(h)},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y},f={name:"complete_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())._state._notify(n,t);e._setState(p)},cancel:y,done:function(e,t,n){return V.prototype.done.call(e,t,n)},then:function(e,t,n){return V.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:C,_setCompleteValue:y,_setErrorValue:y},p={name:"success",enter:function(e){e._cleanupAction()},cancel:y,done:function(e,t,n){return V.prototype.done.call(e,t,n)},then:function(e,t,n){return V.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:C,_setCompleteValue:y,_setErrorValue:y},h={name:"error_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())._state._notify(n,t);e._setState(_)},cancel:y,done:function(e,t,n){return k.prototype.done.call(e,t,n)},then:function(e,t,n){return k.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:O,_setCompleteValue:y,_setErrorValue:y},_={name:"error",enter:function(e){e._cleanupAction()},cancel:y,done:function(e,t,n){return k.prototype.done.call(e,t,n)},then:function(e,t,n){return k.prototype.then.call(e,t,n)},_completed:y,_error:y,_notify:O,_setCompleteValue:y,_setErrorValue:y};var B,k=function(){function e(e,t){void 0===t&&(t=I),this._value=e,A(this,e,t)}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||A(null,n,E,this,t);var r=t(n);return void(q.is(r)&&r.done())}catch(e){n=e}n instanceof Error&&n.message===m||o(n)},e.prototype.then=function(e,t){if(!t)return this;var n,r=this._value;try{t.handlesOnError||A(null,r,E,this,t),n=new V(t(r))}catch(e){n=e===r?this:new L(e)}return n},e.prototype.catch=function(e){return this.then(void 0,e)},e}(),L=function(e){function t(t){return e.call(this,t,R)||this}return r.__extends(t,e),t}(k),V=function(){function e(e){if(q.isPromise(e)){var t=new j(void 0);return t._setCompleteValue(e),t}this._value=e}return e.prototype.cancel=function(){},e.prototype.done=function(e){if(e)try{var t=e(this._value);q.is(t)&&t.done()}catch(e){o(e)}},e.prototype.then=function(t){var n;try{var r=t?t(this._value):this._value;n=this._isSameValue(r)?this:new e(r)}catch(e){n=new L(e)}return n},e.prototype.catch=function(e){return this.then(void 0)},e.prototype._isSameValue=function(e){return e===this._value},e}();function F(e){var t;return new q(function(n){t=window.setTimeout(n,e)},function(){t&&window.clearTimeout(t)})}function W(e){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];q.as(e[r]).cancel()}}}var q=function(){function e(e,t){this._init(e,t)}return Object.defineProperty(e,"cancel",{get:function(){return B||(B=new k(new Error(m)))},enumerable:!0,configurable:!0}),e.any=function(t){return new e(function(n,r){var i=Object.keys(t),o=i.length;0===o&&n();for(var a=function(i){e.as(t[i]).then(function(){n({key:i,value:t[i]})},function(a){a instanceof Error&&a.name===m?0==--o&&n(e.cancel):r({key:i,value:t[i]})})},s=0,u=i;s<u.length;s++){a(u[s])}},W(t))},e.race=function(t){return new e(function(n,r){var i=Object.keys(t),o=i.length;0===o&&n();for(var a=0,s=i;a<s.length;a++){var u=s[a];e.as(t[u]).then(n,function(t){t instanceof Error&&t.name===m?0==--o&&n(e.cancel):r(t)})}},W(t))},e.as=function(t){return e.is(t)?t:new V(t)},e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel},e.isPromise=function(e){return e&&"object"==typeof e&&"function"==typeof e.then},e.isCanceled=function(e){return e instanceof Error&&e.name===m},e.all=function(t){return new e(function(n,r){for(var i=Object.keys(t),o=Array.isArray(t)?[]:{},a=Array.isArray(t)?[]:{},s=i.length,u=function(){if(0==--s){var t=Object.keys(o);0===t.length?n(a):t.every(function(t){return e.isCanceled(o[t])})?n(e.cancel):r(o)}},c=function(n){var r=t[n];void 0===r?s--:e.then(r,function(e){a[n]=e,u()},function(e){o[n]=e,u()})},d=0,l=i;d<l.length;d++){c(l[d])}0===s&&n(a)},W(t))},e.then=function(t,n,r){return e.as(t).then(n,r)},e.thenEach=function(t,n,r){for(var i=Array.isArray(t)?[]:{},o=0,a=Object.keys(t);o<a.length;o++){var s=a[o];i[s]=e.then(t[s],n,r)}return e.all(i)},e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())},e.timeout=function(e,t){var n=F(e);return t?function(e,t){var n=function(){e.cancel()};return e.then(function(){t.cancel()}),t.then(n,n),t}(n,t):n},e.wrap=function(e){return new V(e)},e.resolve=function(t){return e.wrap(t)},e.wrapError=function(e){return new k(e)},e.reject=function(t){return e.wrapError(t)},e.prototype.cancel=function(){this._state.cancel(this),this._run()},e.prototype.done=function(e,t){this._state.done(this,e,t)},e.prototype.then=function(e,t){return this._state.then(this,e,t)},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype._init=function(e,t){this._oncancel=t,this._setState(a),this._run();try{e(this._completed.bind(this),this._error.bind(this))}catch(e){this._setExceptionValue(e)}},e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}},e.prototype._cleanupAction=function(){this._oncancel=null},e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,b,t);return this._run(),n},e.prototype._completed=function(e){var t=this._state._completed(this,e);return this._run(),t},e.prototype._error=function(e){var t=this._state._error(this,e,I);return this._run(),t},e.prototype._setState=function(e){this._nextState=e},e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e),this._run()},e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,b,t);return this._run(),n},e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,R);return this._run(),t},e.prototype._run=function(){for(;this._nextState;)this._state=this._nextState,this._nextState=null,this._state.enter(this)},e.prototype._isSameValue=function(e){return e===this._value},e}();i.a(q,g);var j=function(e){function t(t){var n=e.call(this)||this;return n._creator=t,n._initThen(),n}return r.__extends(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()},t.prototype._cleanupAction=function(){this._creator=null},t.prototype._initThen=function(){this._setState(a),this._run()},t}(q),G=function(e){function t(t){var n=e.call(this)||this;return n._oncancel=t,n._initSignal(),n}return r.__extends(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()},t.prototype._cleanupAction=function(){this._oncancel=null},t.prototype._initSignal=function(){this._setState(a),this._run()},t}(q),z=q;t.default=z},"11822ca032e86a04398f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("d68e89db2f5df7104c07"),i=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent=r.Empty,this.current=t||r.generate()}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e},e.prototype.toString=function(){return this.root+"#"+this.parent+"#"+this.current},e.RootVector=e._getCorrelationVector(),e}();t.CorrelationVector=i},"13e40aa9f992db5e9396":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("f89d5af06abf23eb5d7d"),o=n("2231d4b2f5084c1aefe5"),a="eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984",s=function(e){function t(t){var i=this,s=t.userAuthToken,u=s&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(s),c=t.context,d=void 0===c?{}:c,l=t.clientName,f=t.correlationId,p=t.environment,h=void 0===p?t.ariaEnvironment||"prod":p,_=t.language,g=void 0===_?d.Market:_,m=t.scenario,v=void 0===m?"Unknown":m,y=t.version,T=void 0===y?"Unknown":y,S=t.ariaLoader,E=void 0===S?function(){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){return n("16e0e7de7c7a198c78cc")})];case 1:return[2,e.sent().aria]}})})}:S,b=u&&u.puid?"Business":"Unknown",I=u&&u.app_displayname||"Unknown",R=u&&u.appid||"Unknown",D=u&&u.puid||"Unknown",w=D?1:0,C=u&&u.tid||"Unknown";return i=e.call(this,{ariaLoader:E,context:r.__assign({AccountType:b,AppName:I,AppId:R,ClientName:l,CorrelationId:f,Environment:h,IsAuthenticated:w,Market:g,Scenario:v,Session:o.generate(),SiteSubscriptionId:C,UserId:D,Version:T,Workload:"SharedControls"},d),tenantToken:a})||this}return r.__extends(t,e),t}(i.AriaTelemetryHandler);t.SharedAriaTelemetryHandler=s},"16e0e7de7c7a198c78cc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aria=n("5f18827c166f02fc8d18")},"16f7a8beee83cf78aabb":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("8f87efd00acf85bf14b3");var o=function(){function e(){this._handlers=[],this._buffer=[],this._validationLoggers=[],this._featureEnablers=[]}return Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!0,configurable:!0}),e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.cleanString=function(e){return e},e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;return t.push(e),n.slice()},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}},e.prototype.logEvent=function(e,t){var n=this._buffer,o=this._handlers,a=Object.freeze({data:i.deepCopy(e.data),context:r.__assign({},e.context),id:e.id,enabled:e.enabled,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,validationErrors:e.validationErrors,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled});n.push(a),n.length>100&&(n.splice(1,1/0),0===o.length&&new Error("Logging buffer overflow hit before any logging handler was registered"));for(var s=0;s<o.length;s++)try{o[s](a)}catch(e){}},e.prototype.addValidationErrorLogger=function(e){this._validationLoggers.push(e)},e.prototype.removeValidationErrorLogger=function(e){var t=this._validationLoggers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.logValidationError=function(e,t){var n,i,o=this._validationLoggers;try{for(var a=r.__values(o),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},e.prototype.isFeatureEnabled=function(e){var t,n,i=this._featureEnablers;try{for(var o=r.__values(i),a=o.next();!a.done;a=o.next()){if((0,a.value)(e))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},e.prototype.addFeatureEnabler=function(e){this._featureEnablers.push(e)},e.prototype.removeFeatureEnabler=function(e){var t=this._featureEnablers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0},e}();function a(){return new o}t.createManager=a,t.Manager="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||a():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||a():a()},"173e9cfb7855b90005c4":function(e,t,n){"use strict";var r,i=n("6631b0451e9f577f414d"),o=n("edc85ca7e3cf7e290237"),a=n("bd0254dab5bf8910cafc"),s=Object(a.createSingleEvent)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4}),u=n("fb4333b46afac6cae82a"),c=n("f30b55e34961feeae484");n.d(t,"a",function(){return d}),n.d(t,"b",function(){return p}),function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped"}(r||(r={}));var d=function(){return function(e,t,n,r,i,o,a){this.url=e,this.duration=t,this.correlationId=n,this.status=r,this.startTime=i,this.endTime=o,this.name=a}}(),l=["EUPL","ScenarioId"],f=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,p=function(){return function(e,t,n,r,i,o,a){this.controlId=e,this.startTime=t,this.endTime=n,this.renderTimeCalculator=r,this.renderTimeRequiredDataChecker=i,this.ignoreForEUPL=void 0===o||o,this.needFlatten=void 0!==a&&a}}();function h(e){return null==e}var _={checkInterval:100,error_timeout:3e4,max_markers:100},g=function(){function e(e,t,n){void 0===n&&(n=_),this._keyMetrics=l,this.async=new i.a(this),this.dataStartTime=Number((new Date).getTime()),this._rumoneData={},this.dataState=r.Incomplete,this.controls=[],this.apis=[],this.euplBreakDown={},this.serverMetrics={},this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.tempData={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._name=e,this.loggingFunc=t,this._config=n,this.setPerfDataTimer(),this._platformDetection=new u.a,this._hookUnloadEvent()}return e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__"),void 0===r&&(r=_);var i=n||function(e,t){s.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var o=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=o),e.Loggers[t]=o}catch(e){}return e.Loggers[t]},Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){return this._keyMetrics},enumerable:!0,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData},e.prototype.resetLogger=function(){this._emergencyUpload(),this.dataStartTime=(new Date).getTime(),this.dataState=r.Incomplete,this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.controls=[],this.apis=[],this.tempData={},this._rumoneData={},this._excludePageData=!1,this._waitOnAddingExpectedControl=!1,this._keyMetrics=l,this.clearPerfDataTimer(),this.setPerfDataTimer(),this.euplBreakDown={},this.serverMetrics={},this.clearResourceTimings(),Object(c.b)(this._getOwnMakers().map(function(e){return e.name})),e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this.logMessageInConsole("Reset performance Logger Done")},e.prototype.excludePageForPerfData=function(){this._excludePageData=!0},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&f.test(e)?(this._rumoneData[e]=t,!0):(console.error("key "+e+" does not confrim to the Regex "+f),!1)},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e},e.prototype.writeServerUrl=function(e){this._rumoneData.ServerUrl||(this._rumoneData.ServerUrl=e||window.location.href)},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t)},e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}},e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)},e.prototype.readAPICallPerformanceData=function(){return this.apis},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.a.fullPageLoad&&e!==o.a.none&&e!==o.a.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)},e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}},e.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++){var r=null;try{r=t[n].contentWindow.performance}catch(e){}r&&r.getEntriesByType&&e.concat(r.getEntriesByType("resource"))}var i={SharePoint:function(e){return/\.sharepoint\.com|\.spoppe\.com/i.test(e.name)},CDN:function(e){return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name)},ThirdParty:function(e){return!i.SharePoint(e)&&!i.CDN(e)}},o={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},a=Object.keys(i);for(n=0;n<a.length;n++){var s=a[n],u=this.categorizeResourceRequests(e,{from:i[s],requestType:null});this._logRUMOneData(s+"RequestCountTotal",u.length);for(var c=Object.keys(o),d=0;d<c.length;d++){var l=c[d];this._logRUMOneData(s+"RequestCount"+l,this.categorizeResourceRequests(u,{from:null,requestType:o[l]}).length)}if(u.length>0){this._logRUMOneData(s+"RequestDownloadTime",Math.round(u.reduce(function(e,t){return e+t.duration},0)/u.length));var f=JSON.stringify(u.map(function(e){return{name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0}}));this._logRUMOneData(s+"RequestNames",f)}}this.isW3cResourceTimingCollected=!0}},e.prototype.saveTempData=function(e,t){this.tempData[e]=t},e.prototype.readTempData=function(e){return this.tempData[e]},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)},e.prototype.isRunning=function(){return!(this.dataState===r.Uploaded||this.dataState===r.TimeOut||this.dataState===r.Skipped)},e.prototype.writeEUPLBreakdown=function(e,t){if(e)try{var n=JSON.parse(e);for(var r in n)n.hasOwnProperty(r)&&this.addEUPLBreakdown(r,n[r],t)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}},e.prototype.addEUPLBreakdown=function(e,t,n){if(e&&!h(t)){if(h(this.euplBreakDown[e])||n){var r=this._isBreakdownValue(t)?t.data:t;this.euplBreakDown[e]=r}this._isBreakdownValue(t)&&t.needFlatten&&this._logRUMOneData(e,t.data)}},e.prototype.readEUPLBreakdown=function(e){return e?this.euplBreakDown[e]:this.euplBreakDown},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}},e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!h(e[n])&&(h(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e},e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),Object(c.e)(t)},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e},e.prototype.registerErrorHandler=function(e){},e.prototype.getMarkerTime=function(e){return Object(c.d)(e)},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&this._keyMetrics.indexOf(e)<=-1&&this._keyMetrics.push(e)},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this._waitOnAddingExpectedControl=e},enumerable:!0,configurable:!0}),e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten},e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(c.a.length)+".mark"+n++;t[i]=Math.round(r.startTime)}}),this.writeEUPLBreakdown(JSON.stringify(t))},e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return Object(c.c)().filter(function(e){return-1===r.indexOf(e.name)})},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n=this._name+" "+e+" : "+JSON.stringify(t);console.log(n)}},e.prototype.isCollected=function(e){return!h(this.getPerformanceDataPropertyValue(e))},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e},e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)},e.prototype.clearPerfDataTimer=function(){h(this.perfDataTimer)||(this.async.clearTimeout(this.perfDataTimer),this.perfDataTimer=null)},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n},e.prototype.collectSupplementaryData=function(){this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(null),this.setBrowseInfo(),this.setReferrer(),this._collectMemoryData(),this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown)},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState))),this.logObjectForDebugging("Controls: ",this.controls),this.logObjectForDebugging("API Performance Data: ",this.apis),this.logObjectForDebugging("Temp Data: ",this.tempData),this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown),this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;if(this._updateState(),this.dataState===r.ReadyToUpload)return void this.finishPerfDataUpload();this.processControlRenderTime(),this.readyToComputeEUPL()&&(this.setEUPL(),this._updateState())}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()},e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==r.ReadyToUpload&&!(Number((new Date).getTime())-Number(this.dataStartTime)<=this._config.error_timeout)){this.dataState=r.TimeOut;var e={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(e),this.finishPerfDataUpload()}},e.prototype._updateState=function(){this.dataState=0===this._getMissedKeyMetrics().length&&0===this._getMissedControls().length?r.ReadyToUpload:r.Incomplete},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this._keyMetrics.length;t++){h(this.getPerformanceDataPropertyValue(this._keyMetrics[t]))&&e.push(this._keyMetrics[t])}return e},e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})},e.prototype._emergencyUpload=function(){this.isRunning()&&0===this._getMissedKeyMetrics().length&&this.finishPerfDataUpload(!0)},e.prototype.finishPerfDataUpload=function(e){this.writeControlDataToRUMOne(),this.collectSupplementaryData();try{this.uploadPerfData(e),this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState)))}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this._unhookUnloadEvent()}var t},e.prototype.getReadableDataState=function(e){for(var t in r)if(e===Number(r[t]))return t;return"NaN"},e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++)this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId),this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime);var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}}),Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}},e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(this,n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(this,n.data))}},e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e,"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}},e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile},e.prototype._collectMemoryData=function(){!this.isCollected("UsedJSHeapSize")&&performance&&performance.memory&&(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)},e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=0;n<this.apis.length;n++){var r=this.apis[n];r&&(e++,t+=r.duration,r.url=r.url.split("/").map(function(e){return e.split("?")[0]}).slice(-1)[0].replace(/\(.*?\)/g,"()"))}this._rumoneData.APICallCount=e,this._rumoneData.APICallDurationSum=t,this._rumoneData.APICalls=JSON.stringify(this.apis)},e.prototype.setReferrer=function(){this._rumoneData.Referrer=window.document&&document.referrer},e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"},e.prototype.uploadPerfData=function(e){this._excludePageData?(this.dataState=r.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")):e||this.dataState===r.ReadyToUpload||this.dataState===r.TimeOut?this.loggingFunc?this._rumoneData?(this.loggingFunc("RUMOne",this.getPerformanceData()),this.dataState=r.Uploaded):console.error("Error: Uploading perf data called but perf data is not available"):console.error("Uploading perf data skipped as loggingFunc is not defined"):console.error("Error: Uploading perf data called with wrong data state "+this.dataState)},e.rumOneLogger=void 0,e.Loggers={},e._markers={},e}();t.c=g},"1c8f7532950b71f6d754":function(e,t,n){"use strict";n.r(t),n.d(t,"UriPartial",function(){return r});var r,i=n("5589fc95fa555cd0b06c"),o=n("0a3e1b609e40999fd831");!function(e){e[e.scheme=0]="scheme",e[e.authority=1]="authority",e[e.path=2]="path",e[e.query=3]="query"}(r||(r={}));var a=/[;\/?:@&=$,]/,s=/[\/?]/;function u(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var c=function(){function e(e,t){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",t&&(this._queryCaseInsensitive=!!t.queryCaseInsensitive,this._pathCaseInsensitive=!!t.pathCaseInsensitive),this._parseURI(e)}return e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var o=t[i];i>0&&(o=e.ensureNoPrecedingSlash(o)),i<t.length-1&&(o=e.ensureTrailingSlash(o)),r+=o}return r},e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e},e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e},e.prototype.getScheme=function(){return this._scheme},e.prototype.setScheme=function(e){this._scheme=e},e.prototype.getAuthority=function(){return this._getAuthority(!1)},e.prototype.setAuthority=function(e){this._parseAuthority(e)},e.prototype.getUser=function(){return this._user},e.prototype.getHost=function(){return this._host},e.prototype.getPort=function(){return this._port},e.prototype.getPath=function(e){var t=this._path;return Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1)),t},e.prototype.getLeftPart=function(e){var t=this._scheme+"://";return e===r.authority&&(t+=this.getAuthority()),e===r.path&&(t+=this.getPath()),e===r.query&&(t+=this.getQuery()),t},e.prototype.setPath=function(e){e&&"/"!==e[0]&&(e="/"+e),this._parsePath(e)},e.prototype.getPathSegments=function(){return this._pathSegments},e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""},e.prototype.getQuery=function(e){return this._serializeQuery(e)},e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))},e.prototype.getQueryAsObject=function(){return this._query},e.prototype.setQueryFromObject=function(e){for(var t in this._query={},e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])},e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive)for(var r in e=e.toLowerCase(),n)n.hasOwnProperty(r)&&r.toLowerCase()===e&&(t=n[r]);else t=n[e];return t||null},e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var r=this._decodeQueryString(t);(r||n)&&(this._query[this._decodeQueryString(e)]=r)},e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]},e.prototype.getFragment=function(){return this._fragment},e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1)),this._fragment=this._decodeQueryString(e)},e.prototype.equals=function(e){return Object(o.equalsCaseInsensitive)(this._scheme,e.getScheme())&&this._user===e.getUser()&&Object(o.equalsCaseInsensitive)(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)},e.prototype.equivalent=function(e){return Object(o.equalsCaseInsensitive)(this._scheme,e.getScheme())&&Object(o.equalsCaseInsensitive)(this._user,e.getUser())&&Object(o.equalsCaseInsensitive)(this._host,e.getHost())&&Object(o.equalsCaseInsensitive)(this._port,e.getPort())&&Object(o.equalsCaseInsensitive)(this.getPath(!0),e.getPath(!0))&&Object(i.a)(u(this.getQueryAsObject()),u(e.getQueryAsObject()))&&Object(o.equalsCaseInsensitive)(this._fragment,e.getFragment())},e.prototype.toString=function(e){return this._getStringInternal(!0,e)},e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)},e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)},e.prototype._equalsCaseAppropriate=function(e,t,n){return n?Object(o.equalsCaseInsensitive)(e,t):e===t},e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),r=this.getQuery(e);return r&&(n+="?"+r),this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment)),n},e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var r=this._getAuthority(e,t);return r&&(n+="//"+r),this._pathEncoded&&(n+=e?this._pathEncoded:this._path),n},e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,r=e.split(/[;&]+/);n<r.length;n++){var i=r[n],o=i.indexOf("=");o<0&&(o=i.length),o>0&&(t[i.substr(0,o)]=i.substr(o+1))}return t},e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var r=n,i=this._query[n];e&&(r=encodeURIComponent(r),i=encodeURIComponent(i)),t+=null===i||""===i?r+"=&":r+"="+i+"&"}return""!==t&&(t=t.slice(0,-1)),t},e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var r=t.substring(n+1);this.setFragment(r),t=t.substring(0,n)}var i=t.search(a);if(i>=0){":"===t[i]&&(this.setScheme(t.substring(0,i)),t=t.substring(i+1));var o="";if(0===t.indexOf("//")){var u=(t=t.substring(2)).search(s);if(u>=0?(o=t.substring(0,u),t=t.substring(u)):(o=t,t=""),this.setAuthority(o),!t)return void this.setPath("")}var c=t.indexOf("?");c>=0&&(this.setQuery(t.substring(c+1)),t=t.substring(0,c)),this.setPath(t)}else this.setPath(t)},e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var r=e;t<0?this._host=r:(this._user=r.substring(0,t),this._host=r.substring(t+1)),n>=0&&(this._port=this._host.substring(n+1),this._host=this._host.substring(0,n)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host)}},e.prototype._parsePath=function(e){this._path=decodeURIComponent(e);var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),r=0;r<n.length;++r)t[r]=decodeURIComponent(n[r]);""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()},e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,r,i,o=t&&t.doNotPercentEncodeHost,a="";return e?(n=encodeURIComponent(this._user).replace("%3A",":"),r=o?this._host:encodeURIComponent(this._host),i=encodeURIComponent(this._port)):(n=this._user,r=this._host,i=this._port),""!==n&&(a=n+"@"),""!==this._host&&(a+=r),""!==this._port&&(a+=":"+i),a},e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t},e}();t.default=c},"2231d4b2f5084c1aefe5":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("98bae3dbabd51089d613").__exportStar(n("d68e89db2f5df7104c07"),t)},"22e720316fb8bade1b0e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("617dcfa84bb3a8c48ca3"),i=n("8ee2449079216aae4676"),o=n("534e76aea4c1da2e9f7d"),a=n("fb198614f77f87ac4d1b"),s=n("347053043e453fed139f"),u="Canceled",c=new a.CircularBuffer(50);function d(e,t,n){if(e&&!function(e){return e===u||!!e&&"object"==typeof e&&"name"in e&&e.name===u||!!e&&"object"==typeof e&&"message"in e&&e.message===u}(e)){for(var a,s=l(e),d=(e&&"object"==typeof e&&"stack"in e&&e.stack?e.stack:"");a=c.popOldest();)o.Verbose.logData(a);n&&n.eventName?i.QosError.logData({name:n.eventName,resultCode:n.resultCode,resultType:n.resultType,extraData:t||{},message:s,stack:d}):r.CaughtError.logData({extraData:t||{},message:s,stack:d})}}function l(e){var t="";return e&&("object"==typeof e&&"message"in e?t=e.message:"object"==typeof e&&"description"in e?t=e.description:"object"==typeof e?t=s.safeSerialize(e):e.toString&&(t=e.toString())),t}t.verbose=function(e,t){c.push({name:t,message:e})},t.logError=d,t.log=function(e,t,n,r){d(e,void 0,{eventName:t,resultCode:n,resultType:r})},t.getErrorMessage=l},"256c2b1df06b9b785912":function(e,t,n){"use strict";var r=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(;this._callbacks.length;){this._callbacks.pop().call(this._owner)}},e}();var i=function(){function e(){this._disposables={},this._lastDisposableId=0}return e.prototype.attached=function(e){var t=this,n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.attach(e.apply(this,n)||this)};if("undefined"!=typeof DEBUG&&DEBUG){var r=n;n=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.apply(Object.create(e.prototype),t)}}return n.prototype=e.prototype,n},e.prototype.attach=function(e){var t=this,n=""+ ++this._lastDisposableId,i=function(e,t){var n=e,i=n.dispose,o="function"==typeof i&&i.disposalChain;if(!o){o=new r(n);var a=function(){o.dispose(),i&&(n.dispose=i,n.dispose())};n.dispose=a,a.disposalChain=o}return o.addCallback(t),n}(e,function(){delete t._disposables[n]});return this._disposables[n]=i,i},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i&&"function"==typeof i.dispose&&i.dispose(),delete e[r]}},e}();t.a=i},"31c1cddf44fcb4b5ef81":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(t.ResultTypeEnum||(t.ResultTypeEnum={}))},"347053043e453fed139f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSerialize=function(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){return t===window?"[window]":t instanceof HTMLElement?"[HTMLElement]":"function"==typeof t?"[function]":"object"==typeof t?null===t?t:-1===n.indexOf(t)?(n.push(t),t):"[circular]":t})}catch(e){t=JSON.stringify("[object]")}return t}},"3807b29c38f48ccb67b1":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("0447af78a21f7c7312e2");t.Engagement=r.createSingleEvent({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:1},isIntentional:{isPrefixingDisabled:!0,type:3},scenario:{isPrefixingDisabled:!0,type:1},location:{isPrefixingDisabled:!0,type:1},usageType:{isPrefixingDisabled:!0,type:1},currentPage:{isPrefixingDisabled:!0,type:1},previousPage:{isPrefixingDisabled:!0,type:1},experiment:{isPrefixingDisabled:!0,type:4},siteId:{isPrefixingDisabled:!0,type:1},webId:{isPrefixingDisabled:!0,type:1},listId:{isPrefixingDisabled:!0,type:1},groupId:{isPrefixingDisabled:!0,type:1},docId:{isPrefixingDisabled:!0,type:1},webTemplateId:{isPrefixingDisabled:!0,type:1},listTemplateId:{isPrefixingDisabled:!0,type:1},siteType:{isPrefixingDisabled:!0,type:1},feature:{isPrefixingDisabled:!0,type:1},component:{isPrefixingDisabled:!0,type:1},extraData:4,objectType:{isPrefixingDisabled:!0,type:1},datasource:{isPrefixingDisabled:!0,type:1},action:{isPrefixingDisabled:!0,type:1}})},"4e087ea06522888b2152":function(e,t,n){"use strict";n.r(t);var r=n("6f8ae5b6dc470397fb69");for(var i in r)["default","default"].indexOf(i)<0&&function(e){n.d(t,e,function(){return r[e]})}(i);n.d(t,"default",function(){return r.Qos})},"534e76aea4c1da2e9f7d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("0447af78a21f7c7312e2"),i=n("806b880959f0be21dbf7");t.Verbose=r.createSingleEvent({eventName:"Verbose,Trace,",shortEventName:"Verbose",requiresParent:!1},{name:{isKey:!0,type:1}},i.Trace)},"5589fc95fa555cd0b06c":function(e,t,n){"use strict";n("e9d155a6651c0bf6c9b0");var r=n("774b0ab3c2d70fcabb2d");n.d(t,"a",function(){return r.deepCompare});var i=n("347053043e453fed139f");n.d(t,"b",function(){return i.safeSerialize})},"55a07aceb8cbadb26c24":function(e,t,n){"use strict";var r=n("9de296873c83e5923274");n.o(r,"createPairedEvent")&&n.d(t,"createPairedEvent",function(){return r.createPairedEvent})},"5f18827c166f02fc8d18":function(e,t,n){var r,i,o,a,s;(r||(r={})).version="2.9.0",function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(e.BondDataType||(e.BondDataType={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.ProtocolType||(e.ProtocolType={}))}((i=o||(o={})).Bond||(i.Bond={})),function(e){!function(e){!function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n}(e.Collections||(e.Collections={}))}(e.Bond||(e.Bond={}))}(o||(o={})),function(e){!function(t){!function(e){var r=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},e}();e.Utf8=r;var i=function(){function e(){}return e.GetString=function(e){var t,n,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],a=e.length%3,s=function(e){return[i.charAt(e>>18&63),i.charAt(e>>12&63),i.charAt(e>>6&63),i.charAt(63&e)].join("")};for(t=0,r=e.length-a;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(s(n));switch(a){case 1:n=e[e.length-1],o.push(i.charAt(n>>2)),o.push(i.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(i.charAt(n>>10)),o.push(i.charAt(n>>4&63)),o.push(i.charAt(n<<2&63)),o.push("=")}return o.join("")},e}();e.Base64=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=o;var a=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},e}();e.Varint64=a;var s=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var r=new DataView(new ArrayBuffer(4));r.setFloat32(0,e,!0);for(var i=[],o=0;o<4;++o)i.push(r.getUint8(o));return i}return n.ConvertNumberToArray(e,!1)},e}();e.Float=s;var u=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var r=new DataView(new ArrayBuffer(8));r.setFloat64(0,e,!0);for(var i=[],o=0;o<8;++o)i.push(r.getUint8(o));return i}return n.ConvertNumberToArray(e,!0)},e}();e.Double=u;var c=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,r=e.high,i=r<<1|n>>>31,o=n<<1;2147483648&r&&(i=~i,o=~o);var a=new t.UInt64("0");return a.low=o,a.high=i,a},e}();e.Zigzag=c}(t.Encoding||(t.Encoding={})),function(r){var i=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];if(r<=191)t.push(String.fromCharCode(r));else if(r<=223){var i=e[++n];t.push(String.fromCharCode((31&r)<<6|63&i))}else if(r<=239){i=e[++n];var o=e[++n];t.push(String.fromCharCode((15&r)<<12|(63&i)<<6|63&o))}else{r=(7&r)<<18|(63&(i=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],r-=65536,t.push(String.fromCharCode(55296|r>>10&1023)),t.push(String.fromCharCode(56320|1023&r))}}return t.join("")},e}();r.Utf8=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<e.length;++r){var i=t.indexOf(e.charAt(r++)),o=t.indexOf(e.charAt(r++)),a=t.indexOf(e.charAt(r++)),s=t.indexOf(e.charAt(r));n.push(i<<2|o>>4),a>=0&&(n.push(o<<4&240|a>>2),s>=0&&n.push(a<<6&192|s))}return n},e}();r.Base64=o;var a=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),r=this._Read(t);return n.low=r[0],r.length>1&&(n.high=r[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,r=!0,i=0;r;){if(r=0!=(128&(o=e.shift())),o&=127,!(i<28)){n|=o<<i,t.push(n),n=o>>4,i=3;break}n|=o<<i,i+=7}for(;r;){var o;if(r=0!=(128&(o=e.shift())),n|=(o&=127)<<i,(i+=7)>=32)break}return t.push(n),t},t}();r.Varint=a;var s=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var r=new DataView(new ArrayBuffer(4)),i=0;i<4;++i)r.setUint8(i,e[i]);return r.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e}();r.Float=s;var u=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var r=new DataView(new ArrayBuffer(8)),i=0;i<8;++i)r.setUint8(i,e[i]);return r.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e}();r.Double=u;var c=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,r=t.high>>>1,i=1&t.low,o=t.low>>>1;o|=n<<31,i&&(o^=4294967295,r^=4294967295);var a=new e.Bond.UInt64("0");return a.low=o,a.high=r,a},t}();r.Zigzag=c}(t.Decoding||(t.Decoding={}));var n=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,i=1-r,o=r,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),u=e-s,c=2*(r+2)+n,d=new Array(c),l=0;l<c;)d[l++]=0;for(l=r+2;l&&s;)d[--l]=s%2,s=Math.floor(s/2);for(l=r+1;l<c-1&&u>0;)(u*=2)>=1?(d[++l]=1,--u):d[++l]=0;for(var f=0;f<c&&!d[f];++f);var p=r+1-f,h=f+n;if(d[h+1]){for(l=h;l>f&&!(d[l]=1-d[l]);--l);l==f&&++p}if(p>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(p<i)return t?this._doubleZero:this._floatZero;if(t){var _=0;for(l=0;l<20;++l)_=_<<1|d[++f];for(var g=0;l<52;++l)g=g<<1|d[++f];return[255&g,g>>8&255,g>>16&255,g>>>24,255&(_=a<<31|2147483647&(_|=p+r<<20)),_>>8&255,_>>16&255,_>>>24]}var m=0;for(l=0;l<23;++l)m=m<<1|d[++f];return[255&(m=a<<31|2147483647&(m|=p+r<<23)),m>>8&255,m>>16&255,m>>>24]},e.ConvertArrayToNumber=function(e,n){var r=(1<<(n?11:8)-1)-1,i=0!=(128&e[n?7:3]),o=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new t.Exception("Not a valid float/double buffer.");var a=1,s=1;if(n){var u=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!u&&!c)return 0;for(var d=0;d<20;++d)s/=2,u<0&&(a+=s),u<<=1;for(d=0;d<32;++d)s/=2,c<0&&(a+=s),c<<=1}else{var l=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!l)return 0;for(d=0;d<23;++d)s/=2,l<0&&(a+=s),l<<=1}return a*=Math.pow(2,o-r),i?0-a:a},e}();n._floatZero=[0,0,0,0],n._doubleZero=[0,0,0,0,0,0,0,0],n._floatInifinity=[0,0,128,127],n._floatNegInifinity=[0,0,128,255],n._doubleInifinity=[0,0,0,0,0,0,240,127],n._doubleNegInifinity=[0,0,0,0,0,0,240,255]}(e.Bond||(e.Bond={}))}(o||(o={})),function(e){!function(e){!function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}();t.MemoryStream=n}(e.IO||(e.IO={}))}(e.Bond||(e.Bond={}))}(o||(o={})),function(e){!function(e){var t=function(){return function(e,t){this.Type=e,this.Id=t}}();e.FieldTag=t;var n=function(){return function(e,t){this.ElementType=e,this.Size=t}}();e.ContainerTag=n;var r=function(){return function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}}();e.KeyValueContainerTag=r;var i=function(){return function(){}}();e.Bonded=i;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.Int64=o;var a=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.UInt64=a;var s=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=s;var u=function(){return function(e){this.Message=e}}();e.Exception=u;var c=function(){return function(){}}();e.KeyValuePair=c;var d=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=d}(e.Bond||(e.Bond={}))}(o||(o={})),function(e){!function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}();e.CompactBinaryProtocolWriter=t;var n=function(){return function(){}}();e.CompactBinaryProtocolReader=n}(e.Bond||(e.Bond={}))}(o||(o={})),function(e){var t=function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();e.indexOf("safari")>=0&&e.indexOf("chrome")<0?t._isSafari=!0:t._isSafari=!1}else t._isSafari=!1;return t._isSafari},t.IsReactNative=function(){return null===t._isReactNative&&("undefined"!=typeof navigator&&navigator.product?t._isReactNative="ReactNative"===navigator.product:t._isReactNative=!1),t._isReactNative},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},t.ajax=function(e,n){var r=t._createConnection();if(e.headers){var i="qsp=true";for(var o in e.headers)i+="&",i+=encodeURIComponent(o),i+="=",i+=encodeURIComponent(e.headers[o]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i}r.open(e.type,e.url,!n),e.complete&&(r.onload=function(){e.complete(r)},r.ontimeout=function(){e.complete(r)},r.onerror=function(){e.complete(r)},r.onabort=function(){e.complete(r)}),r.send(e.data)},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},t.IsUsingXDomainRequest=function(){null==t._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?t._usingXDomainRequest=!0:t._usingXDomainRequest=!1);return t._usingXDomainRequest},t._createConnection=function(){var e=new XMLHttpRequest;return t.IsUsingXDomainRequest()?new XDomainRequest:e},t}();t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,e.Utils=t}(a||(a={})),function(e){!function(e){!function(e){!function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new o.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new o.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();t.utils=n,function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(t.PIIScrubber||(t.PIIScrubber={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.PIIKind||(t.PIIKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.UserIdType||(t.UserIdType={}));var r=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(o.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(o.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.PII=r;var i=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new o.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new o.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,r){var i=new e.datamodels.PII;i.RawContent=n,i.Kind=r,i.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,i)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(o.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(o.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(o.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),o.Bond.BondDataType.BT_STRING,o.Bond.BondDataType.BT_STRING);for(var r=0;r<this.Extension.GetBuffer().length;++r)t.WriteString(this.Extension.GetBuffer()[r].Key),t.WriteString(this.Extension.GetBuffer()[r].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(o.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(o.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),o.Bond.BondDataType.BT_STRING,o.Bond.BondDataType.BT_STRUCT);for(var i=0;i<this.PIIExtensions.GetBuffer().length;++i)t.WriteString(this.PIIExtensions.GetBuffer()[i].Key),this.PIIExtensions.GetBuffer()[i].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.Record=i;var a=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new o.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(o.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(o.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(o.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(o.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(o.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,o.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.DataPackage=a;var s=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(o.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,o.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(o.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(o.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.ClientToCollectorRequest=s}(e.datamodels||(e.datamodels={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),function(e){!function(e){!function(e){!function(t){var n,i;!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(n=t.CallbackEventType||(t.CallbackEventType={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(i=t.DATARV_ERROR||(t.DATARV_ERROR={}));var s=function(){function e(e){this._errorCode=i.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case i.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case i.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case i.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case i.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case i.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case i.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();t.Exception=s;var u=function(){return function(){}}();t.TelemetryConfig=u;var c=function(){function e(){}return e.CreateTelemetryManager=function(){return new f},e}();t.TelemetryManagerFactory=c;var d,l=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(d||(d={}));var f=function(){function t(){this._MaxPackageSizeInBytes=l.MaxPackageSizeInBytes(),this._listeners=[],this._status=d.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return t.prototype.Initialize=function(e){if(this._status!=d.Created)throw new s(i.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new s(i.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=d.Initialized,this._Verbose("Initialize() done")},t.prototype.AddListener=function(e){if(this._status<d.Initialized)throw new s(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},t.prototype.RemoveListener=function(e){if(this._status<d.Initialized)throw new s(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},t.prototype.Start=function(){if(this._status<d.Initialized)throw new s(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=d.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=d.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""))},t.prototype.Stop=function(){if(this._status<d.Initialized)throw new s(i.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==d.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=d.Initialized,void this._Verbose("Stop() done, status: "+this._status))},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},t.prototype.SendAsync=function(e,n){if(this._status<d.Initialized)throw new s(i.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",n.length].join(" ")),this._status<d.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!n)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new s(i.DATARV_ERROR_INVALID_ARG);for(var r=0;r<n.length;++r)if(!n[r].Id||!t._eventTypeRegex.test(n[r].EventType)||n[r].Timestamp.Equals("0"))throw this._Error(["eventId:",n[r].Id,"eventType:",n[r].EventType,"timestamp high:",n[r].Timestamp.high,"timestamp low:",n[r].Timestamp.low].join("")),new s(i.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,n),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},t.prototype._WorkThread=function(e,n){var i=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<d.Started)return void this._Verbose("_WorkThread, status is not started, return");var s=this._eventsCache.DequeuEvents();if(null==s)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var u=this._PackEvents(s.tenantToken,s.events);if(this._eventsCache.AddEvents(s.tenantToken,u.remainedEvents),null==u.buffer||0==u.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var c=this._testServerResponseHook();return void setTimeout(this._SendCallback(f,s.tenantToken,u.sendEvents,c,!1,null),100)}var l={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+r.version},complete:function(t){return i._SendCallback(f,s.tenantToken,u.sendEvents,t,n,e)}};a.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),l.data=new Uint8Array(u.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),l.data=o.Bond.Encoding.Base64.GetString(u.buffer),l.headers["content-encoding"]="base64"),s.tenantToken&&(l.headers["x-apikey"]=s.tenantToken);var f=t._tag;this._lastActiveTime=(new Date).getTime(),a.Utils.ajax(l,n),this._Verbose("_Workthread, send via jquery, tag: "+f)}catch(e){this._Error("_WorkThread, exception: "+e)}},t.prototype._PackEvents=function(t,n){this._Verbose("_PackageEvents, total Count: "+n.length);var r=new e.datamodels.ClientToCollectorRequest,i=new e.datamodels.DataPackage;i.Source="JS_default_source",i.DataPackageId=e.datamodels.utils.GetGuid(),i.Timestamp=e.datamodels.utils.GetTimeStamp();var o,a=n;for(n=[];i.Records=[],i.Records.push.apply(i.Records,a),r.DataPackages=[],r.DataPackages.push(i),o=this._Serialize(r),this._Verbose(["_PackageEvents, sendEvents.length:",a.length,"buffer.length:",o.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(o.length<this._MaxPackageSizeInBytes);){if(1==a.length){a=[],o=null;break}var s=a.splice(0,Math.floor(a.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,a),a=s}return this._Verbose(["_PakcageEvents done, sendEventsCount:",a.length,"buffer.length:",null==o?0:o.length,"remained events:",n.length].join("")),{buffer:o,sendEvents:a,remainedEvents:n}},t.prototype._Serialize=function(e){var t=new o.Bond.IO.MemoryStream,n=new o.Bond.CompactBinaryProtocolWriter(t);return e.Write(n),t.GetBuffer()},t.prototype._SendCallback=function(e,r,i,o,a,s){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",r,"events count:",i.length,"jqXHR:",o].join("")),s&&s(o?o.status:0,r,i),!a){var u=o&&void 0!==o.status&&200===o.status;if(this._status<d.Started||e<t._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!u)if(o&&void 0!==o.status&&501!==o.status&&505!==o.status&&(o.status<300||o.status>=500||408===o.status)||!o||void 0===o.status)return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(r,i),void this._ScheduleTimer(!0);for(var c=0;c<this._listeners.length;++c)this._listeners[c](u?n.SENT:n.SEND_FAILED,o?o.status:0,r,i);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{n=0;var r=(new Date).getTime()-this._lastActiveTime;n=r>l.TimeIntervalForNextSendInMS()?0:l.TimeIntervalForNextSendInMS()-r,this._timer=setTimeout(function(){return t._WorkThread(null,!1)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new p},t.prototype.__GetListenerArray=function(){return this._listeners},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},t.prototype.__IsScheduled=function(){return null!=this._timer},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},t}();f._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,f._tag=0;var p=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}(e._sender||(e._sender={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),function(e){!function(t){!function(t){var n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),i=function(){return function(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=null,this.disableCookies=!1}}();i.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.LogConfiguration=i;var o=function(){return function(){this.onSaveData=null,this.onGetData=null}}();t.LogConfigurationBrowserOverrides=o;var a,s=function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null!=e&&e!==t.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==t.datamodels.PIIKind[e]},e}(),u=function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return e.prototype.setProperty=function(n,r,i){if(!n||!e._propertyNameRegex.test(n))throw new c(a.INVALID_PROPERTY_NAME);this.properties[n]=i?{value:r,pii:i!=t.datamodels.PIIKind.NotSet?i:null}:{value:r,pii:null}},e}();u._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.EventProperties=u,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"}(a=t.TelemetryError||(t.TelemetryError={}));var c=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case a.INVALID_TENANT_TOKEN:return"Invalid tenant token";case a.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case a.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case a.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case a.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case a.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case a.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case a.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}},e}();t.Exception=c;var d=function(){function n(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return n.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},n.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},n.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},n.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,f.checkAndUpdateDeviceId(e))},n.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},n.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},n.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},n.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},n.prototype.setUserId=function(t,n,r){if(t&&(this.contextMap["UserInfo.Id"]=t),r)this.contextMap["UserInfo.IdType"]=r;else{var i;switch(n){case e.applications.telemetry.datamodels.PIIKind.SipAddress:i=e.applications.telemetry.datamodels.UserIdType.SipAddress;break;case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:i=e.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:i=e.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:i=e.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=i}if(n)s._isPii(n)&&(this.piiKind=n);else{var o;switch(r){case e.applications.telemetry.datamodels.UserIdType.Skype:o=e.applications.telemetry.datamodels.PIIKind.Identity;break;case e.applications.telemetry.datamodels.UserIdType.EmailAddress:o=e.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:o=e.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case e.applications.telemetry.datamodels.UserIdType.SipAddress:o=e.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:o=e.applications.telemetry.datamodels.PIIKind.NotSet}s._isPii(o)&&(this.piiKind=o)}},n.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},n.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},n.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},n.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},n.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},n}();t.SemanticContext=d;var l,f=function(){function e(){}return e.initialize=function(n,r){this._overrides=n,this._disableCookies=r;var i=e._getAppLanguage();i&&e.semanticContext.setAppLanguage(i);var o=e._getUserLanguage();o&&e.semanticContext.setUserLanguage(o);var a=(new Date).getTimezoneOffset(),s=a%60,u=(a-s)/60,c="+";if(u>0&&(c="-"),e.semanticContext.setUserTimeZone(c+(u<10?"0"+u:u.toString())+":"+(s<10?"0"+s:s.toString())),e._getUserAgent()&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion())),this._disableCookies&&!this._overrides)return e._deleteCookie(e.DEVICE_ID_COOKIE),void e._deleteCookie(e.FIRST_LAUNCH_TIME_COOKIE);var d=e._getData(e.DEVICE_ID_COOKIE);d&&""!=d||(d=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(d)},e.checkAndUpdateDeviceId=function(t){var n=e._getData(e.DEVICE_ID_COOKIE),r=e._getData(e.FIRST_LAUNCH_TIME_COOKIE);n!==t&&(r=(new Date).getTime().toString()),e.firstLaunchTime=parseInt(r),e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,r)},e._saveData=function(t,n){if(this._overrides)this._overrides.onSaveData(t,n);else if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies){var r=new Date;r.setTime(r.getTime()+31536e6);var i="expires="+r.toUTCString();document.cookie=t+"="+n+"; "+i}},e._getData=function(t){if(this._overrides)return this._overrides.onGetData(t)||"";if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies)for(var n=t+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var o=r[i],a=0;" "==o.charAt(a);)a++;if(0==(o=o.substring(a)).indexOf(n))return o.substring(n.length,o.length)}return""},e._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||""},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isIe()?e.BROWSERS.MSIE:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?function(){var t,n=e._getUserAgent(),r=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return r?r[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0}():function(t){var n;return t===e.BROWSERS.SAFARI&&(t="Version"),(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?n[1]:e.UNKNOWN_VERSION}(e._getBrowserName())},e._getOsName=function(){return e._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(/ arm;/i)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(/android/i)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(/(macintosh|mac os x)/i)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(/(windows|win32)/i)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(t){var n=t[1].replace(/_/g,".");if(n){var r=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}(n);return r?n.split(r)[0]:n}}return e.UNKNOWN_VERSION}():e.UNKNOWN_VERSION},e}();f.semanticContext=new d(!0),f.firstLaunchTime=-1,f.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},f.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},f.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},f.REGEX_VERSION="([\\d,.]+)",f.REGEX_VERSION_MAC="([\\d,_,.]+)",f.UNKNOWN_VERSION="Unknown",f.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",f.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",f._deleteCookie=function(e){"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},f._disableCookies=!1,function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(l=t.SessionState||(t.SessionState={}));var p=function(){function e(){}return e.initialize=function(t,r){if(!e._initialized){if(!t)throw new c(a.INVALID_TENANT_TOKEN);if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=r,!("undefined"!=typeof window||r&&r.browserOverrides&&r.browserOverrides.onGetData))throw new c(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var i=null;if(r)if(r.collectorUrl&&(e._tmConfig.collectorUrl=r.collectorUrl),r.browserOverrides){if(i=new o,r.browserOverrides.onGetData?!r.browserOverrides.onSaveData:r.browserOverrides.onSaveData)throw new c(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);i.onGetData=r.browserOverrides.onGetData,i.onSaveData=r.browserOverrides.onSaveData}else r.disableCookies&&(e._sessionEnabled=!1);n.Initialize(e._tmConfig),n.Start(),f.initialize(i,r.disableCookies),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(r&&r.enableAutoUserSession&&(e._logger=new h,e._logger.logSession(l.STARTED)),window.addEventListener("beforeunload",e._teardown))}},e.pauseTransmission=function(){n.Pause()},e.resumeTransmission=function(){n.Resume()},e.flush=function(e){n.Flush(e)},e.addCallbackListener=function(t){e._initialized&&n.AddListener(t)},e.setContext=function(t,n,r){e._contextProperties.setProperty(t,n,r)},e.isInitialized=function(){return e._initialized},e.getDefaultToken=function(){return e._defaultToken},e.getSemanticContext=function(){return e._semanticContext},e._getInitIdForToken=function(n){return e._initIdMap[n]||(e._initIdMap[n]=t.datamodels.utils.GetGuid()),e._initIdMap[n]},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t]},e._teardown=function(){e._logger&&e._logger.logSession(l.ENDED),e.flush()},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig,e._semanticContext=new d(!0),e._contextProperties=new u,e._configuration=null,n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={}},e}();p._initialized=!1,p._defaultToken=null,p._tmConfig=new t._sender.TelemetryConfig,p._logger=null,p._initIdMap={},p._sequenceMap={},p._configuration=null,p._contextProperties=new u,p._semanticContext=new d(!0),p._sessionEnabled=!0,t.LogManager=p;var h=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new u,this._semanticContext=new d(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||p.getDefaultToken(),this._initId=p._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new c(a.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,r,i){if(!e)throw new c(a.MISSING_FAILURE_SIGNATURE);if(!t)throw new c(a.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),r&&o.Extension.Add("Failure.Id",r),this._addPropertiesAndSendEvent(o,i)},e.prototype.logPageView=function(e,t,n,r,i,o){if(!e)throw new c(a.MISSING_PAGEVIEW_ID);if(!t)throw new c(a.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),n&&s.Extension.Add("PageView.Category",n),r&&s.Extension.Add("PageView.Uri",r),i&&s.Extension.Add("PageView.ReferrerUri",i),this._addPropertiesAndSendEvent(s,o)},e.prototype.logSession=function(e,n){if(p._sessionEnabled){if(e!==l.STARTED&&e!==l.ENDED)throw new c(a.INVALID_SESSION_STATE);var r=this._createEventRecord("session","session");if(e===l.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=t.datamodels.utils.GetGuid(),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Started")}else if(e===l.ENDED){if(0==this._sessionStartTime)return;var i=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);r.Extension.Add("Session.Duration",i.toString()),r.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(i)),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}r.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(f.firstLaunchTime))),this._addPropertiesAndSendEvent(r,n)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,n){var i=new t.datamodels.Record;n||(n="custom"),i.EventType=e.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),i.Extension.Add("EventInfo.Sequence",p._getSequenceForToken(this._tenantToken).toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var o=new Date;return i.Timestamp=t.datamodels.utils.GetTimeStampWithValue(o.getTime()),i.Extension.Add("EventInfo.Time",this._getISOString(o)),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+r.version),i},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+function(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}(e.getUTCMilliseconds())+"Z"},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,f.semanticContext),this._addSemanticContext(e,p._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,p._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,n){if(n&&n.contextMap){var r=n.contextMap;for(var i in n.contextMap)"UserInfo.Id"==i&&n.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(i,r[i],n.piiKind):e.Extension.AddOrReplace(i,r[i])}},e.prototype._addEventPropertiesToEvent=function(e,n){if(n){n.timestamp&&n.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(n.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(n.timestamp)))),n.name&&(e.EventType=n.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",n.name.toLowerCase()));var r=n.properties;if(r)for(var i in r)i&&(r[i].value||!1===r[i].value||0==r[i].value||""==r[i].value)&&(s._isPii(r[i].pii)?(e.AddOrReplacePII(i,r[i].value.toString(),r[i].pii),e.Extension.Remove(i)):(e.Extension.AddOrReplace(i,r[i].value.toString()),e.PIIExtensions.Remove(i)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),p.isInitialized()&&(this._sanitizeName(e),n.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e}();t.Logger=h}(t.telemetry||(t.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),e.exports=s.applications.telemetry},"60f875299f1223db95fd":function(e,t,n){"use strict";var r=n("4986dedaa57d766e48bb")["_JHOkSBhvwnD5wTu/rquXQg"];t.a=r},"617dcfa84bb3a8c48ca3":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("0447af78a21f7c7312e2"),i=n("806b880959f0be21dbf7");t.CaughtError=r.createSingleEvent({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0,requiresParent:!1},{stack:1,extraData:4},i.Trace)},"62a856fb51e24a703bd6":function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=!1);var n="";if(e){var r=e.lastIndexOf(".");r>=0&&(n=t?e.substr(r+1):e.substr(r))}return n}function i(e,t){return void 0===t&&(t=!0),e=encodeURI(e),t&&e&&(e=e.replace(/#/g,"%23")),e}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},"637f546134386c5b625a":function(e,t,n){"use strict";var r;!function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory"}(r||(r={})),t.a=r},"655c29c4569d728dbf1e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("9e0d2f5e68dc84431948");t.CustomError=r.CustomError;var i=n("c0864826ef536ba1020d");t.ApiError=i.ApiError},"6631b0451e9f577f414d":function(e,t,n){"use strict";var r=n("87e95cd1ff4b249d307f");function i(){}function o(e){r.default.log(e)}var a=function(){function e(e,t){void 0===t&&(t=o),this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}return e.prototype.dispose=function(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var n=t[e];this.clearTimeout(Number(n))}this._timeoutIds=null}if(this._immediateIds){for(var r=0,i=Object.keys(this._immediateIds);r<i.length;r++){n=i[r];this.clearImmediate(Number(n))}this._immediateIds=null}if(this._intervalIds){for(var o=0,a=Object.keys(this._intervalIds);o<a.length;o++){n=a[o];this.clearInterval(Number(n))}this._intervalIds=null}if(this._animationFrameIds){for(var s=0,u=Object.keys(this._animationFrameIds);s<u.length;s++){n=u[s];this.cancelAnimationFrame(Number(n))}this._animationFrameIds=null}}},e.prototype.setTimeout=function(e,t){var n=this,r=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),o=this._parent;r=setTimeout(function(){try{delete i[r],e.apply(o)}catch(e){n._logError(e)}},t),i[r]=!0}return r},e.prototype.clearTimeout=function(e){var t=this._timeoutIds;t&&t[e]&&(clearTimeout(e),delete t[e])},e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var r=this._immediateIds||(this._immediateIds={}),i=this._parent,o=function(){try{delete r[n],e.apply(i)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(o):window.setTimeout(o,0),r[n]=!0}return n},e.prototype.clearImmediate=function(e){var t=this._immediateIds;t&&t[e]&&(window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e),delete t[e])},e.prototype.setInterval=function(e,t){var n=this,r=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;r=setInterval(function(){try{e.apply(i)}catch(e){n._logError(e)}},t),this._intervalIds[r]=!0}return r},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var r=this;if(void 0===n&&(n={}),this._isDisposed)return i;var o,a,s=t||0,u=n.leading,c=void 0===u||u,d=n.trailing,l=void 0===d||d,f=0,p=null,h=this._parent,_=function(t){var n=(new Date).getTime(),i=n-f,u=c?s-i:s;return i>=s&&(!t||c)?(f=n,p&&(r.clearTimeout(p),p=null),o=e.apply(h,a)):null===p&&l&&(p=r.setTimeout(_,u)),o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,_(!0)}},e.prototype.debounce=function(e,t,n){var r=this;if(void 0===n&&(n={}),this._isDisposed)return i;var o,a,s=t||0,u=n.leading,c=void 0!==u&&u,d=n.trailing,l=void 0===d||d,f=n.maxWait,p=void 0===f?NaN:f,h=0,_=(new Date).getTime(),g=null,m=this._parent,v=function(t){var n=(new Date).getTime(),i=!1;t&&(c&&n-h>=s&&(i=!0),h=n);var u=n-h,d=s-u,f=n-_,y=!1;return isNaN(p)||(f>=p&&g?y=!0:d=Math.min(d,p-f)),u>=s||y||i?(g&&(r.clearTimeout(g),g=null),_=n,o=e.apply(m,a)):null!==g&&t||!l||(g=r.setTimeout(v,d)),o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,v(!0)}},e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var r=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,o=function(){try{delete r[n],e.apply(i)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(o):window.setTimeout(o,0),r[n]=!0}return n},e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;t&&t[e]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e),delete t[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();t.a=a},"6e62786e04351f279fc3":function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=n("62a856fb51e24a703bd6");function i(e){return decodeURI(e)}function o(e){var t;try{t=decodeURI(e)}catch(n){t=e}return e=t===e?Object(r.a)(e,!0):e.replace("#","%23")}function a(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}},"6f8ae5b6dc470397fb69":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("9de296873c83e5923274"),i=n("31c1cddf44fcb4b5ef81");t.ResultTypeEnum=i.ResultTypeEnum,t.Qos=r.createPairedEvent({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:1},startTimeOverride:{isPrefixingDisabled:!0,type:2},resultCode:{isPrefixingDisabled:!0,type:1},resultType:{typeRef:i.ResultTypeEnum,isPrefixingDisabled:!0,type:6},error:{isPrefixingDisabled:!0,type:1},extraData:4,extraMetrics:{isPrefixingDisabled:!0,type:4}})},"774b0ab3c2d70fcabb2d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepCompare=function(e,t,n){var r=[],i=[],o=n||function(e,t){return e===t};return function e(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;var a=Object.keys(t).sort(),s=Object.keys(n).sort();return a.length===s.length&&!!a.every(function(a,u){if(a!==s[u])return!1;if("function"==typeof t[a]||"function"==typeof n[a])return!0;if(o(t[a],n[a]))return!0;if("object"==typeof t[a]){if(-1!==r.indexOf(t[a]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+t+", property: "+a);if(r.push(t[a]),-1!==i.indexOf(n[a]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+n+", property: "+a);return i.push(n[a]),!!e(t[a],n[a])&&(r.pop(),i.pop(),!0)}return!1})}(e,t)}},"7e182c09f4566649b389":function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"g",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return p});var r=6e4,i=2*r,o=60*r,a=2*o,s=24*o,u=2*s,c=32*s;function d(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<s}function l(e,t){return e.getFullYear()===t.getFullYear()}function f(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}function p(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}},"806b880959f0be21dbf7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("0447af78a21f7c7312e2");t.Trace=r.createSingleEvent({eventName:"Trace,",shortEventName:"Trace",requiresParent:!1},{message:1})},"8605abf9448f5c554409":function(e,t,n){"use strict";n.r(t),n.d(t,"Api",function(){return a});var r=n("55a07aceb8cbadb26c24"),i=n("4e087ea06522888b2152"),o=n("dccf0341ea4deb985b9e");n.d(t,"ResultTypeEnum",function(){return o.ResultTypeEnum});var a=Object(r.createPairedEvent)({eventName:"Api,Qos,",shortEventName:"Api"},{url:1},i.Qos);t.default=a},"87e95cd1ff4b249d307f":function(e,t,n){"use strict";n.r(t);var r=n("22e720316fb8bade1b0e");t.default=r},"8e315e7d1c81f1fe46e0":function(e,t,n){"use strict";var r=n("87e95cd1ff4b249d307f"),i=n("e1c8dc4e514231c05155");function o(e){r.default.log(e)}var a=function(){function e(t,n){void 0===n&&(n=o),this._id=e._uniqueId++,this._parent=t,this._onError=n,this._eventRecords=[]}return e.raise=function(e,t,n,r){return i.c(e,t,n,r)},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,o){var a=this;if(n.indexOf(",")>-1)for(var s=n.split(/[ ,]+/),u=0;u<s.length;u++)this.on(t,s[u],r,o);else{var c=this._parent,d={target:t,eventName:n,parent:c,callback:r,objectCallback:null,elementCallback:null,useCapture:o},l=t.__events__=t.__events__||{};if(l[n]=l[n]||{count:0},l[n][this._id]=l[n][this._id]||[],l[n][this._id].push(d),l[n].count++,i.b(t)){var f=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!a._isDisposed){try{var i=r.apply(c,t);if(!1===i&&t[0]&&t[0].preventDefault){var o=t[0];o.preventDefault(),e.stopPropagation(o)}}catch(o){a._onError(o)}return i}};d.elementCallback=f,t.addEventListener(n,f,o)}else{d.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!a._isDisposed)return r.apply(c,e)}}this._eventRecords.push(d)}},e.prototype.off=function(e,t,n,r){for(var i=0;i<this._eventRecords.length;i++){var o=this._eventRecords[i];if(!(e&&e!==o.target||t&&t!==o.eventName||n&&n!==o.callback||"boolean"==typeof r&&r!==o.useCapture)){var a=o.target.__events__,s=a[o.eventName],u=s?s[this._id]:null;u&&(1!==u.length&&n?(s.count--,u.splice(u.indexOf(o),1)):(s.count-=u.length,delete a[o.eventName][this._id]),s.count||delete a[o.eventName]),o.elementCallback&&o.target.removeEventListener&&o.target.removeEventListener(o.eventName,o.elementCallback,o.useCapture),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}();t.a=a},"8ee2449079216aae4676":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("0447af78a21f7c7312e2"),i=n("617dcfa84bb3a8c48ca3"),o=n("31c1cddf44fcb4b5ef81");t.ResultTypeEnum=o.ResultTypeEnum,t.QosError=r.createSingleEvent({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:1},resultCode:1,resultType:{typeRef:o.ResultTypeEnum,type:6}},i.CaughtError)},"8f87efd00acf85bf14b3":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepCopy=function(e){var t=[];return function e(n){var r=null;return n&&(r=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),Object.keys(n).forEach(function(i){var o=n[i];if("object"==typeof o){if(-1!==t.indexOf(o))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: "+n+", property: "+i);t.push(o),r[i]=e(o),t.pop()}else r[i]=o})),r}(e)}},"948e07ec1b658aef2b54":function(e,t,n){"use strict";var r=n("637f546134386c5b625a"),i=function(){function e(t,n){(void 0===n&&(n=r.a.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=n,n===r.a.none)?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}return e.hasStorageType=function(t){switch(e.init(),t){case r.a.none:case r.a.sharedMemory:return!0;case r.a.session:return!!e._sessionStorage;case r.a.local:return!!e._localStorage}return!1},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}},e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(n=!0),e.removeItem(t)}catch(e){}return n},e.prototype.setValue=function(e,t,n,r){void 0===r&&(r=!0),e=r?this.normalizeKey(e):e,this.dataStore[e]=t;var i=this.getStorage(n);if(i)try{var o=[],a=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==o.indexOf(t))return;o.push(t)}return t});o=null,i.setItem(this.dataStoreKey+e,a)}catch(e){}},e.prototype.getValue=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var r=this.dataStore[e],i=this.getStorage(t);if(void 0===r&&i){var o=i.getItem(this.dataStoreKey+e);if(o)try{r=JSON.parse(o),this.dataStore[e]=r}catch(e){r=void 0}}return r},e.prototype.remove=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var r=this.getStorage(t);r&&r.removeItem(this.dataStoreKey+e),delete this.dataStore[e]},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case r.a.none:case r.a.sharedMemory:return null;case r.a.session:return e._sessionStorage;case r.a.local:return e._localStorage}return null},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e}();t.a=i},"9a07fb223dfaa81a8d0c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("13e40aa9f992db5e9396"),o=n("a918e6b023e78a8f38a9"),a=function(e){function t(t){var n=new o.PlatformDetection,i=t.context,a=void 0===i?{}:i;return e.call(this,r.__assign({language:window.navigator.language},t,{context:r.__assign({BrowserIsMobile:n.isMobile,BrowserMajVer:n.browserMajor,BrowserMinVer:n.browserMinor,BrowserName:n.browserName,BrowserUserAgent:n.userAgent,OSName:n.osName,OSVersion:n.osVersion},a)}))||this}return r.__extends(t,e),t}(i.SharedAriaTelemetryHandler);t.WebSharedAriaTelemetryHandler=a},"9de296873c83e5923274":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("dd7710060b79460ec18c"),o=n("16f7a8beee83cf78aabb"),a=n("31c1cddf44fcb4b5ef81"),s=n("22e720316fb8bade1b0e"),u=n("347053043e453fed139f");function c(e,t,n){var r={resultType:e};return t&&(r.resultCode=t),n&&(r.error=n),r}var d=function(e){function t(t,n){return e.call(this,t,i.ClonedEventType.Start,n)||this}return r.__extends(t,e),t.instrumentPromise=function(e,t,n,r,i,o,s){var d,l=new this(e,s);i&&l.setTimeout(i,o);try{d=t()}catch(e){throw l.end(c(a.ResultTypeEnum.Failure,"PromiseCreationFailed",e.toString())),e}return d.then(function(e){var t;if(n)try{t=n(e)}catch(e){t=c(a.ResultTypeEnum.Failure,"GetSchemaException",e.toString())}else t=c(a.ResultTypeEnum.Success);l.end(t)},function(e){var t;if(r)try{t=r(e)}catch(e){t=c(a.ResultTypeEnum.Failure,"GetSchemaException",e.toString())}else t=e?c(e instanceof Error&&"Canceled"===e.name?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure,void 0,u.safeSerialize(e)):c(a.ResultTypeEnum.Failure);l.end(t)}),d},t.prototype.setTimeout=function(e,t){this._clearTimeout(),t||(t=c(a.ResultTypeEnum.Failure,"Timeout")),this.timeoutId=window.setTimeout(this.end.bind(this,t),e)},t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;s.verbose(e,t.name)}},t.prototype.end=function(e){if(!this.endTime){if(e&&this._setData(e),this.endTime=o.Manager.getTime(),this._logEvent(i.ClonedEventType.End),this._isQosEvent()){var t=this.data;t.error&&s.log(t.error,t.name,t.resultCode,t.resultType)}this._clearTimeout()}},t.prototype._clearTimeout=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)},t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0},t}(i.EventBase);t.createPairedEvent=function(e,t,n){var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(d);return i.addEventProps(o.prototype,e,t,n),o}},"9e0d2f5e68dc84431948":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=function(){return function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);this.message=t.message,this.innerError=e.innerError,r.__assign(t,this);var n=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,n),Object.setPrototypeOf)return Object.setPrototypeOf(t,n),t}}();t.CustomError=i,Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error))},a918e6b023e78a8f38a9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e){e||("undefined"!=typeof window?e=window&&window.navigator&&navigator.userAgent:"undefined"!=typeof self&&(e=self&&self.navigator&&navigator.userAgent),e=e||"");var t,n,r,i,o,a,s,u,c=e,d=e.toLowerCase();function l(e){return t=RegExp(e+"(\\d+)([\\d.]*)").exec(d)}l("msie ")?(n=!0,r=!!t&&"9"===t[1]):l("trident.*rv:")?n=!0:l("edge/")?i=!0:l("fxios|firefox/")?o=!0:l("(?:chrome|crios)/")?a=!0:/safari\/(\d+)/.test(d)&&(s=!0,l("version/")),RegExp("electron/(\\d+)([\\d.]*)").exec(d)&&(u=!0);var f=t&&parseInt(t[1],10)||0,p=t&&t[2]&&t[2].substr(1)||"0",h=/windows phone|wpdesktop/.test(d),_=h||/ipad|iphone|ipod|android/.exec(d),g=_&&_[0],m="android"===g,v="ipad"===g,y=!!g&&!m,T=!_&&d.indexOf("macintosh")>-1,S=!_&&d.indexOf("windows nt")>-1,E=d.indexOf("sharepointdesktop")>-1,b=!1,I=!1,R=!1,D=!1;if("undefined"!=typeof window&&window.document||"undefined"!=typeof self&&self.document){var w=document.createElement("style");w.type="text/css",b=!w.styleSheet,I="addBehavior"in document.createElement("div");var C=document.createElement("input");C.type="file";var O=window.File,A=O&&O.prototype;D=!(!A||!(A.slice||A.mozSlice||A.webkitSlice)),R="webkitdirectory"in C&&!u}var P=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(d);return{isSharePointDesktopApp:!!E,isChrome:!!a,isEdge:!!i,isFirefox:!!o,isIE:!!n,isIE9:!!r,isSafari:!!s,isElectron:!!u,browserName:n?"IE":i?"Edge":a?"Chrome":o?"Firefox":s?"Safari":"NA",browserMajor:f,browserMinor:p,isAndroid:m,isIOS:y,isMac:T,isWindows:S,isWinPhone:h,osVersion:P?P[2]:"NA",osName:S?"Windows":h?"Windows Phone":T?"OSX":y?"IOS":m?"Android":"NA",isWindows81:!_&&/windows (?:8\.1|nt 6\.3)/.test(d),isWindows10:!_&&d.indexOf("windows nt 10")>-1,isWindows7:!_&&d.indexOf("windows nt 6.1")>-1,isMobile:!!_,isIPad:v,areCSS3TransitionsSupported:!n||f>9,areTouchEventsSupported:"undefined"!=typeof window?"ontouchstart"in window:"undefined"!=typeof self&&"ontouchstart"in self,isFolderUploadSupported:R,isHtml5FileUploadSupported:D,isRetinaSupported:"undefined"!=typeof window?window.devicePixelRatio>1:!("undefined"==typeof self||!self.devicePixelRatio)&&self.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:b,isWebDavSupported:I,userAgent:c}}}();t.PlatformDetection=r},b2115b5c9c165e0e8a79:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613");t.assign=function(e,t){return r.__assign(e,t)}},bd0254dab5bf8910cafc:function(e,t,n){"use strict";var r=n("0447af78a21f7c7312e2");n.o(r,"createSingleEvent")&&n.d(t,"createSingleEvent",function(){return r.createSingleEvent})},c0864826ef536ba1020d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=function(e){function t(t){var n=e.call(this,t)||this;return n.correlationId=t.correlationId,n.isExpected=!!t.isExpected,n.code=t.code||"ApiError",n}return r.__extends(t,e),t}(n("9e0d2f5e68dc84431948").CustomError);t.ApiError=i},c1a09d7dd35e11297e15:function(e,t,n){"use strict";n.r(t);var r=n("0b8514f932f40951d460"),i=function(){function e(e){this._promise=new r.SignalPromise(e)}return e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.default=i},c1d76209a7f2fe28e159:function(e,t,n){"use strict";n.r(t);var r=n("98bae3dbabd51089d613"),i=n("0b8514f932f40951d460"),o=n("6631b0451e9f577f414d"),a=n("c1a09d7dd35e11297e15");var s=n("4e087ea06522888b2152"),u=n("8605abf9448f5c554409"),c=n("173e9cfb7855b90005c4"),d=n("d8376f4535401b5bd67a"),l=n("cc08c169973ba8efeefa");n.d(t,"DataRequestor",function(){return f});var f=function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext,this._qosName=e.qosName,this._qosEvent=t&&t.qosEvent||s.default,this._apiEvent=t&&t.apiEvent||u.default,this._async=new o.a(this)}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(t){var n=this,o=t.url,u=t.parseResponse,f=void 0===u?e.parseJSON:u,p=t.qosName,h=t.qosExtraData,_=t.qosHandler,g=t.customQosLogger,m=t.additionalPostData,v=void 0===m?"":m,y=t.additionalHeaders,T=t.contentType,S=t.method,E=void 0===S?"POST":S,b=t.maxRetries,I=void 0===b?0:b,R=t.crossSiteCollectionCall,D=void 0!==R&&R,w=t.noRedirect,C=void 0!==w&&w,O=t.needsRequestDigest,A=void 0===O||O,P=t.responseType,N=t.onUploadProgress,U=t.timeout,x=t.authToken,M=t.noTimeoutInLastRetry,B=void 0!==M&&M;I=Math.max(I,0);var k=0,L=this._pageContext;return i.default.resolve(x||L&&(L.getAuthToken&&L.getAuthToken()||L.authToken)).then(function(e){if(e){var t="Bearer "+e;if(y){var u=!1;for(var m in y)m&&"authorization"===m.toLowerCase()&&(u=!0);u||(y.Authorization=t)}else y={Authorization:t};D=!0,A=!1,C=!0}var S=new d.default(r.__assign({},L?{webServerRelativeUrl:L.webServerRelativeUrl,webAbsoluteUrl:D?L.webAbsoluteUrl:void 0,formDigest:{updateFormDigestPageLoaded:L.updateFormDigestPageLoaded,formDigestValue:L.formDigestValue,formDigestTimeoutSeconds:L.formDigestTimeoutSeconds}}:{},{needsRequestDigest:A})),b=[];n._qosName&&b.push(n._qosName),p&&b.push(p),p=b.join(".");var R,w=function(e){g&&g(e)},O=function(t,i){var a,u,c;a=function(e){var o,a=new n._qosEvent({name:p}),u=e.getResponseText(),c=r.__assign({},h||{},{CorrelationId:e.getCorrelationId(),HttpStatus:e.getStatus(),dataSource:e.getServiceWorkerDataSourceHeader()||void 0}),d=!1;try{o=n._isBlobResponse(P,u)?u:f(u,e),d=!0;var l={resultType:s.ResultTypeEnum.Success,extraData:c};a.end(l),w(l)}catch(e){l={resultType:s.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:c},a.end(l),w(l),i()}if(d){a=new n._qosEvent({name:p+"Complete"});try{t(o),l={resultType:s.ResultTypeEnum.Success,extraData:c},a.end(l),w(l)}catch(e){l={resultType:s.ResultTypeEnum.Failure,error:"object"==typeof e?JSON.stringify(e):e,extraData:c},a.end(l),w(l)}}S=void 0},u=function(e){var t=new n._qosEvent({name:p}),o=h||{};if(!e){var a=void 0;return R?a={resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"RequestAborted",extraData:o}:(a={resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"Unknown",extraData:o},i({status:0,code:""})),t.end(a),void w(a)}var u=e.getCorrelationId(),d=e.getGroupThrottle(),f=e.getStatus();o=r.__assign({},o,{CorrelationId:u,HttpStatus:f,GroupThrottle:d});var g=s.ResultTypeEnum.Failure,m="undefined"!=typeof navigator&&!1===navigator.onLine;(403===f||404===f||429===f||0===f&&m)&&(I=0,g=s.ResultTypeEnum.ExpectedFailure);var v=function(n){var r=void 0;if("object"==typeof n&&"number"==typeof n.status)r=n;else if("string"==typeof n){var a=void 0;try{a=JSON.parse(n)}catch(e){}a&&(r="string"==typeof a.error?a.error_description?{code:"-1,"+a.error,message:a.error_description}:{message:a.error}:a.error||a["odata.error"]||{responseData:a})}if((r=r||{}).status=f,!l.Killswitch.isActivated("5202A778-5F5A-492D-B815-CCBDEECC399D","1/17/2019","Add redirectUrl to errors.")){var p=r["@error.redirectUrl"],h=e.getRedirectUrl()||p;h&&(g=s.ResultTypeEnum.ExpectedFailure),r.redirectUrl=h}u&&(r.correlationId=u),d&&(r.groupThrottle=d);var m=f.toString();_&&(m=_(r),500!==f||"DefaultDoclibNotFound"!==m&&"PrefetchWebMismatch"!==m||(I=0,g=s.ResultTypeEnum.ExpectedFailure));var v=JSON.stringify(r),y={resultType:g,error:v,resultCode:m,extraData:o};t.end(y),w(y),k<I?(++k,c()):i(r)},y=e.getResponseType();y&&"text"!==y?e.parseError().then(v):v(e.getResponseText())},(c=function(){S.getServerDataFromUrl({url:o,successCallback:a,failureCallback:u,uploadProgressCallback:N,additionalPostData:v,method:E,additionalHeaders:y,contentType:T,withCredentials:!e&&void 0,noRedirect:C,responseType:P,needsRequestDigest:A})})()},x=function(){R=!0,S&&(S.abort(),k>=I&&S.dispose())},M=c.c.getRUMOneLogger(),V=Date.now();M&&(Boolean(M.readTempData("appDataFetchStart"))||M.saveTempData("appDataFetchStart",V));return n._apiEvent.instrumentPromise({url:o,name:p+".Promise"},function(){var e=function(){var e=new i.default(O,x);return U&&(!B||k<I)?i.default.timeout(U,e):e};return(k<I?function(e){var t,n=e.adjustRetries,r=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,u=void 0===s?function(){return!0}:s,c=e.delay,d=e.resetAttemptsOnRestart,l=e.retries,f=e.shouldRestart,p=0,h=new a.default(function(){t.cancel()});function _(e){f&&f()?(d&&(p=0),m()):h.complete(e)}function g(e){n&&(l=n(e)),p<l&&u(e)?(p++,i&&i(),"number"==typeof c&&r?r.setTimeout(m,c):m()):h.error(e)}function m(){(t=o()).then(_,g)}return m(),h.getPromise()}({retries:I,callback:e,canRetry:function(e){return!0},async:n._async,delay:0,adjustRetries:function(e){return I-k},beforeRetry:function(){k++}}):e()).then(function(e){return S&&S.dispose(),e},function(e){return S&&S.dispose(),i.default.reject(e)})},void 0,function(e){return e instanceof Error&&i.default.isCanceled(e)?{error:e.message,resultCode:"Canceled",resultType:s.ResultTypeEnum.ExpectedFailure}:e&&403===e.status?{error:JSON.stringify(e),resultCode:"AccessDenied",resultType:s.ResultTypeEnum.ExpectedFailure}:r.__assign({},function(e){return l.Killswitch.isActivated("78C04DFD-1688-4679-A984-ED60A4341F51","4/10/2018","Include error data in QoS failures.")?{resultCode:"",error:""+e}:e instanceof Error?{resultCode:"",error:e.toString()}:function(e){return!!e&&"object"==typeof e&&"code"in e}(e)?{resultCode:"string"==typeof e.code?e.code:""+e.status,error:JSON.stringify(e)}:{error:e,resultCode:""}}(e),{resultType:s.ResultTypeEnum.Failure})})})},e.prototype._isBlobResponse=function(e,t){return"blob"===e&&t&&"object"==typeof t},e}();t.default=f},caeea5a1a89264bf5175:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c});var r=n("d6e6a1e726db94fe6759"),i=n("7e182c09f4566649b389"),o=n("60f875299f1223db95fd");function a(e,t,n){void 0===n&&(n=!1);var r=Date.now()-e.getTime();if(r<-5*i.c)return e.toLocaleDateString(t);if(r<i.c)return u("LessThanAMinute",n);if(r<i.g)return u("AboutAMinute",n);if(r<i.b)return c(Math.floor(r/i.c),"XMinutes");if(r<i.f)return u("AboutAnHour",n);if(r<i.a)return c(Math.floor(r/i.b),"XHours");if(r<i.e){var o=e.toLocaleTimeString(t);return u("YesterdayAndTime",n).replace("{0}",o)}return r<i.d?c(Math.floor(r/i.a),"XDays"):e.toLocaleDateString(t)}function s(e,t){var n=Date.now()-e.getTime(),s=e.toLocaleDateString(t),u=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return n<i.a?a(e,t):n<i.e?Object(r.format)(o.a.RelativeDateTime_YesterdayAndTime,u):Object(r.format)(o.a.DateTime_DateAndTime,s,u)}function u(e,t,n,r){return o.a[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function c(e,t,n,i){var o=u(t,!!i&&n,i),a=u(t,!1,i,!0);return(Object(r.getLocalizedCountValue)(o,a,e)||"").replace("{0}",e+"")}},d8376f4535401b5bd67a:function(e,t,n){"use strict";n.r(t);var r=n("c1a09d7dd35e11297e15"),i=n("1c8f7532950b71f6d754"),o=n("e9d155a6651c0bf6c9b0");var a=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getCorrelationId=function(){return this._request.getResponseHeader("SPRequestGuid")},e.prototype.getGroupThrottle=function(){return this._request.getResponseHeader("SPGroupThrottle")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this._request.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getStatus=function(){try{return this._request.status}catch(e){}},e.prototype.getAuthenticationRedirect=function(){return this._request.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){var e={status:this._request.status,statusText:this._request.statusText,infected:void 0};return this._request.getResponseHeader("x-virus-infected")&&(e.infected=!0),e}return this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new r.default;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new r.default,i=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},o=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",i),t.addEventListener("error",o),t.readAsText(e)}catch(e){o()}return n.getPromise().then(function(e){return t&&(t.removeEventListener("load",i),t.removeEventListener("error",o)),e})}(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e._request.getResponseHeader("x-virus-infected")};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation()}else if(401===this.getStatus()&&this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation()},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new i.default(t);n.setQueryParameter("ReturnUrl",o.default.encodeURIComponent(window.location.href)),e=n.toString()}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new i.default(t);n.setQueryParameter("Source",o.default.encodeURIComponent(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",o.default.encodeURIComponent(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=new i.default(this._request.getResponseHeader("X-SPO-ErrorCustomPromptLocation"));return e.setQueryParameter("ReturnUrl",window.location.href),e.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this._request.getResponseHeader("X-SPO-ErrorCode"),t=this._request.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}(),s=n("256c2b1df06b9b785912"),u=n("173e9cfb7855b90005c4"),c=u.a,d=n("8e315e7d1c81f1fe46e0"),l=n("0b8514f932f40951d460"),f=function(){function e(e){void 0===e&&(e={}),this._scope=new s.a,this._events=this._scope.attach(new d.a(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new i.default(t).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),t?(this._webAbsoluteUrl=t,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1}return e._isXhrAborted=function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!0;if(e.isCancelled)return!0}catch(e){return!0}return!1},e._isValidFormDigest=function(e){return e&&e.updateFormDigestPageLoaded&&Date.now()-e.updateFormDigestPageLoaded.getTime()<1e3*e.formDigestTimeoutSeconds},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,o=e.uploadProgressCallback,a=e.additionalPostData,s=e.isRest,u=void 0===s||s,c=e.method,d=void 0===c?"POST":c,l=e.withCredentials,f=e.additionalHeaders,p=e.contentType,h=e.noRedirect,_=e.responseType,g=e.needsRequestDigest,m=void 0===g?this._needsRequestDigest:g,v=(new Date).toISOString(),y=new XMLHttpRequest;y.open(d,n,!0),"boolean"==typeof l&&(y.withCredentials=l),_&&(y.responseType=_),p?y.setRequestHeader("Content-Type",p):u?y.setRequestHeader("Content-Type","application/json;odata=verbose"):y.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var T=!1;if(f)for(var S in f)S&&(y.setRequestHeader(S,f[S]),"accept"===S.toLowerCase()&&(T=!0));T||y.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=y;var E=function(e){m&&e&&y.setRequestHeader("x-requestdigest",e),t._events.on(y,"readystatechange",function(){t._onReadyStateChange(y,n,r,i,h,v)}),o&&y.upload&&t._events.on(y.upload,"progress",function(e){o(e)}),y.send(a)};m?this._ensureRequestDigest(E,i):E()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var r=this,o=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(o._requestCanaryForAuth=!0);var a=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof a?(e._requestDigestPromise||(e._requestDigestPromise=new l.default(function(s,u){o.getServerDataFromUrl({url:i.default.concatenate(a,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),i=JSON.parse(n).d.GetContextWebInformation;e._formDigests[r._webServerRelativeUrl]={formDigestValue:i.FormDigestValue,formDigestTimeoutSeconds:i.FormDigestTimeoutSeconds-e.INTERVAL_ADJUST,updateFormDigestPageLoaded:new Date},s(e._formDigests[r._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(r){t?t(void 0):n&&n(r),u(void 0),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})})),e._requestDigestPromise.then(function(e){return t&&t(e),e})):n&&n(void 0)},e.prototype._onReadyStateChange=function(t,n,r,s,d,l){if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),e._isXhrAborted(t))s();else{var f=new a(t,n),p=f.getStatus(),h=u.c.getRUMOneLogger(),_=Date.now();if(h){var g=new c(n,Number(t.getResponseHeader("SPClientServiceRequestDuration")),t.getResponseHeader("SPRequestGuid"),p,l,(new Date).toISOString());h.writeAPICallPerformanceData(g),h.saveTempData("appDataFetchEnd",_)}var m=!d&&this._shouldRedirectToErrorCustomPromptLocation(t);if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===p){try{m?this._redirectToErrorCustomPromptLocation(t):s(f)}catch(e){}if(!d)if(v=f.getAuthenticationRedirect())(y=new i.default(v)).setQueryParameter("ReturnUrl",o.default.encodeURIComponent(window.location.href)),window.location.href=y.toString()}else{try{s(f)}catch(e){}var v,y;if(!d)if(v=(this._webAbsoluteUrl||this._webServerRelativeUrl)+"/_layouts/15/AccessDenied.aspx")(y=new i.default(v)).setQueryParameter("Source",o.default.encodeURIComponent(window.location.href)),y.setQueryParameter("Type","list"),y.setQueryParameter("correlation",o.default.encodeURIComponent(f.getCorrelationId())),window.location.href=y.toString()}return}if(200===p||201===p||204===p)return void r(f);if(403===p)return e._requestDigestPromise=void 0,void(d?this._ensureRequestDigestWorker(void 0,function(){return s(f)}):m?this._redirectToErrorCustomPromptLocation(t):this._ensureRequestDigestWorker(void 0));401===p&&m&&this._redirectToErrorCustomPromptLocation(t),s(f)}},e.prototype._tryLoadDigest=function(t){var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n.updateFormDigestPageLoaded.getTime()<t.updateFormDigestPageLoaded.getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)},e.prototype._shouldRedirectToErrorCustomPromptLocation=function(e){var t=e.getResponseHeader("X-SPO-ErrorCode"),n=e.getResponseHeader("sharepointerror");return"9.3"===t||"-2130575129"===n},e.prototype._redirectToErrorCustomPromptLocation=function(e){var t=new i.default(e.getResponseHeader("X-SPO-ErrorCustomPromptLocation"));t.setQueryParameter("ReturnUrl",window.location.href),window.location.href=t.toString()},e.INTERVAL_ADJUST=10,e._formDigests={},e._requestDigestPromise=void 0,e}();t.default=f},dc89aa5278a9a06d2126:function(e,t,n){"use strict";n("98bae3dbabd51089d613");var r=n("60f875299f1223db95fd"),i=(n("4986dedaa57d766e48bb")["_U794z/V4Yk4dK01T0aO4lQ"],n("52c0e9e1090488830143")),o=(n("0a3e1b609e40999fd831"),n("caeea5a1a89264bf5175")),a=(n("7e182c09f4566649b389"),n("d6e6a1e726db94fe6759"));function s(e,t){void 0===t&&(t=!1);var n=new Date(e),r=n.getTimezoneOffset()<0,i=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),u=Object(a.leftPad)(n.getHours()+"",2),c=Object(a.leftPad)(n.getMinutes()+"",2),d=Object(a.leftPad)(n.getSeconds()+"",2),l=(r?"+":"-")+Object(a.leftPad)(r?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?i+"-"+o+"-"+s+"T"+u+":"+c+":"+d+l:i+o+s+"T"+u+c+d+l}function u(e,t){void 0===t&&(t=!1);var n=e.split("|");if("0"===n[0])return e.substring(2);var i="1"===n[1],s=n[2],u=n[3]||"",c=n[4]||"";switch(s){case"1":return Object(o.b)("AFewSeconds",t,i);case"2":return Object(o.b)("AboutAMinute",t,i);case"3":return Object(o.a)(Number(u),"XMinutes",t,i);case"4":return Object(o.b)("AboutAnHour",t,i);case"5":return u?Object(a.format)(Object(o.b)(i?"TomorrowAndTime":"YesterdayAndTime",t),u):Object(o.b)(i?"Tomorrow":"Yesterday",t);case"6":return Object(o.a)(Number(u),"XHours",t,i);case"7":return c?Object(a.format)(r.a.RelativeDateTime_DayAndTime,u,c):u;case"8":return Object(o.a)(Number(u),"XDays",t,i);case"9":return Object(o.b)("Today",t)}return null}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u})},dccf0341ea4deb985b9e:function(e,t,n){"use strict";var r=n("31c1cddf44fcb4b5ef81");n.o(r,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return r.ResultTypeEnum})},dd7710060b79460ec18c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n("98bae3dbabd51089d613"),o=n("16f7a8beee83cf78aabb"),a=n("11822ca032e86a04398f"),s=n("b2115b5c9c165e0e8a79"),u=0;!function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}(t.ClonedEventType||(t.ClonedEventType={})),function(e){e[e.NoParent=1]="NoParent"}(r=t.ValidationErrorType||(t.ValidationErrorType={})),function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown"}(t.AccountType||(t.AccountType={})),t.addEventProps=function(e,t,n,r){s.assign(e,t);var o={};for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a)){var u=n[a],c=o[a]="number"==typeof u?{type:u}:u;c.definedInName=t.shortEventName,2===c.type&&(c.isMetric=!0)}e.metadata=r?i.__assign({},r.prototype.metadata,o):o};var c=new WeakMap,d=function(){function e(e,t,n){this.context={},this.validationErrors=0,this.data={},this.context=i.__assign({},this.addContext({})),this.id=u++,this.enabled=this._isEnabled(),n?this.parentId=n.id:this.requiresParent&&this._addValidationError(r.NoParent),this.startTime=e&&e.startTimeOverride||o.Manager.getTime(),this.vector=new a.CorrelationVector(n?n.vector:a.CorrelationVector.RootVector),e&&this._setData(e),this._logEvent(t)}return e.enabled=function(){return this.prototype._isEnabled()},e.isTypeOf=function(e){return e.eventName.indexOf(this.prototype.shortEventName+",")>=0},e.withManager=function(e){if(!e||e===o.Manager)return this;var t=c.get(e);t||(t=new WeakMap,c.set(e,t));var n=t.get(this);if(n)return n;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(this);return r.prototype.manager=e,n=r,t.set(this,n),n},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return i.__assign({},e,t)}:e;return function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(n,e),n.prototype.addData=function(n){var r=i.__assign({},n,t(n));return i.__assign({},r,e.prototype.addData.call(this,r))},n}(this)},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return i.__assign({},e,t)}:e;return function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(n,e),n.prototype.addContext=function(n){var r=i.__assign({},n,t(n));return i.__assign({},r,e.prototype.addContext.call(this,r))},n}(this)},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this},e.prototype.addContext=function(e){return f(this.manager,e,{})},e.prototype.addData=function(e){return e},e.prototype._isEnabled=function(){return!this.samplingFeature||o.Manager.isFeatureEnabled(this.samplingFeature)},e.prototype._setData=function(e){var t,n,r=this.data;try{for(var o=i.__values(Object.keys(e)),a=o.next();!a.done;a=o.next()){var u=a.value;u in this.metadata&&l(this.manager,e,r,u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}s.assign(this.data,this.addData(this.data))},e.prototype._logEvent=function(e){this.manager.logEvent(this,e)},e.prototype._addValidationError=function(e){this.validationErrors=this.validationErrors|e,this.manager.logValidationError(this,e)},e}();function l(e,t,n,r){var i=t[r];switch(typeof i){case"string":var o=e.cleanString(i,r);return void(void 0!==o&&(n[r]=o));case"undefined":return;case"object":return void(i&&Object.getPrototypeOf(i)===Object.prototype?n[r]=f(e,i,{}):n[r]=i);default:return void(n[r]=i)}}function f(e,t,n){var r,o;try{for(var a=i.__values(Object.keys(t)),s=a.next();!s.done;s=a.next()){l(e,t,n,s.value)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return n}t.EventBase=d;var p=d.prototype;p.eventName="EventBase,",p.shortEventName="EventBase",p.critical=!1,p.requiresParent=!0,p.manager=o.Manager},e1c8dc4e514231c05155:function(e,t,n){"use strict";function r(e){return!!e&&"function"==typeof e.addEventListener}function i(e){return!!e&&!!e.__events__}function o(e,t){var n=e,r=n.__declaredEvents=n.__declaredEvents||{};if("string"==typeof t)r[t]=!0;else for(var i=0;i<t.length;i++)r[t[i]]=!0}function a(e,t,n,o){var a;if(r(e)){if(document.createEvent){var s=document.createEvent("HTMLEvents");s.initEvent(t,o,!0),s.args=n,a=e.dispatchEvent(s)}}else for(;e&&!1!==a;)if(i(e)){var u=e.__events__[t];for(var c in u)for(var d=u[c],l=0;!1!==a&&l<d.length;l++){var f=d[l];f.objectCallback&&(a=f.objectCallback.call(f.parent,n))}e=o?e.parent:null}else e=null;return a}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a})},edc85ca7e3cf7e290237:function(e,t,n){"use strict";var r;!function(e){e[e.none=0]="none",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation"}(r||(r={})),t.a=r},f30b55e34961feeae484:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return l});var r=window.performance,i=!!r&&"function"==typeof r.mark&&"function"==typeof r.clearMarks&&"function"==typeof r.now,o="EUPL.",a=0,s=window._perfMarks=window._perfMarks||[];function u(e,t){var n=0===e.lastIndexOf(o,0)?e:o+e;(null==t||a<t)&&(i?r.mark(n):s.push({name:n,startTime:Date.now()}),a++)}function c(e){var t=0===e.lastIndexOf(o,0)?e:o+e;if(i){var n=r.getEntriesByName(t);return n&&n.length>0?Math.round(n[0].startTime):NaN}var a=s.filter(function(e){return e.name===t})[0];return a&&a.startTime}function d(e){var t=[];e&&(t=e.map(function(e){return 0===e.lastIndexOf(o,0)?e:o+e})),i?r.getEntriesByType("mark").filter(function(e){return t.length>0?t.indexOf(e.name)>=0:0===e.name.lastIndexOf(o,0)}).forEach(function(e){r.clearMarks(e.name)}):s=[]}function l(){return i?r.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(o,0)}):s}},f842b3fb581d0a13ab27:function(e,t,n){"use strict";var r,i=n("6631b0451e9f577f414d"),o=n("87e95cd1ff4b249d307f"),a=n("5589fc95fa555cd0b06c");!function(e){e[e.blocked=0]="blocked",e[e.exception=-1]="exception",e[e.timeout=-2]="timeout",e[e.abort=-3]="abort"}(r||(r={}));var s=function(){function e(t){this._async=new i.a(this);var n=t.url,r=t.requestTimeoutInMS,o=void 0===r?e.DEFAULT_TIMEOUT_MS:r,a=t.json,s=t.responseType,u=void 0===s?"":s,c=t.headers,d=void 0===c?{}:c,l=t.withCredentials,f=void 0!==l&&l,p=t.needsCors,h=void 0!==p&&p,_=t.onProgress,g=t.onUploadProgress,m=t.method,v=void 0===m?a?"POST":"GET":m;this._url=n,this._requestTimeoutInMS=o,this._postData=a,this._headers=d,this._method=v,this._withCredentials=f,this._needsCors=h,this._responseType=u,this._progressCallback=_,this._uploadProgressCallback=g}return e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)},e.prototype.start=function(e,t){var n=this;this._successCallback=e,this._failureCallback=t;var r=this._method,i=this._headers;try{this._request=this._getRequest();var s=this._progressCallback,u=this._uploadProgressCallback,c=this._request,d=this._responseType;for(var l in s&&(c.onprogress=function(e){try{s(e)}catch(e){o.default.logError(e)}}),u&&(c.upload.onprogress=function(e){try{u(e)}catch(e){o.default.logError(e)}}),this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS),c.onreadystatechange=function(){if(!n._completed){var e=4;try{e=c.DONE||4}catch(e){}c.readyState===e&&n._requestEndCallback()}},c.open(r,this._url,!0),"withCredentials"in c&&(c.withCredentials=this._withCredentials),c.responseType=d,i)c.setRequestHeader(l,i[l]);c.send(this._postData)}catch(e){o.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:Object(a.b)(i),method:r}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1)}},e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;return t.setRequestHeader=function(){},t.onprogress=function(){},t.ontimeout=function(){},t.onload=function(){e._requestEndCallback()},t},e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e},e.prototype._timeoutCallback=function(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0))},e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){o.default.log(e)}},e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){o.default.log(e)}},e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1,o.default.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}},e.DEFAULT_TIMEOUT_MS=3e4,e}();t.a=s},f89d5af06abf23eb5d7d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("98bae3dbabd51089d613"),i=n("dd7710060b79460ec18c"),o=n("052cdcf43c3b8e9a238f"),a=n("22e720316fb8bade1b0e"),s=n("d6e6a1e726db94fe6759"),u=function(){function e(e){var t=e.logStartEvents,n=void 0===t||t,r=e.context,i=void 0===r?{}:r;this._ariaLoader=e.ariaLoader,this._logStartEvents=n,this._disableCookies=e.disableCookies,this._tenantToken=e.tenantToken,this._ariaQosParams=e.ariaQos,this._ariaOfflineCacheParams=e.offlineCache,this._context=i,this._logConfiguration=e.ariaLogConfiguration}return e.prototype.attach=function(e){var t,n=this,r=!1;return this._getAria().then(function(i){r||(t=n._createLogHandler(i),e.addLogHandler(t).forEach(t))}),function(){r=!0,t&&e.removeLogHandler(t)}},e.prototype._getAria=function(){var e=this,t=this._ariaLoader().then(function(t){return e._initializeLogManager(t),t});return this._getAria=function(){return t},t},e.prototype._createLogHandler=function(e){var t=this,n=this._createLogger(e),r=this._ariaQosParams;return function(s){try{if(s.enabled&&(s.eventType!==i.ClonedEventType.Start||t._logStartEvents)&&(!r||!r.isQosEvent(s))){var u=o.buildAriaEvent(e,s);n.logEvent(u)}}catch(t){var c=void 0;t instanceof e.Exception&&(c=new Error("Aria error: "+t.toString())),t&&t.handled||a.log(c||t)}}},e.prototype._initializeLogManager=function(e){var t=this,n=this._ariaOfflineCacheParams;e.LogManager.isInitialized()||(e.LogManager.initialize(this._tenantToken,r.__assign({disableCookies:this._disableCookies},n?{browserOverrides:{onGetData:n.getData,onSaveData:n.saveData}}:{},this._logConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(t){e.LogManager.flush()}));var i=this._ariaQosParams;i&&e.LogManager.addCallbackListener(function(e,n,r,o){r===t._tenantToken&&i.reportQos({result:e,statusCode:n,events:o})})},e.prototype._createLogger=function(e){var t=new e.Logger(this._tenantToken),n=this._context,i=n.Session,o=n.Version,a=n.OSName,u=n.OSVersion,c=n.Market,d=n.UserId,l=n.Manifest,f=r.__rest(n,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=t.getSemanticContext();for(var h in i&&t.setContext("AppInfo.Session",i),l&&t.setContext("AppInfo.Manifest",l),o&&p.setAppVersion(o),p.setUserLanguage(c||""),d&&p.setUserId(d),a&&p.setDeviceOsName(a),u&&p.setDeviceOsVersion(u),f)if(Object.prototype.hasOwnProperty.call(f,h)){var _=f[h];if(null==_)continue;var g=s.capitalize(h);t.setContext(g,f[h])}return t},e}();t.AriaTelemetryHandler=u},fb198614f77f87ac4d1b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e]},e}();t.CircularBuffer=r},fb4333b46afac6cae82a:function(e,t,n){"use strict";var r=n("a918e6b023e78a8f38a9");n.d(t,"a",function(){return r.PlatformDetection})}}]);
//# sourceMappingURL=precompiled-default~services-files-prefetch~share-dialog.min.35d8f1c233f54b921e7c.js.map