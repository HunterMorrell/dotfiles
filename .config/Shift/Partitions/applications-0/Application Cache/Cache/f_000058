webpackJsonp([20],{1665:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),s(207),s(1669),s(208)},1666:function(t,e){t.exports='<div>\n  <div ng-show="sdc.state === sdc.DropdownStates.INITIAL">\n    <div ng-if="::sdc.teamsProductName" class="settings-dropdown-header" acc-role="menu-item" data-tid="product-name-and-type" ng-bind-html="::sdc.teamsProductName">\n    </div>\n    <div class="login-user-profile">\n      <div aria-hidden="true" class="profile-img-parent">\n        <profile-picture css-class="user-picture img-circle" principal-name="sdc.authenticatedUserUpn" display-name="sdc.authenticatedUserName" source="settings"></profile-picture>\n      </div>\n      <div class="profile-name">\n        <div class="profile-name-text" aria-hidden="true">\n          <span ng-bind="::sdc.authenticatedUserName"></span>\n          <span ng-if="::sdc.isGuestUser" translate-once="{{::$root.resources.strings.guest_tenant_postfix}}"></span>\n        </div>\n        <button class="ts-sym change-picture app-small-font" ng-if="::sdc.enableUserEditProfile" ng-click="sdc.changeProfile();" data-tid="skypeStatusDropdownMenuItem-changepic" simple-focus="sdc.onFocus($event)" simple-blur="sdc.onBlur($event)" tabindex="0">\n          <span aria-hidden="true">{{::sdc.changeUserInfoDisplayText}}</span>\n        </button>\n      </div>\n    </div>\n\n    <ul acc-role="menu dialog" class="dropdown-menu">\n      <li acc-role="menu-item focus-default has-sub-menu" class="popover-parent" ng-click="sdc.closeOpenDropdowns()">\n        <button ng-if="sdc.showSelfPresence" class="ts-sym" aria-label="{{sdc.getChangeStatusAriaLabel()}}" aria-labelledby="personAvailabilityPopover personal-skype-status-text" id="personAvailabilityPopover" data-tid="personAvailabilityPopover">\n          <div>\n            <skype-status mri="sdc.authenticatedUserMri" show-text="true"></skype-status>\n            <ng-include ng-if="sdc.canUserChangePresence" class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n          </div>\n        </button>\n\n        \x3c!-- FLW Presence --\x3e\n        <ul ng-if="sdc.canUserChangePresence && sdc.shouldShowFlwPresence" class="app-default-menu popover child-popover settings-dropdown-status" acc-role="sub-menu" tabindex="-1">\n          <li ng-if="sdc.canUserSetBusyOnShiftStatus" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_busy|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 2)" data-tid="skypeStatusDropdownMenuItem-busy">\n              <static-skype-status status="2" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled && sdc.canUserSetBusyOnShiftStatus" acc-role="menu-separator" class="divider"></li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_reset|translate}}">\n            <button class="reset-presence ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 11)" data-tid="skypeStatusDropdownMenuItem-reset">\n              <ng-include class="icon-reset" alt="{{($root.resources.strings.status_reset|translate)}}" role="presentation" src="\'svg/icons-retry.html\'"></ng-include>\n              <span class="status-text">{{::$root.resources.strings.status_reset|translate}}</span>\n            </button>\n          </li>\n        </ul>\n        \x3c!-- IW Presence --\x3e\n        <ul ng-if="sdc.canUserChangePresence && !sdc.shouldShowFlwPresence" class="app-default-menu popover child-popover settings-dropdown-status" acc-role="sub-menu" tabindex="-1">\n          <li acc-role="sub-menu-item focus-default" class="menuitem" aria-label="{{::$root.resources.strings.status_online|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 1)" data-tid="skypeStatusDropdownMenuItem-online">\n              <static-skype-status status="1" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_busy|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 2)" data-tid="skypeStatusDropdownMenuItem-busy">\n              <static-skype-status status="2" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          \x3c!-- Use OutToLunch (6) to indicate DoNotDisturb --\x3e\n          <li acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_doNotDisturb|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 6)" data-tid="skypeStatusDropdownMenuItem-donotdisturb">\n              <static-skype-status status="6" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li ng-if="!sdc.unfiedPresenceStatesEnabled" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_away|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 3)" data-tid="skypeStatusDropdownMenuItem-away">\n              <static-skype-status status="3" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_beRightBack|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 7)" data-tid="skypeStatusDropdownMenuItem-berightback">\n              <static-skype-status status="7" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_appear_away|translate}}">\n            <button class="ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 10)" data-tid="skypeStatusDropdownMenuItem-appearaway">\n              <static-skype-status status="10" show-text="true"></static-skype-status>\n            </button>\n          </li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled" acc-role="menu-separator" class="divider"></li>\n          <li ng-if="sdc.unfiedPresenceStatesEnabled" acc-role="sub-menu-item" class="menuitem" aria-label="{{::$root.resources.strings.status_reset|translate}}">\n            <button class="reset-presence ts-sym" ng-click="sdc.setUserPresenceAndHideDropdown($event, 11)" data-tid="skypeStatusDropdownMenuItem-reset">\n              <ng-include class="icon-reset" alt="{{($root.resources.strings.status_reset|translate)}}" role="presentation" src="\'svg/icons-retry.html\'"></ng-include>\n              <span class="status-text">{{::$root.resources.strings.status_reset|translate}}</span>\n            </button>\n          </li>\n        </ul>\n      </li>\n      <li id="settingsDropdownStatusMessage" ng-if="sdc.enableStatusMessage && sdc.showStatusMessage" aria-label="{{sdc.statusAriaLabel}}" tabindex="-1" class="status-message-list-item">\n        <div ng-if="::!sdc.enableStatusNoteV2" class="status-background status-message" ng-bind="sdc.statusMessage"></div>\n        <div ng-if="::sdc.enableStatusNoteV2" class="status-background status-message" compile-html="sdc.statusMessage"></div>\n        <div class="status-lower-options-info status-background">\n          <div class="expiryTimeLabel" ng-if="sdc.expirationDisplay && sdc.showExpiryTime">\n            {{ sdc.expirationDisplay }}\n          </div>\n        </div>\n        <button id="settings-dropdown-status-note-actions-edit" ng-if="sdc.canSetStatusMessage && sdc.showStatusMessage" acc-role="menu-item" post-render="$parent.focusOnStatusMessage" aria-label="{{::$root.resources.strings.settings_options_status_note_edit | translate}}" aria-describedby="settingsDropdownStatusMessage" title="{{::$root.resources.strings.settings_options_status_note_edit | translate}}" class="status-button-list-item status-button status-background leftmost-button" space-action ng-click="sdc.editStatusNote()" data-tid="settings-dropdown-status-edit">\n            <ng-include src="\'svg/icons-edit.html\'" class="status-buttons-show-hide-wrapper"></ng-include>\n        </button>\n        <button acc-role="menu-item" ng-if="sdc.canSetStatusMessage && sdc.showStatusMessage" ng-keydown="sdc.preventLeftArrowCloseStatusMenu($event)" aria-label="{{::$root.resources.strings.settings_options_status_note_delete | translate}}" title="{{::$root.resources.strings.settings_options_status_note_delete | translate}}" class="status-button-list-item status-button non-leftmost-button status-background" space-action ng-click="sdc.deleteStatusNote()" data-tid="settings-dropdown-status-delete">\n            <ng-include src="\'svg/icons-delete.html\'" class="non-leftmost-svg status-buttons-show-hide-wrapper"></ng-include>\n        </button>\n      </li>\n      <li id="settingsDropdownOofMessage" ng-if="sdc.enableStatusMessage && sdc.showOOFMessage" aria-label="{{sdc.statusAriaLabel}}" tabindex="-1" class="status-message-list-item">\n        <div class="oof-background">\n          <div class="oof-title" translate-once="{{::$root.resources.strings.out_of_office_title}}"></div>\n          <div class="oof-message" title="{{sdc.oofMessage}}" ng-bind="sdc.oofMessage"></div>\n        </div>\n      </li>\n      <li acc-role="menu-item" ng-if="sdc.enableStatusMessage && sdc.canSetStatusMessage && sdc.showSetStatusMessage" aria-label="{{::$root.resources.strings.settings_options_status_note | translate }}" id="settingsDropdown-statusMessageListItemUnset">\n        <button data-tid="setStatusNoteButton" id="settings-status-unset-button" class="ts-sym left-align-icon" space-action post-render="$parent.focusOnStatusMessage" ng-click="sdc.setStatusNote()">\n          <ng-include src="\'svg/icons-edit-status.html\'"></ng-include>\n          {{ ::$root.resources.strings.settings_options_status_note | translate }}\n        </button>\n      </li>\n      <li acc-role="menu-item">\n        <button class="ts-sym left-align-icon" ng-click="sdc.navigateToSaved(); sdc.hide()" aria-label="{{::$root.resources.strings.settings_saved_aria_label | translate}}" data-tid="savedMessagesMenuItem" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="Saved">\n          <svg class="app-svg icons-bookmark icon-hide-on-hover icons-default-fill">\n            <use xlink:href="#icons-bookmark" href="#icons-bookmark"/>\n          </svg>\n          {{::$root.resources.strings.stars_tab_title | translate}}\n        </button>\n      </li>\n      <li acc-role="menu-item" data-tid="optionsMenuItem">\n        <button class="ts-sym left-align-icon" data-tid="settingsDropdownOptionsButton" ng-click="sdc.optionsSettingsDialogShow();sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="Options">\n          <ng-include src="\'svg/icons-settings.html\'"></ng-include>\n          {{::$root.resources.strings.settings_options | translate}}\n        </button>\n      </li>\n      <li acc-role="menu-separator" class="divider" ng-if="sdc.layoutService.showDevMenus || sdc.showRingSelector"></li>\n      <li class="popover-parent" acc-role="menu-item has-sub-menu" ng-if="::sdc.layoutService.showDevMenus" ng-click="sdc.closeOpenDropdowns()">\n        <button class="ts-sym">\n          Dev Tools\n          <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n        </button>\n        <ul class="app-default-menu popover child-popover" acc-role="sub-menu" tabindex="-1">\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.settings(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_experimental_settings}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_experimental_settings}}"></button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="::!sdc.layoutService.hideDebug">\n            <button class="ts-sym" ng-click="sdc.debug(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_debug_settings}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_debug_settings}}"></button>\n          </li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.layoutService.hideDebug = !sdc.layoutService.hideDebug; sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{sdc.layoutService.hideDebug ? $root.resources.strings.main_gear_show_debug_elements : $root.resources.strings.main_gear_hide_debug_elements}}">\n              <span ng-if="sdc.layoutService.hideDebug" translate-once="{{::$root.resources.strings.main_gear_show_debug_elements}}"></span>\n              <span ng-if="!sdc.layoutService.hideDebug" translate-once="{{::$root.resources.strings.main_gear_hide_debug_elements}}"></span>\n            </button>\n          </li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.authenticationService.clearAdalCache(); sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_clear_adal_auth_cache}}">\n              <span translate-once="{{::$root.resources.strings.main_gear_clear_adal_auth_cache}}"></span>\n            </button>\n          </li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.authenticationService.clearSkypeCache(); sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_clear_skype_auth_cache}}">\n              <span translate-once="{{::$root.resources.strings.main_gear_clear_skype_auth_cache}}"></span>\n            </button>\n          </li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.openUiToolkit(); sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_open_ui_toolkit}}">\n              <span translate-once="{{::$root.resources.strings.main_gear_open_ui_toolkit}}"></span>\n            </button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="sdc.showCortanaDevTools">\n            <button class="ts-sym" ng-click="sdc.cortanaDevToolsDialog(); sdc.hide()">\n              <span>Cortana Dev Tools</span>\n            </button>\n          </li>\n        </ul>\n      </li>\n      <li class="popover-parent" acc-role="menu-item has-sub-menu" ng-if="::sdc.showApiSelector" ng-click="sdc.closeOpenDropdowns()">\n        <button class="ts-sym">\n          Service: {{::sdc.currentApiDisplayName}}\n          <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n        </button>\n        <ul class="app-default-menu popover child-popover" acc-role="sub-menu" tabindex="-1">\n          <li ng-repeat="api in sdc.apis" acc-role="sub-menu-item" ng-class="::{ active: api.active }">\n            <button class="ts-sym" ng-click="sdc.switchApi(api.identifier); sdc.hide()">\n              {{::api.displayName}}\n              <ng-include ng-if="api.active" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n            </button>\n          </li>\n        </ul>\n      </li>\n      <li class="popover-parent" acc-role="menu-item has-sub-menu" ng-if="::sdc.showRingSelector" ng-click="sdc.closeOpenDropdowns()">\n        <button class="ts-sym">\n          {{::sdc.ringSelectorTitle}}: {{::sdc.currentWebRingDisplayName}}\n          <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n        </button>\n        <ul class="app-default-menu popover child-popover" acc-role="sub-menu" tabindex="-1" ng-class="{ \'settings-dropdown-many-rings\': (sdc.rings.length > 4) }">\n          <li ng-repeat="ring in sdc.rings" ng-class="{ active: ring.active }" acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.switchRing(ring.identifier); sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::ring.displayName}}">\n              {{::ring.displayName}}\n              <ng-include ng-if="ring.active" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n            </button>\n          </li>\n          <li acc-role="menu-separator" class="divider"></li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.showRingSelectionDialog(); sdc.hide()" translate-once="{{::$root.resources.strings.ringSetting_more_options}}"></button>\n          </li>\n        </ul>\n      </li>\n      <li acc-role="menu-separator" class="divider" ng-if="sdc.zoomUiEnabled">\n      </li>\n      <li ng-if="sdc.zoomUiEnabled">\n        <div class="zoom-ui-menu">\n          <span class="zoom-ui-title" translate-once="{{::$root.resources.strings.zoom_percent_ui_title_string}}"></span>\n          <button acc-role="menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="sdc.zoomOut();" id="zoom-out-button" title="{{::$root.resources.strings.zoom_out_ui_aria_label | translate}}" aria-label="{{::$root.resources.strings.zoom_out_ui_aria_label | translate}}" data-tid="zoom-out-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomOut">\n              <ng-include src="\'svg/icons-screen-zoom-out.html\'"/>\n          </button>\n          <span class="zoom-percent-ui">({{sdc.zoomPercentString}})</span>\n          <button acc-role="menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="sdc.zoomIn();" id="zoom-in-button" title="{{::$root.resources.strings.zoom_in_ui_aria_label | translate}}" aria-label="{{::$root.resources.strings.zoom_in_ui_aria_label | translate}}" data-tid="zoom-in-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomIn">\n              <ng-include src="\'svg/icons-screen-zoom-in.html\'"/>\n          </button>\n          <button acc-role="menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="sdc.zoomReset();" id="zoom-reset-button" title="{{::$root.resources.strings.zoom_reset_ui_aria_label | translate}}" aria-label="{{::$root.resources.strings.zoom_reset_ui_aria_label | translate}}" data-tid="zoom-reset-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomReset">\n              <ng-include src="\'svg/icons-reset-zoom.html\'"/>\n          </button>\n        </div>\n      </li>\n      <li acc-role="menu-separator" class="divider"></li>\n      <li acc-role="menu-item" ng-if="::sdc.isFreemiumAdmin" data-prevent-trigger-refocus="true">\n        <button class="ts-sym" ng-click="sdc.gotoManage(); sdc.hide()" id="manage-button" aria-label="{{::$root.resources.strings.settings_manage_aria_label | translate}}" data-tid="manage-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_manage}}" translate-once="{{::$root.resources.strings.main_gear_manage}}">\n        </button>\n      </li>\n      <li acc-role="menu-item" ng-if="sdc.enableHelpItem && !sdc.enableNewHelpInAppBar">\n        <button class="ts-sym" ng-click="sdc.gotoHelp(); sdc.hide()" id="help-button" aria-label="{{::$root.resources.strings.settings_help_aria_label | translate}}" data-tid="help-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_help}}" translate-once="{{::$root.resources.strings.main_gear_help}}"></button>\n      </li>\n      <li acc-role="menu-item">\n        <button class="ts-sym" ng-click="sdc.keyboardShortcuts(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_keyboard_shortcuts}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_keyboard_shortcuts}}"></button>\n      </li>\n      <li class="popover-parent" data-tid="about-menu" acc-role="menu-item has-sub-menu" ng-click="sdc.closeOpenDropdowns()">\n        <button class="ts-sym" aria-label="{{::$root.resources.strings.settings_about_aria_label | translate}}">\n          {{::$root.resources.strings.main_gear_about | translate}}\n          <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n        </button>\n        <ul class="app-default-menu popover child-popover move-up" acc-role="sub-menu" tabindex="-1">\n          <li acc-role="sub-menu-item" ng-if="sdc.isDesktopApp">\n            <button class="ts-sym" ng-click="sdc.about(); sdc.hide()" id="about-button" data-tid="about-button" translate-once="{{::$root.resources.strings.settings_version}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_about}}"></button>\n          </li>\n          <li acc-role="sub-menu-item">\n            <a data-tid="legal" href="{{::sdc.legalLinkUrl}}" ng-click="sdc.hide()" target="_blank" translate-once="{{::$root.resources.strings.main_gear_legal}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_legal}}">\n            </a>\n          </li>\n          <li acc-role="sub-menu-item">\n            <button class="ts-sym" ng-click="sdc.openPrivacyLink(); sdc.hide()" id="privacy-button" data-tid="privacy-cookies" translate-once="{{::$root.resources.strings.main_gear_privacy}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_privacy}}"></button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="::sdc.enableDesktopTpn">\n            <button class="ts-sym" ng-click="sdc.desktopThirdPartyNoticeShow(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_desktop_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_desktop_third_party_notice}}"></button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="::sdc.enableDesktopTpn">\n            <button class="ts-sym" data-tid="third-party-notice-button" ng-click="sdc.thirdPartyNoticeDialogShow(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_desktop_browser_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_desktop_browser_third_party_notice}}"></button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="::sdc.enableWebTPN">\n            <button class="ts-sym" data-tid="third-party-notice-button" ng-click="sdc.thirdPartyNoticeDialogShow(); sdc.hide()" translate-once="{{::$root.resources.strings.main_gear_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_third_party_notice}}"></button>\n          </li>\n          <li acc-role="sub-menu-item" ng-if="::sdc.showPublicDevPreviewSetting" ng-class="::{\'active\': sdc.publicDevPreviewEnabled}">\n            <button class="ts-sym" ng-click="sdc.togglePublicDevPreview(); sdc.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::sdc.publicDevPreviewEnabled ? \'Disable PublicDevPreview\' : \'Enable PublicDevPreview\'}}">\n              {{::$root.resources.strings.main_gear_developer_preview | translate}}\n              <ng-include ng-if="::sdc.publicDevPreviewEnabled" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n            </button>\n          </li>\n        </ul>\n      </li>\n      <li acc-role="menu-item" ng-if="sdc.isDesktopApp">\n        <button class="ts-sym" ng-click="sdc.checkForUpdates(); sdc.hide()" id="checkupdates-button" aria-label="{{::$root.resources.strings.settings_check_update_aria_label | translate}}" data-tid="checkupdates-button" translate-once="{{::$root.resources.strings.main_gear_check_for_updates}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_check_for_updates}}"></button>\n      </li>\n      <li acc-role="menu-item" ng-if="::sdc.isDesktopHwaApp">\n        <button class="ts-sym" ng-click="sdc.openStoreListing(); sdc.hide()" id="open-store-listing-button" aria-label="{{::$root.resources.strings.settings_open_store_listing_aria_label | translate}}" data-tid="open-store-listing-button" translate-once="{{::$root.resources.strings.main_gear_open_store_listing}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_open_store_listing}}"></button>\n      </li>\n      <li acc-role="menu-item" ng-if="::sdc.showDesktopDownload">\n        <button class="ts-sym" ng-click="sdc.downloadApp(); sdc.hide()" id="download-app-button" data-tid="download-app-button" translate-once="{{::$root.resources.strings.main_gear_download_app}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_download_app}}"></button>\n      </li>\n      <li acc-role="menu-item" ng-if="::sdc.showMobileDownload">\n        <button class="ts-sym" ng-click="sdc.downloadMobileApp(); sdc.hide()" id="download-mobile-app-button" aria-label="{{::$root.resources.strings.settings_download_mobile_app_aria_label | translate}}" data-tid="download-mobile-app-button" translate-once="{{::$root.resources.strings.main_gear_download_mobile_apps}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_download_mobile_apps}}"></button>\n      </li>\n      <li acc-role="menu-separator" class="divider"></li>\n      <li acc-role="menu-item" data-tid="logoutMenuItem">\n        <button class="ts-sym" ng-click="sdc.logOut(); sdc.hide()" id="logout-button" aria-label="{{::$root.resources.strings.settings_logout_aria_label | translate}}" data-tid="logout-button" translate-once="{{::$root.resources.strings.main_gear_logout}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.logout}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingLogout}}" track-type="{{::$root.trackConstants.trackType.menuItem}}" track-summary="{{::$root.resources.strings.main_gear_logout}}"></button>\n      </li>\n      <li ng-if="::sdc.isFreemiumAdmin" acc-role="menu-separator" class="divider"></li>\n    </ul>\n    <button class="ts-btn ts-btn-primary admin-upgrade-button" ng-if="::sdc.isFreemiumAdmin" ng-click="sdc.onUpgradeClick(); sdc.hide()" id="upgrade-button" type="button" data-tid="upgrade-button" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.settingsDropdownUpgrade}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.freemium}}" track-name="{{::$root.trackConstants.trackModuleName.settingsDropdownUpgrade}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Freemium Upgrade">{{::$root.resources.strings.manage_tenant_upgrade_button_text | translate}}</button>\n  </div>\n  <div acc-role="focus-default" class="settingsNote" ng-if="sdc.state === sdc.DropdownStates.STATUSNOTE" ng-controller="SettingsSetNoteDropdownController as setNoteController" ng-click="setNoteController.closeOpenDropdowns()" ng-include="\'components/settings-dropdown/settings-set-note-dropdown/settings-set-note-dropdown.html\'">\n  </div>\n</div>\n'},1667:function(t,e){t.exports='<button class="backButton" data-tid="backButton" ng-click="setNoteController.back()" aria-label="{{::$root.resources.strings.settings_status_dropdown_back_label|translate}}">\n  <ng-include src="\'svg/icons-chevron-left.html\'" class="backArrow"></ng-include>\n  <div class="backText">\n    {{::$root.resources.strings.settings_status_dropdown_back_label|translate}}\n  </div>\n</button>\n<div ng-if="::sdc.enableStatusNoteV2">\n  <div class="statusEditBox" data-tid="statusEditBox" ng-keyup="setNoteController.onInputChange()" ng-keydown="setNoteController.onKeyDown($event)">\n    <div class="statusEditBoxAtMentions">\n      <at-mentions is-tenant-search="true" id="statusnote" hide-logged-in-user="true" hide-empty-results="hideEmptyResults" show-exact-matches-only="showExactMatchesOnly" search-text="searchText" contact-selected="setNoteController.addMention(contact, false, event)" search-results-updated="atMentionResultsChanged" custom-class="ts-mentions-search-dropdown-meetup-pane">\n      </at-mentions>\n    </div>\n    <div class="ts-edit-box">\n      <div class="ts-text-watermark" data-tid="textWatermark" ng-click="onPlaceholderClick($event)" aria-hidden="true" ng-style="{\'display\': (!setNoteController.showPlaceholder ? \'none\' : \'block\')}">\n        {{::$root.resources.strings.settings_note_status_set_message_placeholder_mentions|translate}}\n      </div>\n      <textarea sanitized class="statusInput">\n      </textarea>\n      <div class="noteCharsLeftCounter" data-tid="noteCharsLeftCounter" ng-class="{\'error\': setNoteController.noteCharsLeftCounter < 0}" ng-bind="setNoteController.noteCharsLeftCounter">\n      </div>\n    </div>\n  </div>\n  <div class="pinnoteSetting" data-tid="pinnoteSetting">\n    <teams-checkbox prefix-data-tid="settings-pin-note" ng-model="setNoteController.noteIsPinned" label-text="{{::$root.resources.strings.settings_note_pinnote|translate}}" narrator-text="{{::$root.resources.strings.settings_note_pinnote|translate}}" swap-order="false">\n    </teams-checkbox>\n    <div tabindex="0" aria-haspopup="true" data-prevent-refocus="true" ng-focus="setNoteController.showPinNoteTooltip($event, true)" ng-mouseenter="setNoteController.showPinNoteTooltip($event, true)" ng-mouseleave="setNoteController.showPinNoteTooltip($event, false)" ng-blur="setNoteController.showPinNoteTooltip($event, false)">\n      <ng-include class="icon" src="\'svg/icons-info.html\'"></ng-include>\n    </div>\n  </div>\n</div>\n<div ng-if="::!sdc.enableStatusNoteV2">\n  <textarea sanitized placeholder="{{::$root.resources.strings.settings_note_status_set_message_placeholder|translate}}" ng-model="setNoteController.statusMessageInEdit" ng-keyup="setNoteController.onInputChange()" maxlength="{{::setNoteController.maxStatusLength}}" class="statusInput" id="settingsSetNote-statusInputBox">\n  </textarea>\n  <div class="statusLength">{{setNoteController.statusLengthCounter}}</div>\n</div>\n<div class="setStatusError" ng-show="setNoteController.showStatusFailedError">\n  {{::$root.resources.strings.settings_note_status_fail_error|translate}}\n</div>\n<div class="expiryTimeLabel" data-tid="expiryTimeLabel" id="expiryTimeLabel" aria-label="{{::$root.resources.strings.settings_note_status_expiry_header|translate}}">\n  {{::$root.resources.strings.settings_note_status_expiry_header|translate}}\n</div>\n<dropdown-select id="settings-set-note-dropdown-dropdown-select" class="form-field-input" ds-options="::setNoteController.expirationTimes" ds-selected-value="setNoteController.selectedExpirationTime" ds-on-change="setNoteController.onSelectExpiryTime(newOption, oldOption)" ds-highlight-selected-option="true" ds-labelledby-id="expiryTimeLabel" ds-max-viewable-items="8" ng-keydown="setNoteController.keyboardToggleExpiry($event)" ng-click="setNoteController.keyboardToggleExpiry($event)">\n</dropdown-select>\n<button ng-if="::!sdc.enableStatusNoteV2" class="ts-btn ts-btn-fluent ts-btn-fluent-primary done" ng-click="setNoteController.setStatus()" aria-label="{{::$root.resources.strings.settings_status_dropdown_done_label|translate}}" ng-disabled="setNoteController.isDoneDisabled">\n  {{::$root.resources.strings.settings_status_dropdown_done_label|translate}}\n</button>\n<div ng-if="::sdc.enableStatusNoteV2">\n  <div class="custom-date-control" ng-show="setNoteController.showCustomDateControl">\n    <div class="expiryDate">\n      <input sanitized type="text" class="date" ng-model="setNoteController.expirationDate" placeholder="{{::$root.resources.strings.settings_note_status_custom_expiration_date_placeholder|translate}}" bs-datepicker aria-hidden="true" data-autoclose="true" data-date-format="mediumDate" data-prefix-event="expiryDatePicker" data-template-url="components/date-picker/date-picker.html" ng-attr-data-placement="{{::setNoteController.getPlacement()}}" data-min-date="today" id="expiryDatePicker"/>\n      <input sanitized type="text" id="expiryTimePicker" class="time" ng-class="{\'dateError\': !setNoteController.isValidExpiryDate}" ng-model="setNoteController.expirationTime" ng-change="setNoteController.validateExpiryDateTime" aria-atomic="true" aria-relevant="all" placeholder="{{::$root.resources.strings.settings_note_status_custom_expiration_time_placeholder|translate}}"/>\n    </div>\n  </div>\n  <div class="setStatusNote">\n    <button class="doneButton ts-btn ts-btn-fluent ts-btn-fluent-primary" ng-click="setNoteController.setStatus()" tabindex="0" data-tid="doneButton" aria-label="{{::$root.resources.strings.settings_status_dropdown_done_label|translate}}" ng-disabled="setNoteController.isDoneDisabled" translate-once="{{::$root.resources.strings.settings_status_dropdown_done_label}}">\n    </button>\n  </div>\n</div>'},1668:function(t,e){t.exports='<div class="pinNoteTooltip tooltip-container" role="alert" aria-live="assertive">\n  <div class="content-container">\n      <div class="tooltip-arrow-up"></div>        \n      <div class="tooltip-content" translate-once="{{::$root.resources.strings.settings_note_status_pinnote_tooltip_content}}"></div>\n  </div>\n</div>'},1669:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(1670),i=function(){return function(t,e,s,n,i,a,o,r){this.displayName=t,this.id=e,this.unreadActivityCount=s,this.isCurrentTenant=n,this.isHomeTenant=i,this.rank=a,this.isRedeemed=o,this.isGuestInTenant=r}}();e.TenantViewModel=i;var a=function(){function t(t,e,s,n,i,a,o,r){this.loggingService=t,this.$scope=e,this.$translate=s,this.$timeout=n,this.authenticationService=i,this.resources=a,this.tenantService=o,this.guestAccessService=r,this.tenantInformationDict={},this.logger=this.loggingService.newLogger("SettingsDropdownTenants"),this.viewMoreTenantsArialLabel=this.$translate.instant(this.resources.strings.tenant_settings_dropdown_overflow_btn_aria_label)}return t.$inject=["loggingService","$scope","$translate","$timeout","authenticationService","resources","tenantService","guestAccessService"],t.prototype.$onInit=function(){var t=this;this.tenantService.isReady().then(function(){var e=t.tenantService.getCachedTenantNotification();e&&e.length>1?t.createTenantVMs(e).finally(function(){t.isReady=!0,t.defaultTenants.length>0&&t.$timeout(function(){$("settings-dropdown-tenants .tenant-option").first().attr("tabindex","0").focus()},0,!1)}):(t.isReady=!1,t.defaultTenants=[],t.overflowedTenants=[])})},t.prototype.selectTenant=function(t){t&&t.id?(this.closeSettingsDropdown(),this.switchTenant(t)):this.logger.warn("[selectTenant] Invalid tenant or tenant ID")},t.prototype.switchTenant=function(t){var e=this,s=this.tenantInformationDict[t.id];this.guestAccessService.switchTenant(this.$scope,s).catch(function(t){e.logger.warn("In-App Redemption failed. Could not change tenants.")})},t.prototype.closeSettingsDropdown=function(){for(var t=this.$scope;t&&!t.$hide;)t=t.$parent;t&&t.$hide&&t.$hide()},t.prototype.createTenantVMs=function(t){var e=this;return this.authenticationService.getUserInformation().then(function(s){var n=[];_.each(t,function(t){if(!t.hasNoAccess){var a=t.tenantName||t.tenantId,o=t.tenantId===s.profile.tid,r=s.profile.idp?s.profile.idp.indexOf(t.tenantId)>=0:t.tenantId===s.profile.tid,c=r?1:o?2:3,l=teamspace.services.isGuest(t,r);e.tenantInformationDict[t.tenantId]=t,n.push(new i(a,t.tenantId,t.unreadCount,o,r,c,t.isInvitationRedeemed,l))}}),e.defaultTenants=_.sortBy(n,function(t){return t.rank})})},t}();e.SettingsDropdownTenantsController=a,angular.module("teamspace.settingsDropdownTenants",["pascalprecht.translate","teamspace.authenticationService","teamspace.locales","teamspace.loggingService","teamspace.settingsService","teamspace.tenantService"]).component("settingsDropdownTenants",{template:n,controller:a,controllerAs:"sdtc"})},1670:function(t,e){t.exports='\x3c!-- Home Tenant, Current Tenant, and 1 Additional Tenant --\x3e\n<li acc-role="menu-item focus-default" ng-if="::sdtc.isReady" class="tenant-option" aria-describedby="active-{{tenant.id}}" ng-repeat="tenant in ::sdtc.defaultTenants track by tenant.id" data-tid="settingsDropdown-selectTenant-list" aria-posinset="{{::($index+1)}}" aria-setsize="{{::sdtc.defaultTenants.length}}">\n  <button class="ts-sym right-align-icon tenant-btn" ng-class="::{\'unredeemed-tenant\': !tenant.isRedeemed}" title="{{::tenant.displayName}}" ng-disabled="::tenant.isCurrentTenant" ng-click="sdtc.selectTenant(tenant)" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.guestAccess}}" track-scenario="{{::$root.trackConstants.trackScenario.selectTenant}}" track-name="{{::$root.trackConstants.trackModuleName.selectTenantButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Select tenant {{::tenant.id}}" data-tid="settingsDropdown-selectTenant-{{::tenant.id}}">\n    <div class="tenant-list-text">\n      <ng-include class="icon hide-text flex-child-no-shrink" src="\'svg/icons-accept.html\'" ng-if="::tenant.isCurrentTenant">\n      </ng-include>\n      <span ng-show="false" id="active-{{tenant.id}}" ng-if="::tenant.isCurrentTenant" translate-once="{{::$root.resources.strings.tenant_active_label}}">\n      </span>\n      <span class="tenant-name flex-child-no-shrink" ng-bind="::tenant.displayName">\n      </span>\n      <span class="guest-tenant-indicator flex-child-no-shrink" ng-if="::tenant.isGuestInTenant" translate-once="{{::$root.resources.strings.guest_tenant_postfix}}">\n      </span>\n      <span ng-if="::tenant.unreadActivityCount" class="activity-badge activity-badge-alerts">{{::tenant.unreadActivityCount}}</span>\n    </div>\n  </button>\n</li>\n\n\x3c!-- Overflowed Guest Tenant List --\x3e\n<li ng-if="::sdtc.overflowedTenants.length" acc-role="menu-item has-sub-menu" class="popover-parent">\n  <button class="ts-sym view-more-tenants-btn" role="button" aria-label="{{::sdtc.viewMoreTenantsArialLabel}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.guestAccess}}" track-scenario="{{::$root.trackConstants.trackScenario.viewMoreTenants}}" track-name="{{::$root.trackConstants.trackModuleName.viewMoreTenantsButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="View more tenants" data-tid="settingsDropdown-viewMoreTenants">\n    <div>\n      <span aria-hidden="true" translate-once="{{::$root.resources.strings.tenant_settings_dropdown_overflow_btn_text}}">\n      </span>\n      <ng-include class="right-align-icon icon hide-text" src="\'svg/icons-patharrow.html\'" aria-hidden="true">\n      </ng-include>\n    </div>\n  </button>\n  <ul class="app-default-menu popover child-popover" acc-role="sub-menu" tabindex="-1">\n    <li acc-role="sub-menu-item focus-default" class="menuitem" ng-repeat="tenant in ::sdtc.overflowedTenants track by tenant.id">\n      <button class="ts-sym tenant-btn" title="{{::tenant.displayName}}" ng-click="sdtc.selectTenant(tenant)" ng-class="::{\'unredeemed-tenant\': !tenant.isRedeemed}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.guestAccess}}" track-scenario="{{::$root.trackConstants.trackScenario.selectTenant}}" track-name="{{::$root.trackConstants.trackModuleName.selectTenantButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Select tenant {{::tenant.id}}" data-tid="settingsDropdown-selectTenant-{{::tenant.id}}">\n        <div>\n          <span class="tenant-name flex-child-no-shrink" ng-bind="::tenant.displayName">\n          </span>\n          <span class="guest-tenant-indicator flex-child-no-shrink" ng-if="::tenant.isGuestInTenant" translate-once="{{::$root.resources.strings.guest_tenant_postfix}}">\n          </span>\n          <span ng-if="::tenant.unreadActivityCount" class="activity-badge">{{::tenant.unreadActivityCount}}</span>\n        </div>\n      </button>\n    </li>\n  </ul>\n</li>'},207:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=s(1666),a=s(208);!function(t){t[t.INITIAL=0]="INITIAL",t[t.STATUSNOTE=1]="STATUSNOTE"}(n=e.SettingsDropDownStates||(e.SettingsDropDownStates={}));var o=function(){function t(t,e,s,i,a,o,r,c,l,u,p,d,g,m,h,S,k,y,v,f,b,w,$,C,T,D,x,P,M,E,A,N,O,I,U,B,L,F,H,z,R,V,G,j){var K=this;this.$window=t,this.$q=e,this.$translate=s,this.$state=i,this.resources=a,this.authenticationService=o,this.constants=r,this.callingPolicyStore=c,this.layoutService=l,this.ngDialog=u,this.settingsService=p,this.tenantSettingsStore=d,this.userResourcesSettingsStore=g,this.downloadAppService=m,this.protocolLauncherService=h,this.updateAppService=k,this.$timeout=y,this.dialogService=v,this.helpService=f,this.shortcutService=b,this.navigationService=w,this.identityService=C,this.$scope=T,this.clientDatabase=D,this.presenceService=P,this.presenceManagerService=M,this.voiceSettingsStore=A,this.loggingService=N,this.analyticsService=O,this.desktopUtilityService=I,this.appInfoService=U,this.freemiumUtilities=L,this.unifiedPresenceService=F,this.sfbTeamsUpgradeService=H,this.htmlSanitizer=z,this.dateFormatService=R,this.utilityService=V,this.atMentionService=G,this.tenantPrivacyProfileService=j,this.enableNewHelpInAppBar=!1,this.zoomUiEnabled=!1,this.zoomPercentString="100%",this.canUserSetBusyOnShiftStatus=!1,this.enableFlwPresence=!1,this.shouldShowFlwPresence=!1,this.DropdownStates=n,this.state=this.DropdownStates.INITIAL,this.chatServiceIntEnvironmentApis=["merlotcity","local"],this.logger=N.newLogger("settings-dropdown"),this.isMac=p.getOsPlatform()===teamspace.services.OsPlatform.Mac,this.processApis(),this.processRings(),this.processPublicDevPreviewSetting(),this.isDesktopHwaApp=I.isDesktopHwa(),this.isDesktopApp=I.isDesktopHwa()||I.isElectron(),this.isCentennial=t.desktopEnvironment&&t.desktopEnvironment.isCentennial,this.showAppPreferences=p.valueAsBoolean(r.settings.names.enableAppPreferences)&&this.isDesktopApp,this.enableHelpItem=p.valueAsBoolean(r.settings.names.botsEnabled),this.enableWebTPN=p.valueAsBoolean(r.settings.names.enableThirdPartyNoticeEntry)&&!this.isDesktopApp,this.enableDesktopTpn=p.valueAsBoolean(r.settings.names.enableThirdPartyNoticeEntry)&&this.isDesktopApp,this.enableNewHelpInAppBar=p.valueAsBoolean(r.settings.names.enableNewHelpInAppBar),this.enableStatusNoteV2=p.valueAsBoolean(r.settings.names.enableStatusNoteV2),this.zoomUiEnabled=I.isElectron()&&t.desktopSettings.zoomUiEnabled,this.handleZoomUi(),this.unfiedPresenceStatesEnabled=P.isUnfiedPresenceStatesEnabled();var X=B.isCortanaEnabled();teamspace.services.QCancelable.toCancelablePromise(e,X,T).then(function(t){return K.showCortanaDevTools=t}).catch(function(){return K.showCortanaDevTools=!1}),this.isMsInternalUser=o.isMsInternalUser(),this.legalLinkUrl=this.isFreemiumTenant?this.isFreemiumAdmin?r.legal.legalUrlFreemium.admin:r.legal.legalUrlFreemium.user:r.legal.legalUrl,this.showDesktopDownload=!this.isDesktopApp&&S.osSupportsDesktopApp()&&!p.valueAsBoolean(r.settings.names.hideDownloadDesktopAppEntry),this.showMobileDownload=!p.valueAsBoolean(r.settings.names.hideDownloadMobileAppEntry),this.enableFeatureByTenantAndUserSettings(),this.availabilityDropdownTemplate=r.files.templates.availabilityDropdown,this.enableStatusMessage=p.valueAsBoolean(r.settings.names.enableCustomNote),this.enableFlwPresence=p.valueAsBoolean(r.settings.names.enableFlwPresence),this.authenticatedUserMri=E.getCurrentSkypeMri(),this.processUserProfile(),this.isGuestAccessEnabled=$.isGuestAccessEnabled(),this.isGuestUser=C.isGuestUserType(),x.waitForSettingAndGetValue(SkypeX.Services.UserPropertiesStorageKey.isMailboxDiscoverable).then(function(t){K.enableUserEditProfile=t||K.isFreemiumTenant&&!K.isGuestUser}),this.changeUserInfoDisplayText=this.isFreemiumTenant?s.instant(a.strings.user_profile_edit_profile):s.instant(a.strings.user_profile_change_picture),this.shouldFocusOnStatusMessage=!1,T.focusOnStatusMessage=function(t){y(function(){if(K.shouldFocusOnStatusMessage){var e=K.shouldFocusOnEditStatus?t[0].parentElement.parentElement.children:t[0].parentElement.children;_.forEach(e,function(t){t.classList.contains("kb-active")&&(t.removeAttribute("tabindex"),t.classList.remove("kb-active"))}),t&&t.addClass("kb-active").attr("tabindex","0").focus()}})}}return t.$inject=["$window","$q","$translate","$state","resources","authenticationService","constants","callingPolicyStore","layoutService","ngDialog","settingsService","tenantSettingsStore","userResourcesSettingsStore","downloadAppService","protocolLauncherService","platformDetectService","updateAppService","$timeout","dialogService","helpService","shortcutService","navigationService","guestAccessSettingsService","identityService","$scope","clientDatabase","userOfficeSettingsStore","presenceService","presenceManagerService","sxConfig","voiceSettingsStore","loggingService","analyticsService","desktopUtilityService","appInfoService","cortanaConfigurationService","freemiumUtilities","unifiedPresenceService","sfbTeamsUpgradeService","htmlSanitizer","dateFormatService","utilityService","atMentionService","tenantPrivacyProfileService"],Object.defineProperty(t.prototype,"isFreemiumTenant",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableFreemium)&&this.identityService.isFreemiumTenant()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFreemiumAdmin",{get:function(){return this.isFreemiumTenant&&this.identityService.isTenantAdmin()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCheckForUpdatesEnabled",{get:function(){return this.isDesktopApp&&!this.isCentennial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teamsProductName",{get:function(){return this.isFreemiumTenant&&this.settingsService.valueFor(this.constants.settings.names.teamsProductName)},enumerable:!0,configurable:!0}),t.prototype.$onInit=function(){var e=this;this.showSelfPresence=!this.settingsService.valueAsBoolean(this.constants.settings.names.hideSelfPresenceForSfBUser);var s=!1;this.sfbTeamsUpgradeService.getUpgradePolicyV2().then(function(t){e.loggingService.info("SfbTeamsUpgradeService: Fetched sfb upgrade policy "+t.mode),s=e.sfbTeamsUpgradeService.isSfbPolicy(t)}).finally(function(){e.showSelfPresence=e.showSelfPresence||!s,e.selfPresenceSource=s?SkypeX.Services.PresenceSource.SFB:SkypeX.Services.PresenceSource.UPS,e.canUserChangePresence=!e.settingsService.valueAsBoolean(e.constants.settings.names.enableSourceOfPresence)||e.settingsService.valueAsBoolean(e.constants.settings.names.postPresenceToChatService)||e.unifiedPresenceService.isPostToUpsEnabled(),(e.enableStatusMessage||e.enableFlwPresence)&&(e.canSetStatusMessage=!s,e.presence=e.presenceManagerService.trackPresenceV2(e.authenticatedUserMri,teamspace.services.PresencePriority.Medium,t.componentName,e.onPresenceUpdate.bind(e),!1,e.selfPresenceSource),e.onPresenceUpdate())})},t.prototype.$onDestroy=function(){(this.enableStatusMessage||this.enableFlwPresence)&&this.presenceManagerService.untrackPresenceV2(this.authenticatedUserMri,teamspace.services.PresencePriority.Medium,t.componentName,!1,this.selfPresenceSource)},t.prototype.onPresenceUpdate=function(){if(_.isEmpty(this.presence))return this.shouldShowFlwPresence=!1,this.canUserSetBusyOnShiftStatus=!1,this.showOOFMessage=!1,this.showSetStatusMessage=!1,void(this.showStatusMessage=!1);if(!this.enableFlwPresence)return this.shouldShowFlwPresence=!1,this.canUserSetBusyOnShiftStatus=!1,void this.updateStatusMessage();var t=this.presence.flwPresence,e=this.presence.status;switch(t){case SkypeX.Services.UserFlwPresence.OnShift:return this.shouldShowFlwPresence=!0,void(e===SkypeX.Services.UserStatus.Busy?(this.canUserSetBusyOnShiftStatus=!1,this.updateStatusMessage()):(this.canUserSetBusyOnShiftStatus=!0,this.showOOFMessage=!1,this.showStatusMessage=!1,this.showSetStatusMessage=!1));case SkypeX.Services.UserFlwPresence.OffShift:return this.shouldShowFlwPresence=!0,this.canUserChangePresence=!1,this.canUserSetBusyOnShiftStatus=!1,this.showOOFMessage=!1,this.showStatusMessage=!1,void(this.showSetStatusMessage=!1);default:return this.shouldShowFlwPresence=!1,this.canUserSetBusyOnShiftStatus=!1,void this.updateStatusMessage()}},t.prototype.onFocus=function(t){t&&t.target&&t.target.setAttribute("aria-label",this.changeUserInfoDisplayText)},t.prototype.onBlur=function(t){t&&t.target&&t.target.removeAttribute("aria-label")},t.prototype.renderStatusMessage=function(){this.plainTextStatusMessage=this.statusMessage&&this.utilityService.stripHtml(this.htmlSanitizer.sanitizeHtml(this.statusMessage)).trim(),this.formattedExpirationTime=this.dateFormatService.getMessageDisplayableDateTime(this.expirationDate),this.expirationDisplay=this.$translate.instant(this.resources.strings.settings_note_display_until,{expiryTime:this.formattedExpirationTime}),this.showStatusMessage=!!this.statusMessage&&this.isExpiryTimeValid(new Date(this.presence.note.expiry));var t=SkypeX.Services.neverExpireDate.getFullYear()===this.expirationDate.getFullYear();this.showExpiryTime=this.showStatusMessage&&!t&&(!this.showOOFMessage||this.enableStatusNoteV2),this.statusAriaLabel=this.getStatusAriaLabel()},t.prototype.getStatusAriaLabel=function(){return this.plainTextStatusMessage&&this.plainTextStatusMessage.length?this.$translate.instant(this.resources.strings.settings_note_display_message,{statusMessage:this.plainTextStatusMessage,time:this.formattedExpirationTime}):this.isOOF?this.$translate.instant(this.resources.strings.settings_note_oof_message,{statusMessage:this.presence.calendarData.outOfOfficeNote.message}):this.$translate.instant(this.resources.strings.settings_options_status_note)},t.prototype.getChangeStatusAriaLabel=function(){return this.canUserChangePresence?this.$translate.instant(this.resources.strings.settings_options_status_note):""},Object.defineProperty(t.prototype,"isOOF",{get:function(){return this.presence.calendarData&&this.presence.calendarData.isOutOfOffice&&this.presence.calendarData.outOfOfficeNote&&this.presence.calendarData.outOfOfficeNote.message},enumerable:!0,configurable:!0}),t.prototype.updateStatusMessage=function(){if(this.showOOFMessage=!1,this.showStatusMessage=!1,this.showSetStatusMessage=!1,this.enableStatusMessage){this.enableStatusNoteV2?(this.statusMessage=this.presence.note&&this.presence.note.message&&this.htmlSanitizer.sanitizeHtml(this.presence.note.message.trim()),this.statusMessage=this.atMentionService.addPersonCardAttributesToMentionsInMessage(this.statusMessage)):(this.statusMessage=this.presence.note&&this.presence.note.message&&this.utilityService.stripHtml(this.htmlSanitizer.sanitizeHtml(this.presence.note.message)),this.statusMessage=this.statusMessage&&this.statusMessage.trim().substring(0,a.SettingsSetNoteDropdownController._maxStatusLength)),this.expirationDate=this.presence.note&&this.presence.note.message&&new Date(this.presence.note.expiry),this.isExpiryTimeValid(this.expirationDate)||(this.statusMessage="",this.expirationDate=void 0);var t=!!this.statusMessage&&!!this.expirationDate;this.isOOF&&(this.oofMessage=this.htmlSanitizer.sanitizeHtml(this.presence.calendarData.outOfOfficeNote.message),this.showOOFMessage=!0),this.isOOF&&!this.enableStatusNoteV2||(t?this.renderStatusMessage():this.showSetStatusMessage=!0)}},t.prototype.preventLeftArrowCloseStatusMenu=function(t){t.keyCode===this.constants.keyCodes.left&&(t.stopImmediatePropagation(),document.getElementById("settings-dropdown-status-note-actions-edit").focus())},t.prototype.isExpiryTimeValid=function(t){return new Date<t},t.prototype.setStatusNote=function(){this.state=this.DropdownStates.STATUSNOTE,this.sendStatusNoteBITelemetry(teamspace.components.PanelActionScenario.openStatusMessageForm,teamspace.components.PanelModuleName.setStatusMessageButton)},t.prototype.editStatusNote=function(){this.state=this.DropdownStates.STATUSNOTE,this.sendStatusNoteBITelemetry(teamspace.components.PanelActionScenario.openStatusMessageForm,teamspace.components.PanelModuleName.editStatusMessageButton)},t.prototype.deleteStatusNote=function(){var t=this,e={message:"",expiry:SkypeX.Services.neverExpireDate.toISOString()};this.unifiedPresenceService.setMyStatusNote(e).then(function(){t.statusMessage="",t.showStatusMessage=!1}),this.sendStatusNoteBITelemetry(teamspace.components.PanelActionScenario.deleteStatusMessage,teamspace.components.PanelModuleName.deleteStatusMessageButton)},t.prototype.sendStatusNoteBITelemetry=function(t,e){var s=this;_.defer(function(){var n={action:{gesture:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionGesture.click.toString(),teamspace.components.PanelActionGesture,s.logger),outcome:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionOutcome.submit.toString(),teamspace.components.PanelActionOutcome,s.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelActionScenario,s.logger),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.statusMessage.toString(),teamspace.components.PanelActionScenarioType,s.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(e.toString(),teamspace.components.PanelModuleName,s.loggingService).toString(),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.button.toString(),teamspace.components.PanelModuleType,s.loggingService),summary:s.resources.strings.settings_options_status_note}};s.analyticsService.onPanelAction(s.$scope,n)})},t.prototype.onUpgradeClick=function(){this.freemiumUtilities.openUpgradeTeamsUrl()},t.prototype.processApis=function(){var t=this;this.apis=[];var e=this.settingsService.getApi();if(e){var s=this.settingsService.valueFor(this.constants.settings.names.apiSettings);s&&_.keys(s).length>0?(this.showApiSelector=!0,this.currentApiDisplayName=e.friendlyName,this.currentApiId=e.id,_.keys(s).forEach(function(n){var i=s[n];i.friendlyName&&i.friendlyName.length>0&&t.apis.push({identifier:i,displayName:i.friendlyName,active:i.id===e.id})})):this.showApiSelector=!1}},t.prototype.processRings=function(){var t=this;this.rings=[];var e=this.settingsService.valueFor(this.constants.settings.names.ringOverridePermission),s=this.settingsService.getRing();if(s){var n=this.settingsService.valueFor(this.constants.settings.names.availableRings);if(e&&n&&(this.showRingSelector=!0),this.ringSelectorTitle=this.$translate.instant(this.resources.strings.settings_version),this.currentWebRingDisplayName=s.friendlyName,e==this.constants.ringSelection.ringOverridePermission.any)_.forEach(n,function(e){e.friendlyName&&e.friendlyName.length>0&&t.rings.push({identifier:e,displayName:e.friendlyName,active:e.id===s.id})});else if(e==this.constants.ringSelection.ringOverridePermission.optOut){this.ringSelectorTitle=this.$translate.instant(this.resources.strings.settings_preview);var i=this.$translate.instant(this.resources.strings.settings_preview_enabled),a=this.$translate.instant(this.resources.strings.settings_preview_disabled);this.currentWebRingDisplayName=s.isPublic?a:i,_.forEach(n,function(e){t.rings.push({identifier:e,displayName:e.isPublic?a:i,active:e.id===s.id})})}}},t.prototype.switchApi=function(t){var e=this;if("local"===t.id&&this.desktopUtilityService.isDesktop())this.showFeatureNotSupportedDialog();else{var s=this.settingsService.getRootUri()+"?api="+t.id+(t.additionalQsp||""),n=this.$q.when();this.chatServiceIntEnvironmentApis.some(function(s){return s===t.id||s===e.currentApiId})&&(this.authenticationService.clearSkypeCache(),this.authenticationService.clearAdalCache(),n=this.clientDatabase.nukeDB().toNgPromise(this.$q)),n.finally(function(){e.layoutService.reloadApp(e.resources.strings.refresh_message_default,"apiChange",s)})}},t.prototype.showFeatureNotSupportedDialog=function(){var t={confirmMessageTitle:"Local middle tier is not supported in desktop app!",confirmMessageHtmlBody:"Desktop app doesn't work with local middle tier yet. There is some work needed to use 3rd party AAD App when connecting to local middle tier instance.",isConfirmation:!0,confirmDialogType:teamspace.PanelType.lastOwnerLeaveTeamDialog};this.dialogService.open(this.constants.dialogs.confirmDialog,t)},t.prototype.switchRing=function(t){var e=this.settingsService.getRootUri()+"?ring="+t.id;this.layoutService.reloadApp(this.resources.strings.refresh_message_default,"ringChange",e)},t.prototype.processPublicDevPreviewSetting=function(){var t=this.tenantSettingsStore.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isSideLoadedAppsEnabled),e=!!this.settingsService.valueFor(this.constants.settings.names.publicDevPreviewRing);this.publicDevPreviewEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.publicDevPreviewEnabled),this.showPublicDevPreviewSetting=this.publicDevPreviewEnabled||t&&e},t.prototype.togglePublicDevPreview=function(){if(this.publicDevPreviewEnabled){var t=this.settingsService.getRootUri()+"?ring=clear";this.layoutService.reloadApp(this.resources.strings.refresh_message_default,"disableDevPreview",t)}else this.ngDialog.open({template:"components/dev-preview-dialog/dev-preview-dialog.html",className:"ngdialog-dev-preview ngdialog-shared ngdialog-theme-default",closeByEscape:!0,closeByDocument:!0})},t.prototype.navigateToSaved=function(){this.navigationService.navigateToDefaultMySavedState()},t.prototype.settingsDialog=function(t,e,s){this.ngDialog.open({template:"components/settings-list/settings-list.html",className:"ngdialog-settings ngdialog-theme-default",closeByEscape:!0,closeByDocument:!0,controller:"SettingsListController",data:{title:t,cancel:"Cancel",okButton:"OK",settings:e,allSetting:s}})},t.prototype.debug=function(){this.settingsDialog("Debug settings",this.settingsService.debugSettings)},t.prototype.settings=function(){this.settingsDialog("Experimental settings",this.settingsService.settings)},t.prototype.openUiToolkit=function(){return this.navigationService.navigatePromise(this.$scope,this.constants.states.toolkit,{})},t.prototype.cortanaDevToolsDialog=function(){this.dialogService.open(this.constants.dialogs.cortanaDevToolsDialog)},t.prototype.showRingSelectionDialog=function(){this.dialogService.open(this.constants.dialogs.ringSelection)},t.prototype.showRoutingSettingsDialog=function(){this.dialogService.open(this.constants.dialogs.routingSettings)},t.prototype.thirdPartyNoticeDialogShow=function(){this.ngDialog.open({template:"components/third-party-notice/third-party-notice.html",className:"ts-modal-dialog",closeByEscape:!0,closeByDocument:!0})},t.prototype.desktopThirdPartyNoticeShow=function(){this.$window.electronSafeIpc.send(this.constants.events.desktopApp.thirdPartyNotice)},t.prototype.notificationSettingsDialogShow=function(){this.dialogService.open(this.constants.dialogs.notificationSettings)},t.prototype.callForwardingSettingsDialogShow=function(){this.dialogService.open(this.constants.dialogs.callForwardingSettings)},t.prototype.optionsSettingsDialogShow=function(){this.dialogService.open(this.constants.dialogs.optionsSettingsDialog,{preActiveElementIds:[t.profileButtonId]})},t.prototype.logOut=function(){this.authenticationService.logOut(this.constants.events.appState.reasons.userInitiated)},t.prototype.about=function(){this.appInfoService.getVersionInfo()},t.prototype.openPrivacyLink=function(){var t=this;this.tenantPrivacyProfileService.getPrivacyPolicyURL().then(function(e){t.$window.open(e,"_blank")})},t.prototype.checkForUpdates=function(){this.updateAppService.update()},t.prototype.downloadApp=function(){this.downloadAppService.download()},t.prototype.openStoreListing=function(){this.protocolLauncherService.launchStoreListing()},t.prototype.downloadMobileApp=function(){this.settingsService.valueAsBoolean(this.constants.settings.names.enableMobileDownloadMailDialog)?this.dialogService.open(this.constants.dialogs.mobileDownload,{preActiveElementIds:[t.profileButtonId]}):this.$window.open("https://aka.ms/downloadteams","_blank")},t.prototype.gotoHelp=function(){this.helpService.gotoHelp()},t.prototype.gotoManage=function(){this.$state.go(this.constants.states.appManageTenant)},t.prototype.keyboardShortcuts=function(){var t=this;this.$timeout(function(){return t.shortcutService.executeCommand(teamspace.services.CommandIdentifier.ShowShortcuts)})},t.prototype.processUserProfile=function(){var t=this;this.authenticationService.getUserInformation().then(function(e){t.authenticatedUserName=e.profile.name,t.authenticatedUserUpn=e.profile.upn})},t.prototype.setUserPresenceAndHideDropdown=function(t,e){this.setUserPresence(e),t.stopPropagation(),this.hide()},t.prototype.setUserPresence=function(t){var e=this;this.presenceService.setMyStatus(t,"setUserPresence()",!0),_.defer(function(){var t={action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionOutcome.select.toString(),teamspace.components.PanelActionOutcome,e.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.changePresence.toString(),teamspace.components.PanelActionScenario,e.logger),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.presence.toString(),teamspace.components.PanelActionScenarioType,e.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.setPresence.toString(),teamspace.components.PanelModuleName,e.logger),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.people.toString(),teamspace.components.PanelModuleType,e.logger),summary:"changing the Presence"}};e.analyticsService.onPanelAction(e.$scope,t)})},t.prototype.changeProfile=function(){this.dialogService.close(),this.hide(),this.isFreemiumTenant?this.dialogService.open(this.constants.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[t.profileButtonId]}):this.dialogService.open(this.constants.dialogs.changeUserPicture,{preActiveElementIds:[t.profileButtonId]})},t.prototype.hide=function(){this.$scope.$parent.$hide()},t.prototype.closeOpenDropdowns=function(){$(".settings-dropdown .child-popover").removeAttr("style")},t.prototype.zoomIn=function(){this.zoomIpc(this.constants.events.desktopApp.zoomIn)},t.prototype.zoomOut=function(){this.zoomIpc(this.constants.events.desktopApp.zoomOut)},t.prototype.zoomReset=function(){this.zoomIpc(this.constants.events.desktopApp.zoomReset)},t.prototype.zoomIpc=function(t){this.desktopUtilityService.isElectron()&&this.$window.electronSafeIpc.send(t,!0,this.constants.desktopApp.telemetry.zoomSource.settingsDropdownUi)},t.prototype.onZoomLevelChange=function(t,e){this.loggingService.info("New zoom percent: "+e),this.zoomPercentString=this.$translate.instant(this.resources.strings.zoom_percent_ui_string).replace("{0}",String(e)),this.loggingService.info("New zoom percent string is: "+this.zoomPercentString)},t.prototype.handleZoomUi=function(){var t=this;if(this.zoomUiEnabled&&this.$window.electronSafeIpc){var e=this.onZoomLevelChange.bind(this);this.zoomPercentString=this.$translate.instant(this.resources.strings.zoom_percent_ui_string).replace("{0}",String(this.desktopUtilityService.getZoomPercent())),this.$window.electronSafeIpc.on(this.constants.events.desktopApp.zoomLevelChange,e),this.$scope.$on("$destroy",function(){t.$window.electronSafeIpc.removeListener(t.constants.events.desktopApp.zoomLevelChange,e)})}},t.prototype.enableFeatureByTenantAndUserSettings=function(){var t=this;return this.callingPolicyStore.waitForSettingAndGetValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling).then(function(e){e&&(t.settingsService.valueAsBoolean(t.constants.settings.names.routingSettings)&&(t.enableRoutingSettings=!0,t.userResourcesSettingsStore.waitForSettingAndGetValue(SkypeX.Services.UserResourcesStorageKey.isSipEnabled).then(function(e){var s=t.userResourcesSettingsStore.getSettingValue(SkypeX.Services.UserResourcesStorageKey.isSfbCloud);e&&s||(t.logger.debug("Setting enableRoutingSettings to false, isSipEnabled={0}, isSfbCloud={1}",e,s),t.enableRoutingSettings=!1)}).catch(function(e){t.logger.error("userResourcesSettingsStore.waitForSettingAndGetValue errored out {0}",e)})),t.settingsService.valueAsBoolean(t.constants.settings.names.enableCallForwardingSettings)&&t.voiceSettingsStore.waitForSettingAndGetValue(SkypeX.Services.VoiceSettingsStorageKey.isEvEnabled).then(function(e){t.callForwardingSettingsEnabled=e}))}).catch(function(e){t.logger.error("callingPolicyStore.waitForSettingAndGetValue errored out for key: "+SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling+" error: "+e)})},t.componentName="settings-dropdown",t.profileButtonId="personDropdown",t}();e.SettingsDropdownController=o,angular.module("teamspace.settingsDropdown",["teamspace.authenticationService","teamspace.constants","teamspace.guestAccessSettingsService","teamspace.identityService","teamspace.layoutService","teamspace.settingsService","teamspace.downloadAppService","teamspace.protocolLauncherService","teamspace.platformDetectService","teamspace.updateAppService","teamspace.helpService","teamspace.shortcutService","teamspace.eventingService","teamspace.desktopUtilityService","teamspace.appInfoService","teamspace.freemiumUtilities","teamspace.postRender","teamspace.tenantPrivacyProfileService"]).component("settingsDropdown",{template:i,controller:o,controllerAs:"sdc"})},208:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(1667),i=s(1668),a=s(207),o=function(){function t(t,e,s,n,i,a,o,r,c,l,u,p,d,g,m,h,S,k,y,v,f,b,_,w,C,T,D,x,P){var M=this;if(this.$translate=t,this.resources=e,this.$scope=s,this.$element=n,this.$timeout=i,this.$window=a,this.appConfig=o,this.constants=r,this.loggingService=c,this.analyticsService=l,this.unifiedPresenceService=u,this.htmlSanitizer=p,this.utilityService=d,this.channelService=g,this.eventingService=m,this.routeUtilityService=h,this.teamMembershipPropertiesService=S,this.settingsService=k,this.ariaLiveService=y,this.textEditorService=v,this.conversationsService=f,this.performanceDetectService=b,this.messageService=_,this.authenticationService=w,this.semanticObjectService=C,this.atMentionService=T,this.peopleService=D,this.tooltipService=x,this.localizationService=P,this.showBigStatusInputBox=!1,this.showPlaceholder=!0,this.noteIsPinned=!1,this.showCustomDateControl=!1,this.enableStatusNoteV2=!1,this.isDoneDisabled=!0,this.isValidExpiryDate=!0,this.expirationTimeValuesInHours={},this.largeMessageLengthThreshold=192,this.mrisAtMentioned=[],this.timeFormat="h:mma",this.timePickerStart="12am",this.timePickerSelector="#expiryTimePicker",this.datePickerSelector="#expiryDatePicker",this.timePickerListSelector=".ui-timepicker-list",this.timePickerSelectedTimeSelector=".ui-timepicker-selected:visible",this.logger=this.loggingService.newLogger(this.constructor.name),this.enableStatusNoteV2=this.settingsService.valueAsBoolean(r.settings.names.enableStatusNoteV2),this.enableStatusNoteV2){this.pinNoteTooltipId=this.utilityService.generateUUID(),this.allowedKeys=[this.constants.keyCodes.backspace,this.constants.keyCodes.left,this.constants.keyCodes.up,this.constants.keyCodes.right,this.constants.keyCodes.down,this.constants.keyCodes.delete,this.constants.keyCodes.tab];var E=this.$window.CKEDITOR,A={};A.enterMode=E.ENTER_BR||2,A.keystrokes=[[E.CTRL+66,null],[E.CTRL+73,null],[E.CTRL+85,null]],A.forcePasteAsPlainText=!0;var N=this.utilityService.generateUUID();this.$timeout(function(){$(M.$element[0].nextElementSibling.getElementsByClassName("statusInput")).attr("id",N),M.textEditor=M.textEditorService.initEditor(N,A,void 0,void 0,!1),M.updateEditorHandlers()},0,!1),this.$scope.searchText="",this.$scope.hideEmptyResults=!0,this.$scope.showExactMatchesOnly=!1,this.$scope.atMentionResultsChanged=function(t){M.textEditor&&M.textEditor.commandSearchResultsChanged(t)}}}return t.$inject=["$translate","resources","$scope","$element","$timeout","$window","appConfig","constants","loggingService","analyticsService","unifiedPresenceService","htmlSanitizer","utilityService","channelService","eventingService","routeUtilityService","teamMembershipPropertiesService","settingsService","ariaLiveService","textEditorService","conversationsService","performanceDetectService","messageService","authenticationService","semanticObjectService","atMentionService","peopleService","tooltipService","localizationService"],Object.defineProperty(t.prototype,"expirationDate",{get:function(){return this._expirationDate},set:function(t){this.setExpirationDate(t,!0)},enumerable:!0,configurable:!0}),t.prototype.$onInit=function(){var t=this;this.statusMessageInEdit=this.$scope.sdc.statusMessage||"",this.statusMessageInEdit=this.statusMessageInEdit&&this.statusMessageInEdit.trim(),this.setExpirationDate(this.$scope.sdc.expirationDate,!1),this.expirationResourceStrings=[this.resources.strings.settings_note_expiry_never,this.resources.strings.settings_note_expiry_hour,this.resources.strings.settings_note_expiry_hours_four,this.resources.strings.settings_note_expiry_today,this.resources.strings.settings_note_expiry_this_week],this.logger.log("this.statusMessageInEdit = "+this.statusMessageInEdit);var e=this.resources.strings.settings_note_expiry_today;this.enableStatusNoteV2?(this.expirationResourceStrings.push(this.resources.strings.settings_note_expiry_custom),this.timeFormat=this.localizationService.getDateFormatValue("shortTime",!1),this.showCustomDateControl=!1,!this.expirationDate||this.isEndOfToday(this.expirationDate)?e=this.resources.strings.settings_note_expiry_today:this.isEndOfWeek(this.expirationDate)?e=this.resources.strings.settings_note_expiry_this_week:this.expirationDate.getFullYear()===SkypeX.Services.neverExpireDate.getFullYear()?e=this.resources.strings.settings_note_expiry_never:(e=this.resources.strings.settings_note_expiry_custom,this.showCustomDateControl=!0),setTimeout(function(){t.prepareDateTimePickers(!1)})):this.expirationDate&&this.isEndOfWeek(this.expirationDate)?e=this.resources.strings.settings_note_expiry_this_week:this.expirationDate&&this.expirationDate.getFullYear()===SkypeX.Services.neverExpireDate.getFullYear()&&(e=this.resources.strings.settings_note_expiry_never),this._expirationTimes=this.expirationResourceStrings.map(function(e){return t.$translate.instant(e)}),this.selectedExpirationTime=this.$translate.instant(e),this.expirationTimeValuesInHours[this.$translate.instant(this.resources.strings.settings_note_expiry_hour)]=1,this.expirationTimeValuesInHours[this.$translate.instant(this.resources.strings.settings_note_expiry_hours_four)]=4,this.plainTextMessageBeforeEdit=this.utilityService.stripHtml(this.statusMessageInEdit.trim()),this.noteIsPinned=this.isPinnedMessage(this.statusMessageInEdit),this.showPlaceholder=!this.statusMessageInEdit,this.updateStatusCounter(),this.resizeInputBox(),this.focusOnStatusInputBox(),this.sendStatusNoteBITelemetry(teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.viewStatusMessageForm,teamspace.components.PanelModuleType.viewer)},t.prototype.$onDestroy=function(){this.textEditor&&(this.peoplePickerHandler&&this.textEditor.deregisterHandler(this.peoplePickerHandler),this.textEditor.teardownEditor()),this.textEditor=null},t.prototype.showPinNoteTooltip=function(t,e){if(e){var s={template:i,trigger:"manual",placement:this.constants.popover.placement.bottomRight,autoClose:!0,scope:this.$scope},n={sourceElement:angular.element(t.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:s,tooltipId:this.pinNoteTooltipId};this.tooltipService.showTooltip(n)}else this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.pinNoteTooltipId)},t.prototype.back=function(){var e=!!this.$scope.sdc.statusMessage;this.$scope.sdc.shouldFocusOnEditStatus=e,this.navigateToSettingsDropdown(),t.focusOnStatusMessage(e)},t.prototype.updateEditorHandlers=function(){var t=this;this.textEditor?this.peoplePickerHandler?this.textEditor.deregisterHandler(this.peoplePickerHandler):(this.peoplePickerHandler=new teamspace.services.PeoplePickerHandler(this.$scope,this.textEditor,this.constants,this.channelService,this.appConfig,this.eventingService,this.loggingService,this.utilityService,this.routeUtilityService,this.teamMembershipPropertiesService,this.settingsService,this.analyticsService,this.conversationsService,this.$translate,this.resources,this.ariaLiveService,this.performanceDetectService),this.textEditor.registerHandler(this.peoplePickerHandler),this.textEditor.initEditor().then(function(){return t.onEditorReady()})):this.logger.error("textEditor not created inside updateEditorHandlers")},t.prototype.onEditorReady=function(){this.statusMessageBox=$(this.$element[0].nextElementSibling.getElementsByClassName("statusEditBox")),this.textEditor.editor.setData(this.statusMessageInEdit),this.registerEditorFocus(),this.registerEditorBlur(),this.registerEditorOnKey(),this.setFocusOnEditor(),this.textEditor.editor.editable().setAttribute("aria-label",""===this.statusMessageInEdit?this.$translate.instant(this.resources.strings.settings_note_status_set_message_placeholder_mentions):"")},Object.defineProperty(t.prototype,"expirationTimes",{get:function(){return this._expirationTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxStatusLength",{get:function(){return t._maxStatusLength},enumerable:!0,configurable:!0}),t.prototype.updateStatusCounter=function(){var e=this;this.messageLength=this.getMessageLength(),this.noteCharsLeftCounter=t._maxStatusLength-this.messageLength,this.isDoneDisabled=!(this.messageLength>0&&this.noteCharsLeftCounter>=0),this.enableStatusNoteV2?(this.checkAndShowPlaceholder(),this.noteCharsLeftCounter=t._maxStatusLength-this.messageLength,this.updateDoneButtonState()):this.statusLengthCounter=this.$translate.instant(this.resources.strings.settings_note_length,{position:this.messageLength,count:t._maxStatusLength}),this.messageLength>t._maxStatusLength?this.ariaLiveService.update(this.$translate.instant(this.resources.strings.settings_note_status_exceeds_length,{maxLength:t._maxStatusLength}),!0):this.enableStatusNoteV2||(this._updateStatusCounter&&this._updateStatusCounter.cancel(),this._updateStatusCounter=_.debounce(function(){e.ariaLiveService.update(e.statusLengthCounter,!0)},this.constants.timeInMiliseconds.second),this._updateStatusCounter())},t.prototype.onSelectExpiryTime=function(t,e){this.selectedExpirationTime=t,t===this.$translate.instant(this.resources.strings.settings_note_expiry_custom)?(this.showCustomDateControl=!0,this.setExpirationDate(new Date,!1),this.updateTimePicker()):this.showCustomDateControl=!1,this.isValidExpiryDate=!0,this.updateDoneButtonState()},t.prototype.onPlaceholderClick=function(t){this.setFocusOnEditor(),t.preventDefault()},t.prototype.getPlacement=function(){return this.localizationService.langDirection===this.constants.languageDirectionStrings.rtl?"bottom-right":void 0},t.prototype.checkAndShowPlaceholder=function(){this.showPlaceholder=this.textEditor&&this.textEditor.isEmpty()},t.prototype.setFocusOnEditor=function(){this.textEditor&&this.textEditor.editor&&(this.textEditor.editor.focus(),this.textEditor.setCursorToEnd())},t.prototype.getSanitizedMessage=function(){return this.textEditor?this.htmlSanitizer.sanitizeHtml(this.textEditor.getHTML().trim()):this.statusMessageInEdit},t.prototype.getPlainTextMessage=function(){return this.utilityService.stripHtml(this.getSanitizedMessage()).trim()},t.prototype.getMessageLength=function(){return this.getPlainTextMessage().length},t.prototype.getTextLengthForHtmlMessage=function(t){return this.utilityService.stripHtml(t).length},t.prototype.sendChatMessages=function(t){var e=this,s=this.loggingService.newScenario("status note mentions notification"),n=this.semanticObjectService.extractSemanticObjects(t,!1);if(n){var i=n[this.constants.semanticObjectSchemas.mention]||[];i.length?this.authenticationService.getUserInformation().then(function(n){_.each(i,function(a){if(a&&SkypeX.Services.ChatServiceUtils.isRealUserMri(a.userObjectId)){var o=a.userObjectId;e.peopleService.getPeopleProfile(o,"StatusNoteMessage",!1).then(function(a){var r=n.profile.given_name||n.profile.name,c=a.givenName||a.displayName,l=e.$translate.instant(e.resources.strings.status_note_mention_chat_message,{name1:r,name2:c}),u='<div style="width:60rem;">\n                                    <strong>'+l+"</strong>\n                                  </div>\n                                  <blockquote>"+t+"</blockquote>";if(-1===e.mrisAtMentioned.indexOf(o)){e.mrisAtMentioned.push(o);var p=e.conversationsService.getChatConversationWith(o);if(p){var d=SkypeX.Services.Utilities.newClientMessageId();e.messageService.createMessage({conversationId:p.id,replyChainId:null,messageSubject:l,messageBody:u,messagePreview:u,fileAttachments:null,extensions:null,mentions:i,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!0,importance:null,clientId:d,externalId:null,draftObjectId:null,inlineImages:null,scenario:s})}}})}})}):this.logger.log("no @ mentions found in the status note and no chat messages will be sent")}else this.logger.log("no @ mentions found in the status note and no chat messages will be sent")},t.prototype.setStatus=function(){var e,s=this,n="",i=this.loggingService.newScenario(this.constants.scenarios.statusNoteSettings.setNote);if(this.enableStatusNoteV2)if((n=this.getSanitizedMessage()).length&&(this.noteIsPinned&&!this.isPinnedMessage(n)?n+=this.constants.statusNotePinnedTag:!this.noteIsPinned&&this.isPinnedMessage(n)&&(n=n.substring(0,n.indexOf(this.constants.statusNotePinnedTag)))),this.getTextLengthForHtmlMessage(n)<=t._maxStatusLength){a={message:n,expiry:this.getExpiryTime()};this.unifiedPresenceService.setMyStatusNote(a).then(function(){s.getPlainTextMessage()!==s.plainTextMessageBeforeEdit&&(n=s.atMentionService.addPersonCardAttributesToMentionsInMessage(n),s.sendChatMessages(n)),i.stop(),s.navigateToSettingsDropdown();var e=n.length>0;t.focusOnStatusMessage(e)}).catch(function(t){i.fail({error:t}),s.showStatusFailedError=!0,s.ariaLiveService.update(s.$translate.instant(s.resources.strings.settings_note_status_fail_error_live),!0)})}else this.showStatusFailedError=!0,this.ariaLiveService.update(this.$translate.instant(this.resources.strings.settings_note_status_fail_error_live),!0);else{var a={message:n=this.utilityService.stripHtml(this.htmlSanitizer.sanitizeHtml(this.statusMessageInEdit)).trim(),expiry:this.getExpiryTime()};this.unifiedPresenceService.setMyStatusNote(a).then(function(){s.navigateToSettingsDropdown();var e=n.length>0;t.focusOnStatusMessage(e),i.stop()}).catch(function(){i.fail(),s.showStatusFailedError=!0,s.ariaLiveService.update(s.$translate.instant(s.resources.strings.settings_note_status_fail_error_live),!0)})}var o=this.expirationResourceStrings.filter(function(t){return s.$translate.instant(t)===s.selectedExpirationTime})[0];e={statusMessageLength:n.length,expiryDate:o,mentions:this.getMentionsCountInMessage(n),pinned:this.noteIsPinned,oof:!!this.$scope.sdc.isOOF,v2:this.enableStatusNoteV2},this.sendStatusNoteBITelemetry(teamspace.components.PanelActionOutcome.submit,teamspace.components.PanelActionScenario.setStatusMessage,teamspace.components.PanelModuleType.button,e)},t.prototype.onInputChange=function(){this.updateStatusCounter(),this.resizeInputBox(),this.showStatusFailedError=!1},t.prototype.resizeInputBox=function(){this.showBigStatusInputBox=this.messageLength>=this.largeMessageLengthThreshold},t.prototype.addMention=function(t,e,s){void 0===e&&(e=!1),void 0===s&&(s={}),this.peoplePickerHandler.insertInEditor(t,s)},t.prototype.registerEditorFocus=function(){var t=this;this.textEditor.editor.editable().on("focus",function(){t.checkAndShowPlaceholder(),t.statusMessageBox.addClass("statusEditBoxFocus")})},t.prototype.registerEditorBlur=function(){var t=this;this.textEditor.editor.editable().on("blur",function(){t.statusMessageBox.removeClass("statusEditBoxFocus")})},t.prototype.registerEditorOnKey=function(){var t=this;this.textEditor.editor.on("key",function(e){e.data.parent=e,t.onKeyDown(e.data)},null,null,100)},t.prototype.onKeyDown=function(e){this.messageLength>=t._maxStatusLength&&-1===this.allowedKeys.indexOf(e.keyCode)&&(e.keyCode!==this.constants.keyCodes.a||!e.ctrlKey)&&(e.preventDefault(),e.stopPropagation())},t.prototype.focusActiveExpiryDropdownElement=function(t){var e=this;this._focusOnDropdownMenuItem||(this._focusOnDropdownMenuItem=_.debounce(function(){if(t){var s=$(t[0].getElementsByClassName("highlight-selected")[0]);s.length>0&&e.setTabAndIndex(s),e.setDropdownHandlers(t),e._focusOnDropdownMenuItem=void 0}},10),this._focusOnDropdownMenuItem())},t.prototype.setDropdownHandlers=function(t){var e=this,s=$(this.$element[0].nextElementSibling.getElementsByClassName("form-field-input")).find("button").first();t.keydown(function(t){t.preventDefault(),t.stopImmediatePropagation()}),t.keypress(function(t){t.preventDefault(),t.stopImmediatePropagation()}),t.keyup(function(n){e.dropdownKeyHandlers(n,t,s)})},t.prototype.closeOpenDropdowns=function(){this.toggleExpiry(!1,!0)},t.prototype.dropdownKeyHandlers=function(t,e,s){t.keyCode===this.constants.keyCodes.escape||t.keyCode===this.constants.keyCodes.enter?(t.preventDefault(),t.stopImmediatePropagation(),s.focus(),this.toggleExpiry(!1,!0),e.keyup=null):t.keyCode!==this.constants.keyCodes.down&&t.keyCode!==this.constants.keyCodes.up||(t.preventDefault(),t.stopImmediatePropagation())},t.prototype.setTabAndIndex=function(t){angular.isUndefined(t.attr("tabIndex"))&&t.attr("tabIndex","-1"),t[0].focus()},t.prototype.keyboardToggleExpiry=function(t){var e=t.keyCode,s="click"==t.type,n=$(this.$element[0].nextElementSibling.getElementsByClassName("dropdown-menu")),i=$(this.$element[0].nextElementSibling.getElementsByClassName("form-field-input")).find("button");s?(this.toggleExpiry(!0,!0),t.preventDefault(),t.stopImmediatePropagation()):e!==this.constants.keyCodes.down&&e!==this.constants.keyCodes.up&&e!==this.constants.keyCodes.enter||$(document.activeElement)[0]!==i[0]||this.focusActiveExpiryDropdownElement(n)},t.prototype.toggleExpiry=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0);var s=$(this.$element[0].nextElementSibling.getElementsByClassName("ts-dropdown-select")),n=$(this.$element[0].nextElementSibling.getElementsByClassName("dropdown-button")),i=$(this.$element[0].nextElementSibling.getElementsByClassName("dropdown-menu"));!s.hasClass("open")&&t?this.openExpiry(s,i,n):s.hasClass("open")&&e&&this.closeExpiry(s,i,n)},t.prototype.openExpiry=function(t,e,s){t.addClass("open"),e.css({display:"block"}),s.attr("aria-expanded","true"),$('<div class="dropdown-backdrop"></div>').insertAfter(s)},t.prototype.closeExpiry=function(t,e,s){t.removeClass("open"),e.css({display:"none"}),s.attr("aria-expanded","false"),$(this.$element[0].nextElementSibling.getElementsByClassName("dropdown-backdrop")).remove()},t.prototype.getExpiryTime=function(){if(this.selectedExpirationTime===this.$translate.instant(this.resources.strings.settings_note_expiry_never))return SkypeX.Services.neverExpireDate.toISOString();var t=new Date;if(this.selectedExpirationTime===this.$translate.instant(this.resources.strings.settings_note_expiry_today))t=moment().endOf("day").toDate();else if(this.selectedExpirationTime===this.$translate.instant(this.resources.strings.settings_note_expiry_this_week))t=moment().endOf("week").toDate();else if(this.selectedExpirationTime===this.$translate.instant(this.resources.strings.settings_note_expiry_custom)){var e=angular.element(this.timePickerSelector).val(),s=moment(e,this.timeFormat).toDate();t=this.combineDateAndTime(this.expirationDate,s)}else t.setHours(t.getHours()+this.expirationTimeValuesInHours[this.selectedExpirationTime]);return t.toISOString()},t.prototype.navigateToSettingsDropdown=function(){this.showStatusFailedError=!1,this.$scope.sdc.state=a.SettingsDropDownStates.INITIAL,this.sendStatusNoteBITelemetry(teamspace.components.PanelActionOutcome.submit,teamspace.components.PanelActionScenario.discardStatusMessage,teamspace.components.PanelModuleType.button),this.$scope.sdc.shouldFocusOnStatusMessage=!0},t.focusOnStatusMessage=function(e){var s=e?"settings-dropdown-status-note-actions-edit":"settingsDropdown-statusMessageListItemUnset";t._focusOnStatusMessageTimeout&&t._focusOnStatusMessageTimeout.cancel(),t._focusOnStatusMessageTimeout=_.debounce(function(){var t=document.getElementById(s);t&&t.focus()},10),t._focusOnStatusMessageTimeout()},t.prototype.focusOnStatusInputBox=function(){_.debounce(function(){var t=document.getElementById("settingsSetNote-statusInputBox");t&&t.focus()},10)()},t.prototype.sendStatusNoteBITelemetry=function(t,e,s,n){var i=this;_.defer(function(){var a={action:{gesture:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionGesture.click.toString(),teamspace.components.PanelActionGesture,i.logger),outcome:teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelActionOutcome,i.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(e.toString(),teamspace.components.PanelActionScenario,i.logger),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.statusMessage.toString(),teamspace.components.PanelActionScenarioType,i.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.statusMessageForm.toString(),teamspace.components.PanelModuleName,i.loggingService).toString(),type:teamspace.shared.AttributeHelper.tryGetEnum(s.toString(),teamspace.components.PanelModuleType,i.loggingService),summary:i.resources.strings.settings_options_status_note}};n&&(a.dataBag=n),i.analyticsService.onPanelAction(i.$scope,a)})},t.prototype.isPinnedMessage=function(t){return-1!==t.indexOf(this.constants.statusNotePinnedTag)},t.prototype.isToday=function(t){return moment().isSame(t,"day")},t.prototype.isEndOfToday=function(t){return moment().endOf("day").isSame(moment(t))},t.prototype.isEndOfWeek=function(t){return moment().endOf("week").isSame(moment(t))},t.prototype.updateTimePickerRanges=function(){var t=angular.element(this.timePickerSelector),e=this.timePickerStart;this.isToday(this.expirationDate)&&(e=this.localizationService.getDate(this.getTimeSnappedToNextHalfHour(new Date),"shortTime")),t.timepicker("option",{disableTimeRanges:[[this.timePickerStart,e]]})},t.prototype.prepareDateTimePickers=function(t){var e=this;void 0===t&&(t=!0);var s=angular.element(this.timePickerSelector);s.timepicker({timeFormat:function(t){return e.localizationService.getDate(t,"shortTime")},showDuration:!1}),s.timepicker("setTime",t?this.getTimeSnappedToNextHalfHour(this.expirationDate):this.expirationDate),this.updateTimePickerRanges(),teamspace.common.SafeJQuery.on(this.$scope,s,"showTimepicker",function(){e.addDelayedAriaHidden(s),$(e.timePickerListSelector).click(function(t){t.preventDefault(),t.stopImmediatePropagation()}),s.on("keydown.note",function(t){t.which!==e.constants.keyCodes.up&&t.which!==e.constants.keyCodes.down||e.narrateSelectedTime()})}),teamspace.common.SafeJQuery.on(this.$scope,s,"hideTimepicker",function(){s.attr("aria-hidden",""),s.off("keydown.note")}),teamspace.common.SafeJQuery.on(this.$scope,s,"change",function(){e.validateExpiryDateTime()}),this.$scope.$on("expiryDatePicker.show",function(){e.ariaLiveService.update(e.$translate.instant(e.resources.strings.settings_note_status_custom_expiration_date_placeholder),!0),e.narrateDate(e.expirationDate),e.narrateDatepickerLabel()}),this.$scope.$on("expiryDatePicker.hide",function(){e.updateTimePickerRanges(),e.isToday(e.expirationDate)&&s.timepicker("setTime",e.getTimeSnappedToNextHalfHour(e.expirationDate)),e.validateExpiryDateTime()}),teamspace.common.SafeJQuery.on(this.$scope,angular.element(this.datePickerSelector),this.constants.events.jQuery.keydown,function(t){if(!t.which||t.which!==e.constants.keyCodes.tab)return!1}),teamspace.common.SafeJQuery.on(this.$scope,angular.element(this.timePickerSelector),this.constants.events.jQuery.keydown,function(t){if(!t.which||t.which!==e.constants.keyCodes.tab)return!1})},t.prototype.updateTimePicker=function(){angular.element(this.timePickerSelector).timepicker("setTime",this.getTimeSnappedToNextHalfHour(this.expirationDate)),this.updateTimePickerRanges()},t.prototype.addDelayedAriaHidden=function(t){var e=this;setTimeout(function(){var s=angular.element(t);s&&s.length>0?s.attr("aria-hidden","true"):e.logger.error("Selector didn't return any element: "+t)},1e3)},t.prototype.getTimeSnappedToNextHalfHour=function(t){var e=moment(t),s=e.minutes();return s>30?e.add(1,"h").minutes(0):s>0&&s<30&&e.minutes(30),e.seconds(0).milliseconds(0),e.toDate()},t.prototype.narrateDate=function(t){if(t){var e=this.localizationService.getDate(t,"fullDate");this.ariaLiveService.update(e,!0)}},t.prototype.narrateDatepickerLabel=function(){this.ariaLiveService.update(this.$translate.instant(this.resources.strings.meeting_datepicker_accessible_string),!0)},t.prototype.narrateSelectedTime=function(){var t=this;setTimeout(function(){var e=angular.element(t.timePickerSelectedTimeSelector),s=e[e.length-1].innerText;e.hasClass("ui-timepicker-disabled")&&(s=t.$translate.instant(t.resources.strings.settings_options_status_note_disabled_time_picker_narration,{time:s})),t.ariaLiveService.update(s,!0)})},t.prototype.combineDateAndTime=function(t,e){return moment(t).hours(e.getHours()).minutes(e.getMinutes()).seconds(0).toDate()},t.prototype.updateDoneButtonState=function(){this.isDoneDisabled=!(this.messageLength>0&&this.noteCharsLeftCounter>=0&&this.isValidExpiryDate)},t.prototype.setExpirationDate=function(t,e){this._expirationDate=t,t&&e&&this.narrateDate(t)},t.prototype.validateExpiryDateTime=function(){var t=angular.element(this.timePickerSelector),e=moment(t.val(),this.timeFormat).toDate(),s=this.combineDateAndTime(this.expirationDate,e);moment().isAfter(moment(s))?(t.timepicker("setTime",e),this.isValidExpiryDate=!1):this.isValidExpiryDate=!0,this.updateDoneButtonState()},t.prototype.getMentionsCountInMessage=function(t){var e=this,s=0;try{var n=this.$window.htmlparser2,i=n.parseDOM("<div>"+t+"</div>");s=n.DomUtils.findAll(function(t){return"span"===t.name&&t.attribs&&t.attribs.itemtype===e.constants.semanticObjectSchemas.mention},i).length}catch(t){this.loggingService.error("error parsing message to get the number of mentions: "+t)}return s},t._maxStatusLength=280,t}();e.SettingsSetNoteDropdownController=o,angular.module("teamspace.settingsSetNoteDropdown",["teamspace.authenticationService","teamspace.constants"]).controller("SettingsSetNoteDropdownController",o).run(["$templateCache",function(t){t.put("components/settings-dropdown/settings-set-note-dropdown/settings-set-note-dropdown.html",n)}])}},[1665]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/lazy-ng1-mod-settings-dropdown-components.min.js-5db1e93f.map