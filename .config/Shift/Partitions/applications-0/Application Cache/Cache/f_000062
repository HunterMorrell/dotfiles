webpackJsonp([32],{1680:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1681)},1681:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=i(1682);!function(e){e[e.Unknown=0]="Unknown",e[e.Message=1]="Message",e[e.Reply=2]="Reply",e[e.Like=3]="Like"}(a=t.UserActivityType||(t.UserActivityType={}));var s=function(){return function(){}}();t.UserActivityViewModel=s;var r=function(){return function(){}}();t.ChannelViewModel=r;var c=function(){function e(e,t,i,a,n,s,r,c,o,l,h,u,g,d,v,p,m,y,f,S,b,C){var w=this;if(this.$q=e,this.$sce=t,this.$scope=i,this.$timeout=a,this.$translate=n,this.analyticsService=s,this.channelService=r,this.constants=c,this.htmlSanitizer=o,this.loggingService=l,this.navigationService=h,this.peopleService=u,this.resources=g,this.skypeSearchClient=d,this.substrateSearchRestClient=v,this.sxConfig=p,this.timeService=m,this.settingsService=y,this.personalConversationService=f,this.ariaLiveService=S,this.utilityService=b,this.identityService=C,this.loadingPage=!1,this.daysDisplayedCount=14,this.pageNumber=0,this.parentMessageIdPrefixedString="messageid=",this.reachedEnd=!1,this.substrateMessageSearchEnabled=!1,this.substrateMessageSearchEnabledOtherScenarios=!1,this.scoredChannels={},this.nextPageActivities=null,this.activities=[],this.hasActiveChannels=!1,this.logger=this.loggingService.newLogger("ActivityTab"),this.activityTabV2Settings=this.settingsService.valueFor(this.constants.settings.names.activityTabV2),this.substrateMessageSearchEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableSubstrateMessageSearch),this.substrateMessageSearchEnabledOtherScenarios=this.settingsService.valueAsBoolean(this.constants.settings.names.enableSubstrateMessageSearchEnabledOtherScenarios),this.substrateMessageSearchEchoEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.enableSubstrateMessageSearchEcho),this.isGuestUser=this.identityService.isGuestUserType(),this.activityTabV2Settings&&_.isString(this.activityTabV2Settings))try{this.activityTabV2Settings=JSON.parse(this.activityTabV2Settings)}catch(e){this.logger.error("Activity Tab V2 setting parsing failed. Ignoring activity tab v2 settings. Error: "+e)}this.daysDisplayedCount=this.enableRightRail?this.activityTabV2Settings.daysDisplayedCount:this.daysDisplayedCount,this.postScoreWeight=this.enableRightRail?this.activityTabV2Settings.postScoreWeight:0,this.likeScoreWeight=this.enableRightRail?this.activityTabV2Settings.likeScoreWeight:0,this.maxChannelsPerTeam=this.enableRightRail?this.activityTabV2Settings.maxChannelsPerTeam:0,this.messageSearchPageSize=this.shouldCallSubstrateMessageSearch()?this.constants.search.pageSize3S:this.constants.search.pageSize,this.activityScrollVsRepeat=this.shouldCallSubstrateMessageSearch()?65:93,this.scenarioName=this.constants.scenarios.meDashboard.activityLoad,this.loggingService.findScenario(this.scenarioName)||this.loggingService.newScenario(this.scenarioName),this.$scope.$on("$destroy",function(e){var t=w.loggingService.findScenario(w.scenarioName);t&&t.cancel()}),this.noActivityHeading=this.$translate.instant(this.resources.strings.activity_tab_no_activity_title),this.noActivityMessage=this.$translate.instant(this.resources.strings.activity_tab_no_activity_message),this.loadActivities()}return e.$inject=["$q","$sce","$scope","$timeout","$translate","analyticsService","channelService","constants","htmlSanitizer","loggingService","navigationService","peopleService","resources","skypeSearchClient","substrateSearchRestClient","sxConfig","timeService","settingsService","personalConversationService","ariaLiveService","utilityService","identityService"],Object.defineProperty(e.prototype,"navCtx",{get:function(){return"activity-tab"},enumerable:!0,configurable:!0}),e.prototype.constructAriaLabel=function(e){var t=e.target.dataset.focusedMessageId;if(t){var i=_.find(this.activities,function(e){return e.messageId===t});if(i){var a="";a+=this.getActivityTypeString(i.activityType),a+=" "+i.teamName+"/"+i.channelName,a+=" "+this.timeService.getTimeAgoString(new Date(i.dateTime)),a+=" "+this.getTrimmedContent(i.content.toString()),e.target.setAttribute("aria-label",a)}}},e.prototype.getAriaOwns=function(){return _.range(1,101).map(function(e){return"activity-item-"+e}).join(" ")},e.prototype.showFollowUnfollow=function(e,t){var i=this.channelService.getChannelByObjectId(t.channelId);if(i){var a=t.channelName?t.channelName.toString():"",n=t.teamName?t.teamName.toString():"",s=this.getFollowUnFollowAction(i),r=this.$translate.instant(this.resources.strings.activity_tab_channel_aria_label_format,{channelName:a,teamName:n,action:s});e.target.setAttribute("aria-label",r),e.target.setAttribute("aria-selected","true"),t.followUnfollowText=s,t.showFollowUnfollowLink=!0}else this.logger.error("Cannot show follow/unfollow action because channel: {0} could not be found.",t.channelName)},e.prototype.hideFollowUnfollow=function(e,t){t.showFollowUnfollowLink&&(e.target.setAttribute("aria-selected","false"),t.showFollowUnfollowLink=!1)},e.prototype.toggleFollowSettingForChannel=function(e,t){var i=this,a=this.channelService.getChannelByObjectId(t.channelId);if(a){var n=this.shouldToggleFavoriteSetting(t,a);(n?function(){return i.personalConversationService.toggleFavoriteSettingForChannel(a)}:function(){return i.$q.resolve()})().then(function(){i.personalConversationService.toggleFollowSettingForChannel(a).then(function(){i.logger.info("{0}: Follow/Unfollow successful",a.displayName),t.favorited=n&&a.isFollowed,t.followUnfollowText=i.getFollowUnFollowAction(a),i.ariaUpdateFollowUnFollow(a)}).catch(function(e){i.logger.error("{0}: Follow/Unfollow failed with error: {1}",a.displayName,e)})}).catch(function(e){i.logger.error("{0}: Favorite action failed with error: {1}",a.displayName,e)})}else this.logger.error("Follow/Unfollow failed because channel: {0} could not be found.",t.channelName)},Object.defineProperty(e.prototype,"enableRightRail",{get:function(){return!!this.activityTabV2Settings&&this.activityTabV2Settings.enableRightRail},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableTeamSection",{get:function(){return!!this.activityTabV2Settings&&this.activityTabV2Settings.enableTeamSection},enumerable:!0,configurable:!0}),e.prototype.loadNextPage=function(e){var t=this;!(e===this.constants.scrollEdges.bottom)||this.reachedEnd||this.loadingPage||(this.loadingPage=!0,this.pageNumber++,(this.nextPageActivities?function(){return t.$q.resolve(t.nextPageActivities)}:function(){return t.getUserActivity()})().then(function(e){t.activities=t.activities.concat(e),t.estimateSizes(t.activities)}).catch(function(e){-1==e.status?t.logger.info("Loading next page was cancelled by the user"):(t.errorInfo=e,t.logger.error("Failed to load next page with error:{0}",e),t.pageNumber--)}).finally(function(){t.nextPageActivities=null,t.loadingPage=!1}))},e.prototype.getFollowUnFollowAction=function(e){var t=this.resources.strings.activity_tab_channel_action_follow;return e.isFollowed&&(t=this.resources.strings.activity_tab_channel_action_unfollow),this.$translate.instant(t)},e.prototype.ariaUpdateFollowUnFollow=function(e){var t=e.isFollowed?this.resources.strings.activity_tab_channel_followed:this.resources.strings.activity_tab_channel_unfollowed;this.ariaLiveService.update(this.$translate.instant(t))},e.prototype.shouldToggleFavoriteSetting=function(e,t){return e.favorited||!t.isFavorite&&t.displayName!==this.constants.channels.defaultChannelName},e.prototype.loadActivities=function(){var e=this;this.wait=!0;var t=this.populateActivities(),i=this.getPersonName();this.$q.all([t,i]).then(function(t){if(null==t||t.length<2)return e.logger.error("Failed to get either user activities or name. Not showing activities"),void(e.activities=[]);e.personDisplayValue=t[1],e.wait=!1,e.loadActiveChannelsAndTeams(),e.$timeout(function(){var t=angular.element(".ts-activity-group > button.first-item");e.activities&&e.activities.length>0&&t.length&&t.focus()})}).catch(function(t){e.logger.error("Failed to find activities. Error: {0}",t)})},e.prototype.loadActiveChannelsAndTeams=function(){var e=this;if(this.activeChannelListReady=!1,this.teamListReady=!1,this.enableRightRail){var t=_.filter(this.activities,{isChannelFollowed:!1}),i=this.getUserActivity(1),a=this.getUserLikes();this.$q.all([i,a]).then(function(i){if(null==i||i.length<2)e.logger.error("Failed to get either next page of user posts or likes. Not showing active channels");else{e.nextPageActivities=i[0];var a=i[1],n=_.filter(a,{isChannelFollowed:!1}),s=_.filter(e.nextPageActivities,{isChannelFollowed:!1});t=t.concat(n),t=t.concat(s);var r=e.scoreChannels(t);e.activeChannels=_.orderBy(r,function(e){return e.score},["desc"]),e.activeChannelListReady=!0,e.sendActiveChannelsPanelView()}}).catch(function(t){e.logger.error("Failed to find active channels. Error: {0}",t)})}},e.prototype.sendActiveChannelsPanelView=function(){var e=this,t={panel:{type:teamspace.PanelType.oneOnOneChatActivityView},dataBag:{activeChannelsCount:this.activeChannels.length}};_.defer(function(){return e.analyticsService.onPanelView(e.$scope,t)})},e.prototype.getActivityTypeString=function(e){switch(e){case a.Message:return this.$translate.instant(this.resources.strings.activity_type_message);case a.Reply:return this.$translate.instant(this.resources.strings.activity_type_reply);case a.Like:return this.$translate.instant(this.resources.strings.activity_type_like);default:return""}},e.prototype.getTrimmedContent=function(e){return e.replace(/(<\/?[^>]+(>|$))|&nbsp;/g,function(e){return"&nbsp;"===e?" ":""}).trim()},e.prototype.getPersonName=function(){var e=this;if(!this.context||!this.context.mri)return this.$q.when(this.$translate.instant(this.resources.strings.activity_tab_first_activity_your));this.peopleService.getPeopleProfile(this.context.mri,"activity-tab").then(function(t){var i=t.givenName||t.displayName;return e.noActivityHeading=e.$translate.instant(e.resources.strings.activity_tab_other_no_activity_title),e.noActivityMessage=e.$translate.instant(e.resources.strings.activity_tab_other_no_activity_message,{firstName:i}),e.channelSectionHeader=e.$translate.instant(e.resources.strings.activity_tab_channel_section_header,{firstName:i}),e.teamSectionHeader=e.$translate.instant(e.resources.strings.activity_tab_team_section_header,{firstName:i}),i}).catch(function(t){return e.noActivityHeading=e.$translate.instant(e.resources.strings.activity_tab_other_no_activity_title),e.noActivityMessage=e.$translate.instant(e.resources.strings.activity_tab_unresolved_other_no_activity_message),e.channelSectionHeader=e.$translate.instant(e.resources.strings.activity_tab_channel_section_header_unresolved_user),e.teamSectionHeader=e.$translate.instant(e.resources.strings.activity_tab_team_section_header_unresolved_user),e.$translate.instant(e.resources.strings.activity_tab_first_activity_the)})},e.prototype.populateActivities=function(){var e=this,t=this.$q.defer();return this.getUserActivity(this.pageNumber).then(function(t){e.reachedEnd=!1,e.activities=t,e.estimateSizes(e.activities),$(".simple-scrollbar",e.$scope.element).scrollTop(0)}).catch(function(i){e.errorInfo=i,t.reject(i)}).finally(function(){t.resolve(e.activities)}),t.promise},e.prototype.onPanelChange=function(){var e=this,t=this.constants.messages.panes.activity,i={tab:{id:this.selectedItem.threadId+t,type:t},panel:{type:teamspace.PanelType.oneOnOneChatActivityView}};_.defer(function(){return e.analyticsService.onPanelView(e.$scope,i)})},e.prototype.getUserActivity=function(e){var t=this;void 0===e&&(e=-1),this.cancelPendingCalls(),this.searchTimeout=this.$q.defer();var i=this.$q.defer(),a=moment().startOf("day").subtract(this.daysDisplayedCount,"d"),n=(e>=0?e:this.pageNumber)*this.messageSearchPageSize;return this.substrateMessageSearchEchoEnabled&&!this.isGuestUser&&this.perform3SEchoCall(n,a),this.getSearchBackendPromise(a,n).then(function(e){e?t.logger.debug("{0} results returned",e.length):t.logger.debug("No results returned"),t.processSearchResults(e).then(function(e){i.resolve(e)}).catch(function(e){t.logger.error("Failed to process search results. Error: {0}",e),i.reject(e)})}).catch(function(e){t.logger.error("Failed to get activities. Error: {0}",e),i.reject(e)}),i.promise},e.prototype.perform3SEchoCall=function(e,t){var i=this;this.createSubstrateSearchRequest(t,e).then(function(e){var t={searchClientRequestId:i.utilityService.generateUUID(),searchTermEventSubType:i.constants.events.substrateSearch.userActivityFeedQueryEcho3s};i.substrateSearchRestClient.messageSearchEcho(e,t)})},e.prototype.processSearchResults=function(e,t){var i=this;if(void 0===t&&(t=null),!e||0===e.length)return this.$q.when([]);var n=this.$q.defer(),r=[],c=0;return angular.forEach(e,function(o){var l=new s,h=o.ParentReferenceId&&o.ParentReferenceId.toLowerCase().contains(i.parentMessageIdPrefixedString);l.activityType=t||(h?a.Reply:a.Message),l.parentMessageReferenceId=o.ParentReferenceId.toLowerCase(),l.messageId=null===o.ServerMessageId||void 0===o.ServerMessageId?o.ServerMessageId:o.ServerMessageId.toString(),l.dateTime=new Date(o.CreationDate).toString(),l.content=i.$sce.trustAsHtml(i.htmlSanitizer.sanitizeHtml(o.Content)),l.timestamp=new Date(o.CreationDate),l.threadId=o.ThreadId,l.globalId=l.messageId+l.threadId,i.channelService.getTeamById(o.GroupId).then(function(e){return l.teamName=i.$sce.trustAsHtml(i.htmlSanitizer.sanitizeHtml(e.displayName)),l.teamPictureEtag=e.pictureETag,l.groupId=e.siteInfo.groupId,i.channelService.getChannelById(o.ThreadId)}).then(function(e){l.channelName=i.$sce.trustAsHtml(i.htmlSanitizer.sanitizeHtml(e.displayName)),l.isChannelFollowed=e.isFollowed,i.hasActiveChannels||e.isFollowed||(i.hasActiveChannels=!0),r.push(l)}).catch(function(e){i.logger.debug("unable to process searchResult: {0}",JSON.stringify(o))}).finally(function(){++c===e.length&&(i.logger.debug("{0} results processed",r.length),n.resolve(r))})}),n.promise},e.prototype.shouldCallSubstrateMessageSearch=function(){return this.substrateMessageSearchEnabled&&this.substrateMessageSearchEnabledOtherScenarios&&!this.isGuestUser},e.prototype.openThread=function(e,t){var i=this;if(t&&"A"===t.target.nodeName)t.stopPropagation();else{this.selectedItem=e;var a=e.messageId;if(e.parentMessageReferenceId){var n=e.parentMessageReferenceId.split(";").filter(function(e){return e&&e.indexOf(i.parentMessageIdPrefixedString)>=0});n.length>0&&(a=n[0].substring(this.parentMessageIdPrefixedString.length))}this.navigationService.navigateToMessage(this.$scope,e.dateTime,e.threadId,e.messageId,a,e.messageId,this.navCtx,e.teamName,e.channelName),this.onPanelChange()}},e.prototype.cancelPendingCalls=function(){this.searchTimeout&&(this.searchTimeout.resolve(),this.searchTimeout=null)},e.prototype.estimateSizes=function(e){var t=this;_.each(e,function(e){if(!e.size){var i=e.content?e.content.toString().replace(/<br[^>]*>/g,"\n").replace(/<[^>]*>/g,"").replace(/&#(\d+);/g," ").replace("&amp;"," "):"",a=i.length>t.constants.vsRepeat.leftRail.common.lineCharCount||i.contains("\n")?t.constants.vsRepeat.leftRail.activities.largeSize:t.constants.vsRepeat.leftRail.activities.smallSize;e.size=a}})},e.prototype.getUserLikes=function(){var e=this,t={and:[{Annotation:{TYPE:"like",VALUE:{user:this.context&&this.context.mri?this.context.mri:this.sxConfig.getCurrentSkypeMri()}}},{ConversationType:"Group"}]},i={OPTION:{RESULTBASE:0,RESULTCOUNT:this.constants.search.pageSize},QUERYSTRING:t},n=this.$q.defer();return this.skypeSearchClient.search(i).then(function(t){t?e.logger.debug("{0} likes returned",t.length):e.logger.debug("No likes returned"),e.processSearchResults(t,a.Like).then(function(e){n.resolve(e)}).catch(function(t){e.logger.error("Failed to process like activities. Error: {0}",t),n.reject(t)})}).catch(function(t){e.logger.error("Failed to get likes. Error: {0}",t),n.reject(t)}),n.promise},e.prototype.scoreChannels=function(e){var t=this,i=this.loggingService.newCounter(this.constants.counters.activityTabChannelScoring);_.forEach(e,function(e){t.initializeChannelViewModel(e),t.scoreActivity(e)}),i.stop();var a=_.values(this.scoredChannels),n=_.groupBy(a,"groupId");return a=[],_.forEach(n,function(e){e=_.orderBy(e,function(e){return e.score},"desc"),a=a.concat(e.slice(0,t.maxChannelsPerTeam))}),a},e.prototype.initializeChannelViewModel=function(e){this.scoredChannels[e.threadId]||(this.scoredChannels[e.threadId]=new r,this.scoredChannels[e.threadId].channelId=e.threadId,this.scoredChannels[e.threadId].channelName=e.channelName,this.scoredChannels[e.threadId].teamName=e.teamName,this.scoredChannels[e.threadId].teamPictureEtag=e.teamPictureEtag,this.scoredChannels[e.threadId].groupId=e.groupId,this.scoredChannels[e.threadId].showFollowUnfollowLink=!1,this.scoredChannels[e.threadId].favorited=!1,this.scoredChannels[e.threadId].score=0)},e.prototype.scoreActivity=function(e){var t=e.activityType===a.Message||e.activityType===a.Reply?this.postScoreWeight:this.likeScoreWeight,i=moment(new Date),n=moment(e.timestamp),s=moment.duration(i.diff(n)).asDays(),r=t+(this.daysDisplayedCount-s);this.scoredChannels[e.threadId].score+=r},e.prototype.setActivitySearchConversationId=function(){this.activitySearchConversationId=this.activitySearchConversationId?this.activitySearchConversationId:this.utilityService.generateUUID()},e.prototype.createSubstrateSearchRequest=function(e,t){var i=this;return this.peopleService.getPeopleProfile(this.context.mri,"activity-tab").then(function(a){var n=e.format("YYYY-MM-DD");return i.setActivitySearchConversationId(),{queryString:"sent>="+n+' AND (from:"'+a.displayName+'" OR from:"'+a.userPrincipalName+'")',cvid:i.activitySearchConversationId,options:{resultBase:t,resultCount:i.messageSearchPageSize},filter:{Term:{conversationType:"Group"}}}})},e.prototype.getSkypeSearchRequest=function(e,t,i){var a=e.toISOString();return{OPTION:{RESULTBASE:i,RESULTCOUNT:this.constants.search.pageSize},QUERYSTRING:{and:[{CreationDate:{OP:this.constants.search.filters.conversations.dateGtOperation,VALUE:a}},{ConversationType:"Group"},{From:t}]}}},e.prototype.getTrimmedContentForSubstrateSearchResult=function(e){if(e.Content.length>250){var t=e.Content.substring(0,e.Content.lastIndexOf(" ",250));e.Content=t+" ..."}return e},e.prototype.trimSearchResultsForSusbstrate=function(e){var t=this,i=e.map(function(e){return t.getTrimmedContentForSubstrateSearchResult(e)});return this.$q.resolve(i)},e.prototype.setReachedSearchEnd=function(e){this.shouldCallSubstrateMessageSearch()?this.substrateSearchRestClient.moreSearchResultsAvailable(e)||(this.reachedEnd=!0):e.length<this.messageSearchPageSize&&(this.reachedEnd=!0)},e.prototype.getSearchBackendPromise=function(e,t){var i=this,a=null;if(this.shouldCallSubstrateMessageSearch()){var n=this.createSubstrateSearchRequest(e,t),s={searchClientRequestId:this.utilityService.generateUUID(),searchTermEventSubType:this.constants.events.substrateSearch.userActivityFeedQuery3s,searchTermScenario:this.constants.scenarios.search.substrateSearchChatUserActivityScenario};a=n.then(function(e){return i.substrateSearchRestClient.searchTerm(e,s)}).then(function(e){return i.setReachedSearchEnd(e.object),i.substrateSearchRestClient.process3SResponse(e)},function(e){return i.logger.error("3S Message Search Call Failed For User Activity Tab, error-"+JSON.stringify(e)),i.$q.reject(e)}).then(function(e){return i.trimSearchResultsForSusbstrate(e)})}else{var r={searchClientRequestId:this.utilityService.generateUUID(),searchTermEventSubType:this.constants.events.substrateSearch.userActivityFeedQueryOsearch},c=this.context&&this.context.mri?this.context.mri:this.sxConfig.getCurrentSkypeMri(),o={timeout:this.searchTimeout.promise},l=this.getSkypeSearchRequest(e,c,t);a=this.skypeSearchClient.search(l,o,r).then(function(e){return i.setReachedSearchEnd(e),e},function(e){return i.logger.error("Osearch Message Search Call Failed For User Activity Tab, error-"+JSON.stringify(e)),i.$q.reject(e)})}return a},e}();t.ActivityTabController=c,angular.module("teamspace.activityTab",["teamspace.channelService","teamspace.eventingService","teamspace.htmlSanitizer","teamspace.loggingService","teamspace.peopleService","teamspace.skypeSearchClient","teamspace.substrateSearchRestClient","skypeX.sxConfig","teamspace.templateCompileService","teamspace.timeService","teamspace.routeUtilityService","teamspace.personalConversationService","teamspace.ariaLiveService"]).directive("activityTab",["templateCompileService",function(e){return{restrict:"E",scope:{hideDateDividers:"<?"},bindToController:{context:"=?"},controller:c,controllerAs:"actCtrl",link:function(t,i){e.compile("components/activity-tab/activity-tab.html",t,i)}}}]).run(["$templateCache",function(e){e.put("components/activity-tab/activity-tab.html",n)}])},1682:function(e,t){e.exports='<div ng-show="actCtrl.wait" class="busy-container">\n  <busy-animation size="medium" context="activity-tab"></busy-animation>\n</div>\n\n<div class="activity-scroll-container match-parent" ng-show="!actCtrl.wait" simple-scrollbar ng-edge-scroll bottom-threshold="0.8" on-edge-callback="actCtrl.loadNextPage(scrollEdge)" scenario-end="{{actCtrl.scenarioName}}">\n  <div class="activity-tab-container" ng-show="!actCtrl.wait">\n    <div class="activity-content" ng-class="{\'activity-fixed-width-left-rail\': actCtrl.enableRightRail && actCtrl.hasActiveChannels}">\n      <div class="activity-container match-parent" data-tid="activity-container">\n        <div class="activity-tab-empty" ng-show="actCtrl.activities.length == 0" data-tid="activity-tab-empty-activity-container">\n          <p class="text">{{actCtrl.noActivityMessage}}</p>\n        </div>\n        <div acc-role="list" aria-owns="{{::actCtrl.getAriaOwns()}}" class="match-parent flex-fill" data-tid="activity-tab-activity-group-container" ng-show="actCtrl.activities.length > 0)">\n          <div class="activity-group ts-activity-group" vs-repeat="{{actCtrl.activityScrollVsRepeat}}" vs-excess="20" vs-scroll-parent=".activity-scroll-container" vs-options="{latch: true}" acc-role="vs-repeat-content-elements">\n            <button class="ts-sym left-rail-item left-rail-item-hover" ng-class="{\'left-rail-selected\': searchResult.globalId === actCtrl.selectedItem.globalId, \'first-item\': $index === 0}" ng-click="actCtrl.openThread(searchResult, $event)" ng-repeat="searchResult in actCtrl.activities track by searchResult.globalId" data-focused-message-id="{{::searchResult.messageId}}" acc-role="list-item" aria-selected="{{searchResult.globalId === actCtrl.selectedItem.globalId}}" aria-setsize="{{actCtrl.activities.length}}" aria-posinset="{{$index + startIndex + 1}}" id="activity-item-{{$index + 1}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.myActivityNavItem}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.listItem}}" track-type="{{::$root.trackConstants.trackType.message}}" track-summary="{{searchResult.globalId}}" simple-focus="ctrl.constructAriaLabel($event)">\n              \x3c!-- Need this container for firefox flex display --\x3e\n              <div class="ts-activity-flex-cont">\n                <div class="type-icon" ng-class="{like: 3 === searchResult.activityType, reply: 2 === searchResult.activityType, message: 1 === searchResult.activityType}">\n                  <ng-include class="type reply" src="\'svg/icons-reply.html\'"></ng-include>\n                  <ng-include class="type message" src="\'svg/icons-chat.html\'"></ng-include>\n                  <ng-include class="type like" src="\'svg/icons-liked.html\'"></ng-include>\n                </div>\n                <div class="item-title item-subtle">{{::searchResult.teamName}}/{{::searchResult.channelName}}</div>\n                <span class="item-detail" ng-bind-html="::searchResult.content"></span>\n                <span class="item-subtle" time-ago="searchResult.timestamp"></span>\n              </div>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="activity-right-rail" ng-if="actCtrl.enableRightRail && actCtrl.hasActiveChannels && actCtrl.activities.length > 0" role="complementary">\n      <div class="channel-section">\n        <span class="channel-section-header">{{actCtrl.channelSectionHeader}}</span>\n        <div class="busy-container" ng-show="!actCtrl.activeChannelListReady">\n          <busy-animation size="medium" context="activity-tab-channel-section"></busy-animation>\n        </div>\n\n        <div class="channel-list-container" ng-show="actCtrl.activeChannelListReady" data-tid="activity-tab-channel-list-container">\n          <ul acc-role="list" data-tid="active-channels" aria-label="{{::actCtrl.channelSectionHeader}}.">\n            <li class="active-channel left-rail-item-hover" ng-repeat="channel in actCtrl.activeChannels track by $index" id="channel-{{::channel.groupId}}-{{::channel.channelName}}" acc-role="list-item" ng-focus="actCtrl.showFollowUnfollow($event, channel)" ng-blur="actCtrl.hideFollowUnfollow($event, channel)" ng-mouseenter="actCtrl.showFollowUnfollow($event, channel)" ng-mouseleave="actCtrl.hideFollowUnfollow($event, channel)" data-tid="channel-{{::channel.groupId}}-{{::channel.channelName}}">\n              <div data-tid="active-channel-{{::channel.groupId}}" aria-hidden="true">\n                <profile-picture css-class="team-icon" title="{{::channel.teamName}}" display-name="channel.teamName" team-id="channel.groupId" etag="channel.teamPictureEtag" retain-in-cache="true"></profile-picture>\n                <div>\n                  <div class="active-channel-details" ng-class="{\'active-channel-details-cut\': channel.showFollowUnfollowLink}">\n                    <span class="active-channel-name" title="{{::channel.channelName}}">{{::channel.channelName}}</span>\n                    <span class="app-small-font active-team-name" title="{{::channel.teamName}}">{{::channel.teamName}}</span>\n                  </div>\n                  <div class="active-channel-follow" ng-if="channel.showFollowUnfollowLink">\n                    <a ng-click="actCtrl.toggleFollowSettingForChannel($event, channel)" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.activityTabFollowUnfollow}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.rightRail}}" track-name="{{::$root.trackConstants.trackModuleName.activityDashboard}}" track-type="{{::$root.trackConstants.trackType.other}}" track-data="{ action: \'{{channel.followUnfollowText}}\' }" track-summary="{{channel.followUnfollowText}}" data-tid="activity-tab-follow-unfollow-link">\n                      {{channel.followUnfollowText}}\n                    </a>\n                  </div>\n                </div>\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div>\n\n      <div class="team-section" ng-if="actCtrl.enableTeamSection">\n        <span class="team-section-header">{{actCtrl.teamSectionHeader}}</span>\n        <div class="busy-container" ng-show="!actCtrl.teamListReady">\n          <busy-animation size="medium" context="activity-tab-team-section"></busy-animation>\n        </div>\n\n        <div class="team-list-container" ng-show="actCtrl.teamListReady"></div>\n      </div>\n    </div>\n  </div>\n</div>\n'}},[1680]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/lazy-ng1-mod-activity-tab-components.min.js-36aea300.map