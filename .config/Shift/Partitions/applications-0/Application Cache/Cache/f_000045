webpackJsonp([12],{1698:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(1699),i(1706),i(1708),i(1710)},1699:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1700),a=i(1701),s=function(){function t(t,e,i,n,a,s,o,r,l,g,c,d){var h=this;this.$scope=t,this.$q=e,this.$translate=i,this.loggingService=n,this.digitalSignageService=a,this.resources=s,this.ngDialog=o,this.constants=r,this.dialogService=l,this.$timeout=g,this.$element=c,this.$compile=d,this.isContentCreation=!1,this.loading=!1,this.saving=!1,this.context={showcaseContent:null,contentProps:null},this.logger=this.loggingService.newLogger("digitalSignageContentManagementDialog"),this.loading=!0,this.saving=!1,this.channelId=this.$scope.ngDialogData.channelId,this.teamId=this.$scope.ngDialogData.teamId,this.teamDisplayName=this.$scope.ngDialogData.teamDisplayName,this.type=this.$scope.ngDialogData.type,this.contentId=this.$scope.ngDialogData.contentId,this.contentProperties=this.$scope.ngDialogData.contentProperties,this.dialogTitle=this.$translate.instant(this.resources.strings.digital_signage_management),this.$scope.panelRegionsDelete=teamspace.PanelRegion,this.createDigitalSignageDialogContent(),this.scenario=this.digitalSignageDialogContent.getTelemetryScenario(),this.renderDataOnDialog(),this.$scope.performAction=function(){h.saving=!0,h.updateContent()}}return t.$inject=["$scope","$q","$translate","loggingService","digitalSignageService","resources","ngDialog","constants","dialogService","$timeout","$element","$compile"],t.prototype.cancel=function(){this.scenario.cancel(),this.logger.info("Canceling operation")},t.prototype.renderDataOnDialog=function(){var t=this;this.fetchShowcaseForTeam().then(function(e){t.showcaseContent=t.digitalSignageDialogContent.getShowcaseContent(e),t.digitalSignageDialogContent.initializeContentTypeSettings(t.showcaseContent),t.$timeout(function(){t.digitalSignageDialogContent.dialogContentDirective&&(t.context.showcaseContent=t.showcaseContent,t.$element.find(".ts-modal-dialog-content").append(t.$compile("<"+t.digitalSignageDialogContent.dialogContentDirective+' ng-if="!dsCtrl.loading && !dsCtrl.saving" context="dsCtrl.context"></'+t.digitalSignageDialogContent.dialogContentDirective+">")(t.$scope)))}),t.loading=!1})},t.prototype.fetchShowcaseForTeam=function(){var t=this,e=this.$q.defer();return this.scenario.mark(this.constants.scenarios.digitalSignage.step.fetchingShowcases),this.digitalSignageService.getShowcases(this.teamId).then(function(i){var n;i&&i.length>0&&(n=i[0],t.teamShowcaseId=i[0].id),e.resolve(n),t.scenario.mark(t.constants.scenarios.digitalSignage.step.fetchedShowcases)}).catch(function(i){var n=JSON.stringify(i);t.logger.error("Error fetching showcases for teamId: "+t.teamId+". Error: "+n),e.reject(),t.scenario.mark(t.constants.scenarios.digitalSignage.step.fetchingShowcasesFailed),t.scenario.fail({teamId:t.teamId,channelId:t.channelId,error:n}),t.openErrorDialog(t.$translate.instant(t.resources.strings.digital_signage_fetch_error_text),t.$translate.instant(t.resources.strings.digital_signage_fetch_error_description))}),e.promise},t.prototype.createDigitalSignageDialogContent=function(){var t=new a.DigitalSignageContentFactory(this.loggingService,this.teamShowcaseId,this.channelId,this.teamId,this.contentId,this.contentProperties,this.$translate,this.resources,this.constants);this.digitalSignageDialogContent=t.getDigitalSignageDialogContent(this.type)},t.prototype.updateContent=function(){var t=this;this.showcaseContent||(this.isContentCreation=!0),this.showcaseContent=this.digitalSignageDialogContent.composePayload(this.showcaseContent,this.context),this.teamShowcaseId?this.update():this.createShowcase().then(function(){t.update()})},t.prototype.update=function(){this.isContentCreation?this.createShowcaseContent():void 0!==this.showcaseContent.enabled?this.updateShowcaseContent():this.deleteShowcaseContent()},t.prototype.createShowcase=function(){var t=this,e=this.$q.defer();return this.scenario.mark(this.constants.scenarios.digitalSignage.step.creatingShowcase),this.digitalSignageService.createShowcase(this.teamId,{name:"Default "+this.teamDisplayName+" Showcase"}).then(function(i){t.teamShowcaseId=i.id,t.scenario.mark(t.constants.scenarios.digitalSignage.step.createdShowcase,{showcaseId:i.id}),e.resolve(i)}).catch(function(i){var n=JSON.stringify(i);e.reject(),t.scenario.mark(t.constants.scenarios.digitalSignage.step.creatingShowcaseFailed),t.scenario.fail({teamId:t.teamId,channelId:t.channelId,error:n}),t.logger.error("Error creating showcase for teamId: "+t.teamId+". Error: "+n),t.openErrorDialog(t.$translate.instant(t.resources.strings.digital_signage_create_showcase_error_text),t.$translate.instant(t.resources.strings.digital_signage_create_showcase_error_description))}),e.promise},t.prototype.createShowcaseContent=function(){var t=this;this.scenario.mark(this.constants.scenarios.digitalSignage.step.addingShowcaseContent,{showcaseId:this.teamShowcaseId,content:JSON.stringify(this.showcaseContent)}),this.digitalSignageService.createShowcaseContent(this.teamId,this.teamShowcaseId,this.showcaseContent).then(function(e){t.openConfirmationDialog(t.$translate.instant(t.resources.strings.digital_signage_share_confirmation_text),t.$translate.instant(t.resources.strings.digital_signage_share_confirmation_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.addedShowcaseContent,{showcaseId:t.teamShowcaseId,contentId:e.id}),t.scenario.stop()}).catch(function(e){var i=JSON.stringify(e);t.logger.error("Error creating showcase content for teamId: "+t.teamId+" and showcase with Id: "+t.teamShowcaseId+". Error: "+i),t.openErrorDialog(t.$translate.instant(t.resources.strings.digital_signage_share_error_text),t.$translate.instant(t.resources.strings.digital_signage_share_error_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.addingShowcaseContentFailed),t.scenario.fail({teamId:t.teamId,channelId:t.channelId,showcaseId:t.teamShowcaseId,error:i})})},t.prototype.updateShowcaseContent=function(){var t=this;this.scenario.mark(this.constants.scenarios.digitalSignage.step.updatingShowcaseContent,{showcaseId:this.teamShowcaseId,content:JSON.stringify(this.showcaseContent)}),this.digitalSignageService.updateShowcaseContent(this.teamId,this.teamShowcaseId,this.showcaseContent.id,this.showcaseContent).then(function(e){t.openConfirmationDialog(t.$translate.instant(t.resources.strings.digital_signage_share_confirmation_text),t.$translate.instant(t.resources.strings.digital_signage_share_confirmation_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.updatedShowcaseContent,{showcaseId:t.teamShowcaseId,contentId:t.showcaseContent.id}),t.scenario.stop()}).catch(function(e){var i=JSON.stringify(e);t.logger.error("Error updating showcase content with contentId: "+t.showcaseContent.id+" for showcase with ID: "+t.teamShowcaseId+". Error: "+i),t.openErrorDialog(t.$translate.instant(t.resources.strings.digital_signage_share_error_text),t.$translate.instant(t.resources.strings.digital_signage_share_error_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.updatingShowcaseContentFailed),t.scenario.fail({teamId:t.teamId,channelId:t.channelId,showcaseId:t.teamShowcaseId,contentId:t.showcaseContent.id,error:i})})},t.prototype.deleteShowcaseContent=function(){var t=this;this.scenario.mark(this.constants.scenarios.digitalSignage.step.removingShowcaseContent,{showcaseId:this.teamShowcaseId,content:JSON.stringify(this.showcaseContent)}),this.digitalSignageService.deleteShowcaseContent(this.teamId,this.teamShowcaseId,this.showcaseContent.id).then(function(e){t.openConfirmationDialog(t.$translate.instant(t.resources.strings.digital_signage_remove_confirmation_text),t.$translate.instant(t.resources.strings.digital_signage_remove_confirmation_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.removedShowcaseContent,{showcaseId:t.teamShowcaseId,contentId:t.showcaseContent.id}),t.scenario.stop()}).catch(function(e){var i=JSON.stringify(e);t.logger.error("Error deleting showcase content with contentId: "+t.showcaseContent.id+" for showcase with ID: "+t.teamShowcaseId+". Error: "+i),t.openErrorDialog(t.$translate.instant(t.resources.strings.digital_signage_remove_error_text),t.$translate.instant(t.resources.strings.digital_signage_remove_error_description)),t.scenario.mark(t.constants.scenarios.digitalSignage.step.removingShowcaseContentFailed),t.scenario.fail({teamId:t.teamId,channelId:t.channelId,contentId:t.showcaseContent.id,error:i})})},t.prototype.openConfirmationDialog=function(t,e){this.saving=!1,this.ngDialog.closeAll(),this.dialogService.open(this.constants.dialogs.digitalSignageConfirmation,{dialogHeaderText:t,dialogDescriptionText:e})},t.prototype.openErrorDialog=function(t,e){this.saving=!1,this.ngDialog.closeAll(),this.dialogService.open(this.constants.dialogs.digitalSignageError,{dialogHeaderText:t,dialogDescriptionText:e})},t}();e.DigitalSignageContentManagementController=s;var o="components/digital-signage-content-management-dialog/digital-signage-content-management-dialog.html";angular.module("teamspace.digitalSignageContentManagementDialog",["teamspace.dialogService","teamspace.loggingService"]).run(["constants","dialogService",function(t,e){e.register(t.dialogs.digitalSignageContentManagement,{template:o,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:"DigitalSignageContentManagementController",controllerAs:"dsCtrl",ariaAuto:!1,ariaRole:"dialog"})}]).controller("DigitalSignageContentManagementController",s).run(["$templateCache",function(t){t.put(o,n)}])},1700:function(t,e){t.exports='<div class="ts-digital-signage-content-management-dialog" data-tid="digitalSignageContentManagementDialog">\n  <div class="ts-modal-dialog-header">\n    <h1 class="app-font-family-base ts-modal-dialog-title header-text" id="digital-signage-content-management-dialog-title" data-tid="digital-signage-content-management-dialog-title" aria-label="::dsCtrl.digitalSignageDialogContent.dialogHeaderText">\n      <span ng-if="!dsCtrl.loading && !dsCtrl.saving" ng-bind="::dsCtrl.digitalSignageDialogContent.dialogHeaderText"></span>\n    </h1>\n  </div>\n  <div class="ts-modal-dialog-content" ng-class="{\'dialog-has-directive\': (dsCtrl.digitalSignageDialogContent.dialogContentDirective != null)}">\n    <div class="ts-digital-signage-content-management-dialog-loading" ng-if="dsCtrl.loading || dsCtrl.saving">\n      <busy-animation size="small"></busy-animation>\n      <div class="ts-digital-signage-content-management-dialog-loading-label">\n        <div ng-bind="::$root.resources.strings.digital_signage_loading | translate" ng-if="dsCtrl.loading"></div>\n        <div ng-bind="::$root.resources.strings.digital_signage_saving | translate" ng-if="dsCtrl.saving"></div>\n      </div>\n    </div>\n    <div ng-if="!dsCtrl.loading && !dsCtrl.saving" ng-bind="::dsCtrl.digitalSignageDialogContent.dialogDescriptionText" aria-label="::dsCtrl.digitalSignageDialogContent.dialogDescriptionText" data-tid="digital-signage-content-management-dialog-description">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <div class="ts-modal-button-div">\n        <button ng-click="dsCtrl.cancel()" class="ts-btn ts-btn-secondary ngdialog-close" ng-if="!dsCtrl.saving" data-tid="digital-signage-content-management-dialog-cancel-button" aria-label="{{::$root.resources.strings.cancel | translate}}" ng-bind="::$root.resources.strings.cancel | translate"></button>\n      </div>\n      <div class="ts-modal-button-div">\n        <button ng-click="performAction($event);" ng-if="!dsCtrl.loading" ng-disabled="dialogBusy || dsCtrl.saving" class="ts-btn ts-btn-primary inset-border" data-tid="digital-signage-content-management-dialog-done-button" acc-role="focus-default" aria-label="{{::dsCtrl.digitalSignageDialogContent.doneButtonText}}" ng-bind="::dsCtrl.digitalSignageDialogContent.doneButtonText"></button>\n      </div>\n    </div>\n  </div>\n</div>'},1701:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1702),a=i(1703),s=i(1704),o=i(1705),r=function(){function t(t,e,i,n,a,s,o,r,l){this.loggingService=t,this.teamShowcaseId=e,this.channelId=i,this.teamId=n,this.contentId=a,this.contentProperties=s,this.$translate=o,this.resources=r,this.constants=l}return t.prototype.getDigitalSignageDialogContent=function(t){if(t){switch(t){case teamspace.services.ShowcaseContentType.Conversations:return new a.DigitalSignageDialogChannelRulesContent(this.loggingService,this.teamShowcaseId,this.channelId,this.teamId,this.contentId,this.contentProperties,this.$translate,this.resources,this.constants);case teamspace.services.ShowcaseContentType.Tab:return new n.DigitalSignageDialogTabsContent(this.loggingService,this.teamShowcaseId,this.channelId,this.teamId,this.contentId,this.contentProperties,this.$translate,this.resources,this.constants);case teamspace.services.ShowcaseContentType.Message:return new s.DigitalSignageDialogMessagesContent(this.loggingService,this.teamShowcaseId,this.channelId,this.teamId,this.contentId,this.contentProperties,this.$translate,this.resources,this.constants);case teamspace.services.ShowcaseContentType.File:return new o.DigitalSignageDialogFileContent(this.loggingService,this.teamShowcaseId,this.channelId,this.teamId,this.contentId,this.contentProperties,this.$translate,this.resources,this.constants)}return null}},t}();e.DigitalSignageContentFactory=r},1702:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n,a,s,o,r,l){this.loggingService=t,this.teamShowcaseId=e,this.channelId=i,this.teamId=n,this.contentId=a,this.contentProperties=s,this.$translate=o,this.resources=r,this.constants=l}return t.prototype.initializeContentTypeSettings=function(t){t?(this.doneButtonText=this.$translate.instant(this.resources.strings.remove),this.dialogHeaderText=this.$translate.instant(this.resources.strings.digital_signage_remove_text),this.dialogDescriptionText=this.$translate.instant(this.resources.strings.digital_signage_remove_description)):(this.doneButtonText=this.$translate.instant(this.resources.strings.share),this.dialogHeaderText=this.$translate.instant(this.resources.strings.digital_signage_share_text),this.dialogDescriptionText=this.$translate.instant(this.resources.strings.digital_signage_share_description))},t.prototype.getShowcaseContent=function(t){var e=this;if(t&&t.content.length>0)return _.find(t.content,function(t){return t.type===teamspace.services.ShowcaseContentType.Tab&&t.channelThreadId===e.channelId&&t.settings&&t.settings.tabId===e.contentId})},t.prototype.composePayload=function(t){if(t)return t.enabled=void 0,t;var e={tabId:this.contentId};return{teamThreadId:this.teamId,channelThreadId:this.channelId,type:teamspace.services.ShowcaseContentType.Tab,settings:e,enabled:!0,definitionId:this.contentProperties&&this.contentProperties.definitionId}},t.prototype.getTelemetryScenario=function(){var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.tab);return t.eventData.tabType=this.contentProperties&&this.contentProperties.definitionId,t},t}();e.DigitalSignageDialogTabsContent=n},1703:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n,a,s,o,r,l){this.loggingService=t,this.teamShowcaseId=e,this.channelId=i,this.teamId=n,this.contentId=a,this.contentProperties=s,this.$translate=o,this.resources=r,this.constants=l,this.dialogContentDirective="digital-signage-channel-rules"}return t.prototype.getShowcaseContent=function(t){var e=this;if(t&&t.content.length>0)return _.find(t.content,function(t){return void 0===t.type&&t.channelThreadId===e.channelId&&t.settings&&t.settings.websiteUrl})},t.prototype.initializeContentTypeSettings=function(){this.dialogHeaderText=this.$translate.instant(this.resources.strings.extension_digitalSignageChannelRules),this.dialogDescriptionText=this.$translate.instant(this.resources.strings.digital_signage_channel_rules_dialog_message),this.doneButtonText=this.$translate.instant(this.resources.strings.done)},t.prototype.composePayload=function(t,e){var i=this.constants.digitalSignage.conversationsShowcaseUrl+"?teamId="+this.teamId+"&channelId="+this.channelId+"&timeFrame="+e.contentProps.timeFrameOptions[0].value+"&limitTo="+e.contentProps.limitToOptions[0].value;if(t)t.settings.websiteUrl=i,t.settings.url=i,t.enabled=e.contentProps.enabled;else{var n={websiteUrl:i,url:i};t={channelThreadId:this.channelId,settings:n,definitionId:this.constants.digitalSignage.conversationsTabDefinitionId,enabled:e.contentProps.enabled}}return t},t.prototype.getTelemetryScenario=function(){return this.loggingService.newScenario(this.constants.scenarios.digitalSignage.channelRules)},t}();e.DigitalSignageDialogChannelRulesContent=n},1704:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n,a,s,o,r,l){this.loggingService=t,this.teamShowcaseId=e,this.channelId=i,this.teamId=n,this.contentId=a,this.contentProperties=s,this.$translate=o,this.resources=r,this.constants=l}return t.prototype.initializeContentTypeSettings=function(t){t?(this.doneButtonText=this.$translate.instant(this.resources.strings.remove),this.dialogHeaderText=this.$translate.instant(this.resources.strings.digital_signage_remove_text),this.dialogDescriptionText=this.$translate.instant(this.resources.strings.digital_signage_remove_description)):(this.doneButtonText=this.$translate.instant(this.resources.strings.share),this.dialogHeaderText=this.$translate.instant(this.resources.strings.digital_signage_share_text),this.dialogDescriptionText=this.$translate.instant(this.resources.strings.digital_signage_share_description))},t.prototype.getShowcaseContent=function(t){var e=this;if(t&&t.content.length>0)return _.find(t.content,function(t){return t.type===teamspace.services.ShowcaseContentType.Message&&t.channelThreadId===e.channelId&&t.settings&&t.settings.replyChainId===e.contentId})},t.prototype.composePayload=function(t){if(t)return t.enabled=void 0,t;var e={replyChainId:this.contentId};return{teamThreadId:this.teamId,channelThreadId:this.channelId,type:teamspace.services.ShowcaseContentType.Message,settings:e,enabled:!0,definitionId:"definitionId"}},t.prototype.getTelemetryScenario=function(){var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.message);return t.eventData.messageType=this.contentProperties.messageType,t},t}();e.DigitalSignageDialogMessagesContent=n},1705:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n,a,s,o,r,l){this.loggingService=t,this.teamShowcaseId=e,this.channelId=i,this.teamId=n,this.contentId=a,this.contentProperties=s,this.$translate=o,this.resources=r,this.constants=l}return t.prototype.initializeContentTypeSettings=function(t){var e=this.resources.strings;this.doneButtonText=this.$translate.instant(t?e.remove:e.share),this.dialogHeaderText=this.$translate.instant(t?e.digital_signage_remove_text:e.digital_signage_share_text),this.dialogDescriptionText=this.$translate.instant(t?e.digital_signage_remove_description:e.digital_signage_share_description)},t.prototype.getShowcaseContent=function(t){var e=this;if(t&&t.content&&t.content.length>0)return _.find(t.content,function(t){return t.type===teamspace.services.ShowcaseContentType.File&&t.channelThreadId===e.channelId&&t.settings&&t.settings.fileId===e.contentId})},t.prototype.composePayload=function(t){if(t)return t.enabled=void 0,t;var e={fileId:this.contentId,url:this.contentProperties.sharepointUrl,subtype:this.contentProperties.fileType};return{teamThreadId:this.teamId,channelThreadId:this.channelId,type:teamspace.services.ShowcaseContentType.File,settings:e,enabled:!0,definitionId:"definitionId"}},t.prototype.getTelemetryScenario=function(){return this.loggingService.newScenario(this.constants.scenarios.digitalSignage.file)},t}();e.DigitalSignageDialogFileContent=n},1706:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1707),a=function(){function t(t,e,i,n){this.constants=t,this.$translate=e,this.resources=i,this.loggingService=n,this.contentEnabled=!1,this.logger=this.loggingService.newLogger("digitalSignageChannelRules"),this.translatedChannelRulesOn=this.$translate.instant(this.resources.strings.digital_signage_channel_rules_dialog_control_on),this.translatedChannelRulesOff=this.$translate.instant(this.resources.strings.digital_signage_channel_rules_dialog_control_off),this.timeFrameOptions=[{text:this.$translate.instant(this.resources.strings.digital_signage_channel_rules_dialog_duration_placeholder),value:this.constants.digitalSignage.channelRulesSettings.defaultTimeFrame}],this.limitToOptions=[{text:this.$translate.instant(this.resources.strings.digital_signage_channel_rules_dialog_message_limit_placeholder),value:this.constants.digitalSignage.channelRulesSettings.defaultLimitTo}],this.showcaseContent=this.context?this.context.showcaseContent:null,this.updateChannelRulesConfiguration(this.showcaseContent)}return t.$inject=["constants","$translate","resources","loggingService"],t.prototype.changeChannelRulesState=function(t){this.contentEnabled=t,this.channelRulesLabel=this.contentEnabled?this.translatedChannelRulesOn:this.translatedChannelRulesOff,this.context&&(this.context.contentProps={enabled:this.contentEnabled,timeFrameOptions:this.timeFrameOptions,limitToOptions:this.limitToOptions})},t.prototype.updateChannelRulesConfiguration=function(t){t?this.setChannelRulesConfiguration(t):(this.contentEnabled=!1,this.channelRulesLabel=this.translatedChannelRulesOff,this.selectedTimeFrame=this.timeFrameOptions[0].value,this.selectedLimitTo=this.limitToOptions[0].value),this.context&&(this.context.contentProps={enabled:this.contentEnabled,timeFrameOptions:this.timeFrameOptions,limitToOptions:this.limitToOptions})},t.prototype.setChannelRulesConfiguration=function(t){var e=t.settings.websiteUrl;this.contentEnabled=t.enabled;var i=new URLSearchParams(e);this.selectedTimeFrame=Number(i.get("timeFrame")),this.selectedLimitTo=Number(i.get("limitTo")),this.channelRulesLabel=this.contentEnabled?this.translatedChannelRulesOn:this.translatedChannelRulesOff,this.logger.info("Channel rules configuration,\n                      channelRulesEnabled: "+this.contentEnabled+",\n                      selectedTimeFrame: "+this.selectedTimeFrame+",\n                      selectedLimitTo: "+this.selectedLimitTo+".")},t}();e.DigitalSignageChannelRulesController=a;var s="components/digital-signage-channel-rules/digital-signage-channel-rules.html";angular.module("teamspace.digitalSignageChannelRules",["teamspace.constants","teamspace.loggingService"]).directive("digitalSignageChannelRules",["constants",function(t){return{restrict:"E",scope:{},bindToController:{context:"="},controller:a,controllerAs:"dsCtrl",templateUrl:s}}]).run(["$templateCache",function(t){t.put(s,n)}])},1707:function(t,e){t.exports='<div class="ts-digital-signage-channel-rules">\n  <div class="channel-rules-controls">\n    <label ng-bind="dsCtrl.channelRulesLabel" aria-label="dsCtrl.channelRulesLabel" data-tid="digital-signage-content-management-dialog-channel-rules-state">\n    </label>\n    <toggle-switch class="toggle" data-tid="digital-signage-content-management-dialog-toggle-channel-rules" ds-aria-label="{{dsCtrl.contentEnabled ? ($root.resources.strings.aria_toggleChannelRules_on|translate) : ($root.resources.strings.aria_toggleChannelRules_off|translate)}}" is-checked="dsCtrl.contentEnabled" on-toggle="dsCtrl.changeChannelRulesState(isChecked)">\n    </toggle-switch>\n  </div>\n  <div class="horizontal-container">\n    <div class="vertical-flex-container">\n      <div class="text-padding">\n        <label class="control-text" ng-bind="::$root.resources.strings.digital_signage_channel_rules_dialog_duration_description | translate" aria-label="{{::$root.resources.strings.digital_signage_channel_rules_dialog_duration_description  | translate}}" data-tid="digital-signage-content-management-dialog-time-frame-options-description">\n        </label>\n      </div>\n      <div>\n        <dropdown-select class="drop-down" ds-hide-caret="true" ds-text-field="text" ds-value-field="value" ds-default-text-field="::dsCtrl.timeFrameOptions[0].text" ds-disabled="true" ds-options="::dsCtrl.timeFrameOptions" data-tid="digital-signage-content-management-dialog-time-frame-options">\n        </dropdown-select>\n      </div>\n    </div>\n    <div class="vertical-flex-container">\n      <div class="text-padding">\n        <label class="control-text" ng-bind="::$root.resources.strings.digital_signage_channel_rules_dialog_message_limit_description | translate" aria-label="{{::$root.resources.strings.digital_signage_channel_rules_dialog_message_limit_description  | translate}}" data-tid="digital-signage-content-management-dialog-limit-to-options-description">\n        </label>\n      </div>\n      <div>\n        <dropdown-select class="drop-down" ds-hide-caret="true" ds-text-field="text" ds-value-field="value" ds-default-text-field="::dsCtrl.limitToOptions[0].text" ds-disabled="true" ds-options="::dsCtrl.limitToOptions" data-tid="digital-signage-content-management-dialog-limit-to-options">\n        </dropdown-select>\n      </div>\n    </div>\n  </div>\n  <div class="footer-line" data-tid="digital-signage-content-management-dialog-footer-line">\n  </div>\n</div>\n'},1708:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1709),a=function(){function t(t,e,i,n){var a=this;this.$scope=t,this.$translate=e,this.resources=i,this.ngDialog=n,this.okayButtonText=this.$translate.instant(this.resources.strings.okay),this.dialogHeaderText=this.$scope.ngDialogData.dialogHeaderText,this.dialogDescriptionText=this.$scope.ngDialogData.dialogDescriptionText,this.$scope.performAction=function(){a.ngDialog.closeAll()}}return t.$inject=["$scope","$translate","resources","ngDialog"],t}();e.DigitalSignageErrorController=a;var s="components/digital-signage-error-dialog/digital-signage-error-dialog.html";angular.module("teamspace.digitalSignageErrorDialog",["teamspace.dialogService","teamspace.loggingService"]).run(["constants","dialogService",function(t,e){e.register(t.dialogs.digitalSignageError,{template:s,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:"DigitalSignageErrorController",controllerAs:"dsCtrl",ariaAuto:!1,ariaRole:"dialog"})}]).controller("DigitalSignageErrorController",a).run(["$templateCache",function(t){t.put(s,n)}])},1709:function(t,e){t.exports='<div class="ts-digital-signage-error-dialog" data-tid="digitalSignageErrorDialog">\n  <div class="ts-modal-dialog-header">\n    <div>\n      <img class="error-image" src="https://statics.teams.microsoft.com/hashedassets/digital-signage-error-8d3d95f7.svg" aria-hidden="true"/>\n    </div>\n    <h1 class="app-font-family-base ts-modal-dialog-title header-text" ng-bind="::dsCtrl.dialogHeaderText" id="digital-signage-error-dialog-title" data-tid="digital-signage-error-dialog-title" aria-label="::dsCtrl.dialogHeaderText">\n    </h1>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <div class="dialog-description">\n      <div ng-bind="::dsCtrl.dialogDescriptionText" aria-label="::dsCtrl.dialogDescriptionText" data-tid="digital-signage-error-dialog-description">\n      </div>\n    </div>\n    <div class="footer-line" data-tid="digital-signage-error-dialog-footer-line">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <div class="ts-modal-button-div">\n        <button ng-click="performAction($event);" ng-disabled="dialogBusy" class="ts-btn ts-btn-primary inset-border" data-tid="digital-signage-error-dialog-okay-button" acc-role="focus-default" aria-label="{{::$root.resources.strings.okay | translate}}" ng-bind="::dsCtrl.okayButtonText">\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'},1710:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1711),a=function(){function t(t,e,i,n){var a=this;this.$scope=t,this.$translate=e,this.resources=i,this.ngDialog=n,this.okayButtonText=this.$translate.instant(this.resources.strings.okay),this.dialogHeaderText=this.$scope.ngDialogData.dialogHeaderText,this.dialogDescriptionText=this.$scope.ngDialogData.dialogDescriptionText,this.$scope.performAction=function(){a.ngDialog.closeAll()}}return t.$inject=["$scope","$translate","resources","ngDialog"],t}();e.DigitalSignageConfirmationController=a;var s="components/digital-signage-confirmation-dialog/digital-signage-confirmation-dialog.html";angular.module("teamspace.digitalSignageConfirmationDialog",["teamspace.dialogService","teamspace.loggingService"]).run(["constants","dialogService",function(t,e){e.register(t.dialogs.digitalSignageConfirmation,{template:s,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:"DigitalSignageConfirmationController",controllerAs:"dsCtrl",ariaAuto:!1,ariaRole:"dialog"})}]).controller("DigitalSignageConfirmationController",a).run(["$templateCache",function(t){t.put(s,n)}])},1711:function(t,e){t.exports='<div class="ts-digital-signage-confirmation-dialog" data-tid="digitalSignageConfirmationDialog">\n  <div class="ts-modal-dialog-header">\n    <h1 class="app-font-family-base ts-modal-dialog-title header-text" ng-bind="::dsCtrl.dialogHeaderText" id="digital-signage-confirmation-dialog-title" data-tid="digital-signage-confirmation-dialog-title" aria-label="::dsCtrl.dialogHeaderText">\n    </h1>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <div ng-bind="::dsCtrl.dialogDescriptionText" aria-label="::dsCtrl.dialogDescriptionText" data-tid="digital-signage-confirmation-dialog-description">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <div class="ts-modal-button-div">\n        <button ng-click="performAction($event);" ng-disabled="dialogBusy" class="ts-btn ts-btn-primary inset-border" data-tid="digital-signage-confirmation-dialog-okay-button" acc-role="focus-default" aria-label="{{::$root.resources.strings.okay | translate}}" ng-bind="::dsCtrl.okayButtonText"></button>\n      </div>\n    </div>\n  </div>\n</div>\n'}},[1698]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/lazy-ng1-mod-digital-signage-dialog-components.min.js-00856392.map