(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[6],{"0565c735921892f98831":function(e,t,r){"use strict";var a;r.r(t),function(e){e[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}(a||(a={}));var n=function(){return function(){}}(),i=r("3c88ca8e24c9c99ad593");r.d(t,"Identity",function(){return n}),r.d(t,"IdentityType",function(){return a}),r.d(t,"PermissionMask",function(){return i.a})},"0f0466a703c07c317df9":function(e,t,r){"use strict";(function(e){function a(){var t;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}t.Symbol||(t.Symbol=function(e){return"[["+e+"_"+Math.random().toFixed(8).slice(2)+"]]"}),t.Symbol.asyncIterator||(t.Symbol.asyncIterator=t.Symbol.for&&t.Symbol.for("Symbol.asyncIterator")||"__@asyncIterator__")}r.d(t,"a",function(){return a})}).call(this,r("698d75b157f24ae829cc"))},"3d92c7f3fb145bfb9378":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("0b8514f932f40951d460"),n=r("e9d155a6651c0bf6c9b0");function i(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var r=o(e);try{return JSON.parse(r),!0}catch(e){return!1}}return!1}function l(e,t){var r=o(e);try{var i=JSON.parse(r);return function(e){var t=e.pageContext,r=e.appInstanceId,a=e.appOAuthId,i=e.launchUrl,l=e.isTenantApp,o=n.default.escapeUrlForCallback(t.webAbsoluteUrl),s=n.default.escapeUrlForCallback(t.layoutsUrl),c=o+"/"+s+"/appredirect.aspx";if(a&&i)c+="?client_id="+n.default.encodeURIComponent(a)+"&redirect_uri="+n.default.encodeURIComponent(i);else{if(!r)throw"appOAuthId, launchUrl, appInstanceId are null";c+="?instance_id="+n.default.encodeURIComponent(r)}l&&(c+="&tsapp=1");window.location.href=c}({pageContext:t,appInstanceId:i[0],appOAuthId:i[1],launchUrl:i[2],isTenantApp:i[4]}),a.default.wrap()}catch(e){return a.default.wrapError(e)}}function o(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},"5730cedeedcb5640bb56":function(e,t,r){"use strict";var a,n,i=r("98bae3dbabd51089d613");!function(e){e[e.ContextMenu=0]="ContextMenu",e[e.RibbonDocuments=1]="RibbonDocuments",e[e.RibbonList=2]="RibbonList"}(a||(a={})),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(n||(n={}));var l={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},o=r("0565c735921892f98831"),s=r("c4e199bc4bcd0fb7cb54"),c=r("3d92c7f3fb145bfb9378"),u=r("00620f24248a4f158ff6"),d=r("cdb9a7d2db44c7a9f4dd"),m=r("0a3e1b609e40999fd831"),p=r("e9d155a6651c0bf6c9b0");function f(e,t){var r=[],a=[],o=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var c=new DOMParser,p=function(e){var p=e.Location,f=e.RegistrationType;if(p&&0===p.lastIndexOf(l.CommandSet,0)){if(!f||f!==n.List)return"continue";var b=p===l.CommandSet,v=p===l.ContextMenu||b,y=p===l.CommandBar||b,U={text:e.Title,isEnabled:function(){return _({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};v&&o.push(U),y&&(Object(u.isDocumentLibrary)(t.listTemplate)?r.push(i.__assign({},U)):a.push(i.__assign({},U)))}else{if(!h(e.UrlAction))return"continue";if(e.CommandUIExtension&&m.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var S=F(e,t,!0),O=F(e,t,!1),A=void 0;try{A=c.parseFromString(e.CommandUIExtension,s.b.doctype)}catch(e){}if(!A)return"continue";var K=A.getElementsByTagName("Tab");if(K&&0!==K.length||(K=A.getElementsByTagName("Group")),K&&K.length>0){var T=g(K,!0),j=g(K,!1),C={};if(T||j)for(var k=0,x=A.getElementsByTagName("CommandUIHandlers");k<x.length;k++)for(var P=x[k].firstElementChild;P;)C[P.getAttribute("Command")]=P.getAttribute("CommandAction"),P=P.nextElementSibling;if(T){var D=w(T,C,e,S);r.push(D)}if(j){D=w(j,C,e,O);a.push(D)}}else{var N=A.getElementsByTagName("Button"),R=I(N,!0,e,S);R&&r.push(R);var E=I(N,!1,e,O);E&&a.push(E)}}else if("EditControlBlock"===e.Location&&e.Title){var L={text:e.Title,isEnabled:F(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""};o.push(L)}}},f=0,b=e;f<b.length;f++){p(b[f])}return{"Ribbon.Documents":r,"Ribbon.List":a,ContextMenu:o}}function b(e,t){var r=[];return e.forEach(function(e,a){var i={registrationId:e.registrationId,registrationType:n[e.registrationType],requireSiteAdministrator:!1,rights:{High:Number(e.rightsHigh),Low:Number(e.rightsLow)}};h(e.action)&&r.push({text:e.title,iconUrl:e.imageUrl,isEnabled:_(i,t),action:e.action})}),r}function v(e){return"children"in e}function y(e,t,r){var a=r.webAbsoluteUrl+"/",n=r.layoutsUrl+"/",i=""+a+n,l=r.siteAbsoluteUrl+"/",o=""+l+n,s="",c=r.listId,u=r.listUrl;if(0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(c=c.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D")),s=e.replace(/{SiteUrl}/g,a).replace(/~site\//g,a).replace(/~layouts\//g,n).replace(/~siteLayouts\//g,i).replace(/~siteCollection\//g,l).replace(/~siteCollectionLayouts\//g,o).replace(/{ListId}/g,c).replace(/{SelectedListId}/g,c).replace(/{ListUrlDir}/g,u).replace(/{Source}/g,p.default.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true"),t.length>0){var d=t.join(","),m=t[0];s=s.replace(/{ItemUrl}/g,p.default.encodeURIComponent(m)).replace(/{ItemId}/g,m).replace(/{SelectedItemId}/g,d)}else s=s.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return s}function h(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||Object(c.b)(e,!1))}function F(e,t,r){var a=void 0===r||r===Object(u.isDocumentLibrary)(t.listTemplate);if(e.CommandUIExtension&&e.EnabledScript)return a||!0;var n=_({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!n&&("function"==typeof n?"function"==typeof a?function(e){return n(e)&&a}:n:a)}function g(e,t){for(var r=0,a=e.length;r<a;r++){var n=e[r],i=n.getAttribute("Id");if(!i)return n;if((t||!m.doesStringStartWith(i,"Ribbon.Documents"))&&!(t&&m.doesStringStartWith(i,"Ribbon.List")||m.doesStringStartWith(i,"Ribbon.Calendar")))return n}return null}function w(e,t,r,a){for(var n=[],i=e.getElementsByTagName("Button"),l=0,o=i.length;l<o;l++){var s=i[l],c=s.getAttribute("Command"),u=c&&t[c]||r.UrlAction;if(h(u)){var m={text:s.getAttribute("LabelText"),iconUrl:U(s),isEnabled:a,allowMultiSelect:!r.EnabledScript,action:u,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""};n.push(m)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:n}}function U(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function I(e,t,r,a){var n;if(("boolean"!=typeof a||a)&&(e&&e.length>0&&(n=g(e,t)),n)){var i=n.getAttribute("LabelText")||r.Title;if(i){var l={text:i,allowMultiSelect:!r.EnabledScript,action:r.UrlAction,isEnabled:a,clientSideComponentId:d.default.Empty,clientSideComponentProperties:""},o=U(e[0]);return o&&(l.iconUrl=o),l}}}function _(e,t){var r=function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return o.PermissionMask.hasItemPermission(t,e.rights)}}(e,t),a=function(e,t){var r=e.registrationType,a=e.registrationId;if(!a)return r===n.List;switch(r){case n.List:var i=parseInt(a,10);return i===t.listTemplate||a===t.listId;case n.FileType:var l="."+a;return function(e){return m.equalsCaseInsensitive(e.extension,l)};case n.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&m.doesStringStartWith(t,a)};case n.ProgId:return function(e){var t="progId"in e&&e.progId||"properties"in e&&e.properties.ProgId;return t===a}}return!1}(e,t);return!(!r||!a)&&function(e){return!!e&&(!("function"==typeof r&&!r({permissions:e.permissions}))&&!("function"==typeof a&&!a(e)))}}r.d(t,"b",function(){return f}),r.d(t,"c",function(){return b}),r.d(t,"a",function(){return v}),r.d(t,"d",function(){return y})},"5abe0a4e18e69c009f41":function(e,t,r){"use strict";function a(e,t,r,a){var n="",i=0;if(!e)return"";var l=e.length;for(i=0;i<l;i++){var o=e.charCodeAt(i),s=e.charAt(i);if(t&&("#"===s||"?"===s)){n+=e.substr(i);break}if(r&&"&"===s)n+=s;else if(o<=127)a?n+=s:o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||t&&o>=32&&o<=95&&" \"%<>'&".indexOf(s)<0?n+=s:o<=15?n+="%0"+o.toString(16).toUpperCase():o<=127&&(n+="%"+o.toString(16).toUpperCase());else if(o<=2047)n+="%"+(192|o>>6).toString(16).toUpperCase(),n+="%"+(128|63&o).toString(16).toUpperCase();else if(55296!=(64512&o))n+="%"+(224|o>>12).toString(16).toUpperCase(),n+="%"+(128|(4032&o)>>6).toString(16).toUpperCase(),n+="%"+(128|63&o).toString(16).toUpperCase();else if(i<e.length-1){o=(1023&o)<<10,i++,o|=1023&e.charCodeAt(i),n+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase(),n+="%"+(128|(258048&o)>>12).toString(16).toUpperCase(),n+="%"+(128|(4032&o)>>6).toString(16).toUpperCase(),n+="%"+(128|63&o).toString(16).toUpperCase()}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeURIComponent=a,t.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(t>0&&(-1===r||t<r)){var n=e.substr(0,t);r>0&&(n+=e.substr(r)),e=n}return a(e,!0,!1,!0)},t.encodeRestUriStringToken=function(e){return e&&(e=a(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),e}},"5f37f5ec04a007134c18":function(e,t,r){"use strict";var a=r("e2ea1f13f9b3e771ed24"),n=r("0a3e1b609e40999fd831"),i="forms.officeppe.com",l="forms.office.com",o="&action=edit";function s(e,t,r){var a=e.replace(o,""),n=r?i:l,s="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(a)+"&Title="+encodeURIComponent(t);return"https://"+n+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(s)}function c(e,t,r){var a=void 0;return"string"==typeof e?0===(e=e.trim()).length?a=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(a=n.format(r?t.invalidNameError2:t.invalidNameError,e)):a=t.emptyNameError,a}function u(e,t,r,n){var i="";return null!==e&&""!==e&&(i=t===a.DocumentType.ExcelSurvey?e.replace("action=edit","action=formedit"):t===a.DocumentType.ExcelForm?s(e,r,n):e.replace("action=edit","action=editnew")),i}r.d(t,"a",function(){return c}),r.d(t,"b",function(){return u})},"661b65dcf8351e92fe44":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").a)("fileHandlerActionControl")},"6946c0f0887243183999":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.Facet("modifyView"),l=Object(n.f)({operationTypeFacet:i})},"69cac92887c58482641e":function(e,t,r){"use strict";r.d(t,"a",function(){return s});var a=r("98bae3dbabd51089d613"),n=r("48609eee00eefd224b5f"),i=r("d4c1443220e1f44fce5e"),l=r("6f955b5d8c305cf22bad"),o=r("0f0466a703c07c317df9");function s(e){return function(t,r){return a.__asyncGenerator(this,arguments,function(){var o,s,c,u,d,m,p,f;return a.__generator(this,function(b){switch(b.label){case 0:u={},b.label=1;case 1:b.trys.push([1,,14,15]),b.label=2;case 2:d=new n.a({state:r(),dispatch:t,previousDependencies:o,previousDemands:s}),b.label=3;case 3:return b.trys.push([3,,7,8]),d.haveDependenciesChanged()?(c=d.evaluate(e).result,[4,a.__await(c)]):[3,6];case 4:return[4,b.sent()];case 5:b.sent(),b.label=6;case 6:return[3,8];case 7:return d.dispose(),[7];case 8:return m=d.getDemands(),p=d.getDependencies(),f=t(Object(i.excludeResolvedDemands)({items:m})),t(Object(l.recordLastItemAccesses)({items:p})),0!==Object.keys(f.items).length?[3,10]:[4,a.__await(void 0)];case 9:return[2,b.sent()];case 10:return t(Object(l.registerItemDemands)({owner:u,items:p})),[4,a.__await(t(Object(i.getItems)(f)))];case 11:b.sent(),s=m,o=p,b.label=12;case 12:return[3,2];case 13:return[3,15];case 14:return t(Object(l.removeItemDemands)({owner:u})),[7];case 15:return[2]}})})}}Object(o.a)()},"83f2d47bcced97f0a85c":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").a)("getDriveItemFullUrlControl")},"85bfca0cd3bb87373c39":function(e,t,r){"use strict";r.d(t,"a",function(){return o});var a=r("65da65eb66805e3724ff"),n=r("6578506114fc52cc91d3"),i=r("00620f24248a4f158ff6"),l=r("dafd9db62310f1337c17");function o(e){return function(t){return t(Object(a.e)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:u(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:s(t,!1,e.listTemplate)}})},noRedirect:!0}))}}function s(e,t,r){if(e.ViewType&&e.Id){var a=l.a.isAppView(e),n=e.Hidden&&!a,o=r===i.ListTemplateType.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!n&&!o){var s=new l.a(e);if(s.viewType)return s}}}var c=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function u(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.viewId,i=Object(n.a)({webAbsoluteUrl:t,listFullUrl:r});return(i=a?i.method("Views",a):i.segment("Views")).oDataParameter("$select",c).toString()}},"8c495b09d9111445d5b0":function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return d});var a=r("a4060cda3c9c24220a4a"),n=r("5e76ddf6bb30811ee697"),i=r("fcf654cc44d7ec457fe0"),l=r("ee92087a6ec1d0e9ecc9"),o=r("3c88ca8e24c9c99ad593"),s=r("95da7825c4969f34e250"),c=r("cfef2ab49d0d7bc1e869"),u=Object(s.a)()(function(){return function(e){return function(e,t){var r,o=t.itemKey,s=e.demandItemFacet(a.spItemKeyFacet,o),u=!1,m=c.a;if(s&&o){u=d(e,o,s);var p=s.rootFolder||new i.SimpleUri(s.listFullUrl).path,f=new n.a({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}),b=f.getUrlParts({path:p});b.fullItemUrl&&(r=400-b.fullItemUrl.length);var v=s&&e.demandItemFacet(l.spPageContextFacet,a.spPageContextKeyFacet.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}));!v||v.supportPoundStorePath&&v.supportPercentStorePath||(m=c.b)}return{isAvailable:u,validator:m,maxLength:r}}}});function d(e,t,r){var n=a.spListKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),i=e.demandItemFacet(l.listFacet,n),s=e.demandItemFacet(l.permissionsFacet,t);return!(!i||!i.allowCreateFolder)&&o.a.hasItemPermission({permissions:s},o.a.insertListItems)}},a083584f8eeab8771a10:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.Facet("saveViewCore"),l=Object(n.f)({operationTypeFacet:i})},a3886a89b418632a97c5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("98bae3dbabd51089d613"),n=r("0565c735921892f98831"),i=r("00620f24248a4f158ff6"),l=r("cd86271a21b3a4d18be3"),o=r("1c8f7532950b71f6d754"),s=r("e2ea1f13f9b3e771ed24"),c=r("ad8edfa16f4c343f7dce"),u=r("d8376f4535401b5bd67a"),d=r("87e95cd1ff4b249d307f"),m=r("4e087ea06522888b2152"),p=r("d0af51c98de7406fa9c5"),f=r("c1a09d7dd35e11297e15"),b={ODB:973},v={ODB:211};function y(e,t,r,a,o,c){var u=t&&t.canShareLinkForNewDocument,d=I(a),m=_(a),p=!0;return l.isSPFeatureEnabled(v,a.ExpFeatures)&&t&&(p=function(e,t,r){if(l.isSPFeatureEnabled(v,r)){var a=void 0;switch(function(e){e[e.Invalid=0]="Invalid",e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PowerPoint=3]="PowerPoint",e[e.OneNote=4]="OneNote",e[e.ExcelForm=5]="ExcelForm",e[e.Visio=8]="Visio",e[e.Max=9]="Max"}(a||(a={})),e){case s.DocumentType.Word:case s.DocumentType.Excel:case s.DocumentType.PowerPoint:case s.DocumentType.OneNote:case s.DocumentType.Visio:return Boolean(t&1<<Number(e));case s.DocumentType.ExcelForm:case s.DocumentType.ExcelSurvey:return Boolean(t&1<<Number(5));default:return!0}}return!0}(r,t.newWOPIDocumentTypes,a.ExpFeatures)),c=void 0!==c?c:t&&t.newWOPIDocumentEnabled,(!o.isMobile||o.isIPad)&&!!t&&r!==s.DocumentType.Text&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.insertListItems)&&c&&p&&(r!==s.DocumentType.ExcelSurvey||u&&!d)&&(r!==s.DocumentType.ExcelForm||d&&(t.templateType!==i.default.documentLibrary||!!t.canUserCreateMicrosoftForm))&&(r!==s.DocumentType.Visio||m)}function h(e,t,r,a){return w(t,r.fullItemUrl,e)}function F(e,t,r,a,n){return w(a,r.getItemUrlParts(e).fullItemUrl,t)}function g(e,t,r,n,i){return a.__awaiter(this,void 0,void 0,function(){var l,o,s,b,v;return a.__generator(this,function(a){switch(a.label){case 0:return l=(new Date).getTime().toString(),t=c.WopiHelper.AddWopiPerfMarkToTargetUrl(l,"DocLib",t),o=new f.default,i?t&&(r.setImmediate(function(){var e;return p.navigateViaPost({postdata:(e={},e.access_token=i,e),url:t,document:n.document})}),o.complete()):(void 0,b=function(e){var t,r=e.getErrorResponseText();return t="string"==typeof r?r:JSON.stringify(r),d.default.logError("CreateDocumentByDocAspxCore: "+t),o.error(),{resultType:m.ResultTypeEnum.Failure}},v=function(e){return s=e,t&&r.setImmediate(function(){var e;return p.navigateViaPost({postdata:(e={},e.__REQUESTDIGEST=s,e),url:t,document:n.document})}),o.complete(),{resultType:m.ResultTypeEnum.Success}},new u.default({webAbsoluteUrl:e}).ensureRequestDigest(v,b)),[4,o.getPromise()];case 1:return a.sent(),[2]}})})}function w(e,t,r){if(null===r||r!==s.DocumentType.Word&&r!==s.DocumentType.PowerPoint&&r!==s.DocumentType.Prague&&r!==s.DocumentType.Bohemia)throw new Error("document type is not valid, doc.aspx createNew only support type: 1 - Word, 3 - PowerPoint for the time being.");var a=new o.default(e);return a.setQueryParameter("docliburl",encodeURI(t)),a.setQueryParameter("doctype",r.toString()),a.setQueryParameter("action","editnew"),a.setQueryParameter("odsp","1"),a.toString()}function U(e){return!!(e&&e.properties&&e.properties.commandsSupported&&e.properties.commandsSupported.canShareLinkForNewDocument)}function I(e){return!!e.canUserCreateMicrosoftForm}function _(e){return!!l.isSPFeatureEnabled(v,e.ExpFeatures)||e.isSPO&&(l.isSPFeatureEnabled(b,e.ExpFeatures)||!!e.PreviewFeaturesEnabled)}a.__exportStar(r("f805b591e29f83f7dfba"),t),t.isAvailable=function(e,t,r,n,i,l,o){return y(e,a.__assign({},r,{canShareLinkForNewDocument:U(t)}),n,i,l,o)},t.isAvailableBasic=y,t.isSupported=function(e,t,r,a,n,i){if(t===s.DocumentType.ExcelForm)return I(r)?(i(),!1):(a&&a.getShareByLinkInfo().then(function(t){Boolean(t)&&t.isExternalSharingTipEnabled&&U(e)?i():n()},function(e){n()}),!1);return t!==s.DocumentType.Visio||_(r)},t.shouldCreateInOfficeClient=function(e,t,r){return!(!t||e!==s.DocumentType.Word||"dot"!==r)},t.getCreateDocumentByDocAspxUrlWithItemUrlParts=h,t.getCreateDocumentByDocAspxUrl=F,t.createDocumentByDocAspx=function(e,t,r,a,n,i,l){return g(n,F(e,t,r,a),i,window.open("","_blank"))},t.createDocumentByDocAspxWithItemUrlParts=function(e,t,r,n,i,l,o,s){return a.__awaiter(this,void 0,void 0,function(){var l;return a.__generator(this,function(a){switch(a.label){case 0:return l=h(e,t,o),[4,g(r,l,n,i,s)];case 1:return a.sent(),[2]}})})}},b32a03546c11ac251a10:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var a=r("98bae3dbabd51089d613"),n=r("e9d155a6651c0bf6c9b0");function i(e,t,r){var i="",l=!0;for(var o in t&&(e=a.__assign({},t,e)),e){var s=e[o];if(!r||"object"!=typeof s&&s||"object"==typeof s&&s&&s.uriValue||"number"==typeof s||"boolean"==typeof s){l?l=!1:i+="&";i+=o+"="+("object"==typeof s&&s&&s.uriValue?s.uriValue:n.default.encodeURIComponent(""+s))}}return i}},bb1d3dd843cb19bcdb5a:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.Facet("saveUploadedTemplateToView"),l=Object(n.f)({operationTypeFacet:i})},bd2835d22f85a2b6d99d:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.Facet("createView"),l=Object(n.f)({operationTypeFacet:i})},c21819129ba64362c121:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});var a=r("447964f318fe44ff3682"),n=new a.Facet("entryBatch"),i=new a.Facet("sourceFile")},c317bf72559990179c22:function(e,t,r){"use strict";r.r(t);var a,n=r("98bae3dbabd51089d613"),i=r("680b7ac74280293b48f0"),l=r("163bd1662ba0d8c200dc"),o=r("e87bb409a9007bb8123c"),s=r("63aeb04d7e4744f15272"),c=r("6187b1a01125644c0b13"),u=r("be9ddcf0ec56bc42b1b1"),d=r("c8af1cc43f0b61ba9a17"),m=r("a4060cda3c9c24220a4a"),p=r("0be8895c37c7580fa8d6"),f=r("c89079fccee5039e5e63"),b=r("01e9cd72f63f0c70ab1c"),v=r("2abad5c842761f84fba3"),y=r("447964f318fe44ff3682"),h=r("f5df325953ebb7f1143d"),F=new y.Facet("assignItemToGroup"),g=new h.a("assignToGroup"),w=r("6946c0f0887243183999"),U=r("a083584f8eeab8771a10"),I=r("bd2835d22f85a2b6d99d"),_=r("95da7825c4969f34e250"),S=r("e008263a4c0e246e4f4f"),O=r("c88e7380c3f2d1910abe"),A=r("2c440e638bb16e83d44e"),K=r("2807dfd01f20f29a2152"),T=r("64b1e6e25051aaaf0681"),j=r("022addba5cf25ce091fb");!function(e){e[e.preview=0]="preview",e[e.save=1]="save"}(a||(a={}));var C=new y.Facet("updateColumnFormatter"),k=(Object(j.f)({operationTypeFacet:C}),r("d4c1443220e1f44fce5e")),x=r("5fef64b3561abb2ebffa"),P=r("fdbcb7664c17b5b4e4d9"),D=r("ee92087a6ec1d0e9ecc9"),N=r("65da65eb66805e3724ff"),R=r("8bcc52c340fdae8e02d4"),E=r("6578506114fc52cc91d3"),L=r("eba1a54870ffae1e61c2"),z=r("8605abf9448f5c554409");function V(e){return function(t){return t(Object(N.e)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:q(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||""}},noRedirect:!0}))}}function q(e){var t=e.tenantRootUrl;return Object(E.b)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function M(e){var t=this,r=e.method,a=e.path,i=e.context,l=e.qosName,o=l?"getData."+l:"getData";return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l,s,c,u;return n.__generator(this,function(n){switch(n.label){case 0:return t=new Headers,[4,e(Object(N.b)({url:i.resource}))];case 1:return(l=n.sent())&&t.set("Authorization","Bearer "+l),i.payloadHeader&&t.set("SPHome-ApiContext",i.payloadHeader),t.set("SPHome-ClientType","ODSPDocLibsWeb"),s={headers:t,credentials:"omit",method:r,mode:"cors",cache:"default"},c=e(Object(L.a)({name:o})),[4,fetch(i.resource+"/"+a,s)];case 2:return(u=n.sent()).ok?(e(c({resultType:z.ResultTypeEnum.Success})),[4,u.json()]):[3,4];case 3:return[2,n.sent()];case 4:return e(c({resultType:z.ResultTypeEnum.Failure})),[2,Promise.reject(new Error(""+u.status))]}})})}}function B(e){var t=new R.default(e.webAbsoluteUrl).authority;if(!t)throw new Error("No web url available for GetList call");return Object(E.b)({webAbsoluteUrl:t}).segment("SP.Web.GetDocumentLibraries").parameter("webFullUrl",e.webAbsoluteUrl).toString()}var G=r("5f6c4af8cb56376acb4d");function W(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l;return n.__generator(this,function(o){switch(o.label){case 0:return a=m.spHomeContextKeyFacet.deserialize(e.itemKey).tenantRootUrl,i=new G.a,[4,r(V({tenantRootUrl:a}))];case 1:return l=o.sent(),i.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},D.spHomeResourceFacet.pack(l.resource),D.spHomePayloadHeaderFacet.pack(l.payloadHeader)),t)}),r(i.execute()),[2]}})})}}var H=r("52ea8189ec1bd7bba704"),J=r("4986dedaa57d766e48bb")._mbDabxjGbDpso2fDZQAQog;function Q(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s;return n.__generator(this,function(c){return a=m.spAllSitesKeyFacet.deserialize(e.itemKey).tenantRootUrl,i=new G.a,l=m.spFrequentSitesItemSetKeyFacet.serialize({tenantRootUrl:a}),o=m.spFollowedSitesItemSetKeyFacet.serialize({tenantRootUrl:a}),s=[l,o],i.resolveItems({items:(t={},t[l]=n.__assign({},H.e.pack(!0),x.displayNameFacet.pack(J.frequent),D.parentGroupKeyFacet.pack({itemKey:e.itemKey})),t[o]=n.__assign({},H.e.pack(!0),x.displayNameFacet.pack(J.followed),D.parentGroupKeyFacet.pack({itemKey:e.itemKey})),t[e.itemKey]=n.__assign({},x.displayNameFacet.pack(J.sites),P.childItemsFacet.pack({itemKeys:s})),t)}),r(i.execute()),[2]})})}}function X(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s,c,u,d,p,f,b,v,y;return n.__generator(this,function(h){switch(h.label){case 0:return o=m.spFrequentSitesItemSetKeyFacet.deserialize(e.itemKey).tenantRootUrl,s=new G.a,[4,r(V({tenantRootUrl:o}))];case 1:return c=h.sent(),[4,r((F=c,function(e){return e(M({path:"api/v1/sites/feed?acronyms=true&start=0&count=8",method:"GET",qosName:"getSPHomeFrequentSites",context:F}))}))];case 2:u=h.sent(),d=[];try{for(p=n.__values(u.Items),f=p.next();!f.done;f=p.next())b=f.value,v=m.spWebKeyFacet.serialize({webAbsoluteUrl:b.Url}),y=m.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:b.Url}),s.resolveItems({items:(i={},i[v]=n.__assign({},x.displayNameFacet.pack(b.Title),D.acronymFacet.pack(b.Acronym),D.bannerColorFacet.pack(b.BannerColor),D.bannerImageUrlFacet.pack(b.BannerImageUrl),D.isSiteFacet.pack(!0),x.folderFacet.pack({}),m.spWebKeyFacet.pack({webAbsoluteUrl:b.Url}),P.defaultChildItemSetFacet.pack({itemKey:y})),i[y]=n.__assign({},P.parentItemFacet.pack({itemKey:v})),i)}),d.push(v)}catch(e){t={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(t)throw t.error}}return s.resolveItems({items:(l={},l[e.itemKey]=n.__assign({},x.displayNameFacet.pack(J.frequent),P.childItemsFacet.pack({itemKeys:d}),D.parentGroupKeyFacet.pack({itemKey:m.spAllSitesKeyFacet.serialize({tenantRootUrl:o})})),l)}),r(s.execute()),[2]}var F})})}}function $(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s,c,u,d,p,f,b,v,y;return n.__generator(this,function(h){switch(h.label){case 0:return o=m.spFollowedSitesItemSetKeyFacet.deserialize(e.itemKey).tenantRootUrl,s=new G.a,[4,r(V({tenantRootUrl:o}))];case 1:return c=h.sent(),[4,r((F=c,function(e){return e(M({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:F}))}))];case 2:u=h.sent(),d=[];try{for(p=n.__values(u.Items),f=p.next();!f.done;f=p.next())b=f.value,v=m.spWebKeyFacet.serialize({webAbsoluteUrl:b.Url}),y=m.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:b.Url}),s.resolveItems({items:(i={},i[v]=n.__assign({},x.displayNameFacet.pack(b.Title),D.acronymFacet.pack(b.Acronym),D.bannerColorFacet.pack(b.BannerColor),D.bannerImageUrlFacet.pack(b.BannerImageUrl),D.isSiteFacet.pack(!0),x.folderFacet.pack({}),m.spWebKeyFacet.pack({webAbsoluteUrl:b.Url}),P.defaultChildItemSetFacet.pack({itemKey:y})),i[y]=n.__assign({},P.parentItemFacet.pack({itemKey:v})),i)}),d.push(v)}catch(e){t={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(t)throw t.error}}return s.resolveItems({items:(l={},l[e.itemKey]=n.__assign({},x.displayNameFacet.pack(J.followed),P.childItemsFacet.pack({itemKeys:d}),D.parentGroupKeyFacet.pack({itemKey:m.spAllSitesKeyFacet.serialize({tenantRootUrl:o})})),l)}),r(s.execute()),[2]}var F})})}}function Z(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l;return n.__generator(this,function(o){return a=m.spWebKeyFacet.deserialize(e.itemKey).webAbsoluteUrl,i=new G.a,l=m.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:a}),i.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},P.defaultChildItemSetFacet.pack({itemKey:l})),t)}),r(i.execute()),[2]})})}}var Y=r("5e76ddf6bb30811ee697");function ee(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g;return n.__generator(this,function(w){switch(w.label){case 0:return o=m.spLibrariesItemSetKeyFacet.deserialize(e.itemKey).webAbsoluteUrl,s=m.spWebKeyFacet.serialize({webAbsoluteUrl:o}),c=new G.a,[4,r((U={webAbsoluteUrl:o},function(e){return e(Object(N.e)({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.webAbsoluteUrl,method:"POST",url:B({webAbsoluteUrl:U.webAbsoluteUrl}),qosName:"getDocumentLibraries",noRedirect:!0}))}))];case 1:u=w.sent(),d=[];try{for(p=n.__values(u.d.GetDocumentLibraries.results),f=p.next();!f.done;f=p.next())b=f.value,v=new Y.a({context:{webAbsoluteUrl:o}}),y=v.getUrlParts({webUrl:o,listUrl:b.AbsoluteUrl,path:b.AbsoluteUrl}),h={webAbsoluteUrl:o,listFullUrl:y.fullListUrl||"",rootFolder:""},F=m.spItemKeyFacet.serialize(h),g=m.spFolderItemSetKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:y.fullListUrl||"",rootFolder:""}),c.resolveItems({items:(i={},i[F]=n.__assign({},x.displayNameFacet.pack(b.Title),m.spItemKeyFacet.pack(h),x.folderFacet.pack({}),x.fileNameFacet.pack({name:new R.default(y.fullListUrl).segments.slice(-1)[0],extension:""}),D.folderPathFacet.pack(y.serverRelativeItemUrl),P.defaultChildItemSetFacet.pack({itemKey:g}),x.parentFolderItemFacet.pack(void 0)),i[g]=n.__assign({},P.parentItemFacet.pack({itemKey:F})),i)}),d.push(F)}catch(e){t={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(t)throw t.error}}return c.resolveItems({items:(l={},l[e.itemKey]=n.__assign({},P.childItemsFacet.pack({itemKeys:d}),m.spWebKeyFacet.pack({webAbsoluteUrl:o}),P.parentItemFacet.pack({itemKey:s})),l)}),r(c.execute()),[2]}var U})})}}var te=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(k.supportFacets)({keyFacet:m.spWebKeyFacet,facets:[x.displayNameFacet,P.defaultChildItemSetFacet]})),e(Object(k.supportFacets)({keyFacet:m.spFollowedSitesItemSetKeyFacet,facets:[m.spFollowedSitesItemSetKeyFacet,P.childItemsFacet]})),e(Object(k.supportFacets)({keyFacet:m.spFrequentSitesItemSetKeyFacet,facets:[m.spFrequentSitesItemSetKeyFacet,P.childItemsFacet]})),e(Object(k.supportFacets)({keyFacet:m.spLibrariesItemSetKeyFacet,facets:[m.spLibrariesItemSetKeyFacet,P.childItemsFacet,P.defaultChildItemSetFacet]})),e(Object(i.f)(m.spHomeContextKeyFacet,u.a)(Object(i.e)()(W))),e(Object(i.f)(m.spAllSitesKeyFacet,u.a)(Object(i.e)()(Q))),e(Object(i.f)(m.spFrequentSitesItemSetKeyFacet,u.a)(Object(i.e)()(X))),e(Object(i.f)(m.spFollowedSitesItemSetKeyFacet,u.a)(Object(i.e)()($))),e(Object(i.f)(m.spWebKeyFacet,u.a)(Object(i.e)()(Z))),e(Object(i.f)(m.spLibrariesItemSetKeyFacet,u.a)(Object(i.e)()(ee))),[2]})})}}),re=r("e98e292c4101e4220c18"),ae=r("c70c28d41140929c0281"),ne=r("6d69c5cabadd78126515"),ie=r("eef09ec91afb2fd77b66"),le=r("b32a03546c11ac251a10"),oe=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spTenantKeyFacet.deserialize(r).tenantRootUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s,c,u,d,p,f,b,v;return n.__generator(this,function(y){switch(y.label){case 0:return i=m.spWebPageContextKeyFacet.serialize({webAbsoluteUrl:a}),[4,r(Object(ae.a)(function(e){return e.demandItemFacet(D.spPageContextFacet,i)}))];case 1:return l=y.sent(),o=r(Object(ie.a)(function(e){return e.demandItemFacet(ne.localeFacet,ne.configurationItemKey)})),s=l&&l.isSPO,u=o&&o.language||"en-US",d=Object(le.a)({Locale:u,v:2,msajax:1,cv:2}),c=s?a+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+d:Object(E.b)({webAbsoluteUrl:a}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:u}),[4,r(Object(N.c)({url:c.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:a,noRedirect:!0}))];case 2:return p=y.sent(),f=s?p:JSON.parse(p.d.GetSuiteNavData),b=!(!f.NavBarData||!f.NavBarData.AdminLink)||!1,(v=new G.a).resolveItems({items:(t={},t[e.itemKey]=n.__assign({},m.spTenantKeyFacet.pack({tenantRootUrl:a}),D.spTenantAdminFacet.pack(b)),t)}),r(v.execute()),[2]}})})}});var se,ce=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(i.f)(m.spTenantKeyFacet,u.a)(oe)),[2]})})}}),ue=r("fcf654cc44d7ec457fe0"),de=r("6f13f8350c84cf96896e"),me=r("db4d7f5ad0e1e93cea48"),pe=r("bfb8194d4dce098111b8"),fe=r("6e62786e04351f279fc3"),be=r("5e2d26706bb97efeb013"),ve=r("85b502035ba6002afa5a"),ye=r("dc969c026d388e81ff0e"),he=r("578e5017557fc66bb247"),Fe=r("7f8b22b90e1fa57005a6"),ge=r("796938beaf14a90a25ec"),we=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(k.supportFacets)({keyFacet:m.spItemFullUrlKeyFacet,facets:[m.spItemFullUrlKeyFacet,x.displayNameFacet,x.fileNameFacet,D.uniqueIdFacet,x.folderFacet,D.folderPathFacet,P.defaultChildItemSetFacet,D.missingMetadataFieldsFacet,Fe.a,Fe.b]})),e(Object(i.f)(m.spItemFullUrlKeyFacet,u.a)(Object(i.e)()(Ue))),[2]})})}});function Ue(e){var t=this,r=e.itemKey,a=m.spItemFullUrlKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w;return n.__generator(this,function(U){switch(U.label){case 0:return l=new G.a,o=new ue.SimpleUri(a.itemFullUrl),s=e(function(e,t,r){return function(a){var i,l,o,s,c,u=e.itemFullUrl,d=new ue.SimpleUri(u),p=["File_x0020_Type","FileRef","FileLeafRef"];c=[d.path];var f=a(Object(he.a)({contentTypeId:D.contentTypeIdFacet},m.spItemFullUrlKeyFacet.serialize(e)));if(t&&t.length>0&&f&&f.contentTypeId)try{for(var b=n.__values(t),v=b.next();!v.done;v=b.next()){var y=v.value;if(y.contentTypeId===f.contentTypeId&&y.Fields){var h=y.Fields.split(",");try{for(var F=n.__values(h),g=F.next();!g.done;g=F.next()){var w=g.value;"Modified_x0020_By"===w?p.push("Editor"):"Created_x0020_By"===w?p.push("Author"):p.push(w)}}catch(e){o={error:e}}finally{try{g&&!g.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}}}}catch(e){i={error:e}}finally{try{v&&!v.done&&(l=b.return)&&l.call(b)}finally{if(i)throw i.error}}var U=Object(ye.getViewXml)({itemRefs:c,recurseInFolders:!0,pageSize:1,fieldNames:p});return{webAbsoluteUrl:"",listFullUrl:u,currentPageContext:void 0,qosName:r,viewXml:U,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}}(a,void 0,"getSPItemByFullUrl")),[4,e(Object(be.a)(s))];case 1:return c=U.sent(),u=fe.c(decodeURIComponent(c.HttpRoot||""))||o.authority,d=new ue.SimpleUri(u).authority+decodeURIComponent(c.listUrlDir||""),p={webAbsoluteUrl:u,listFullUrl:"",rootFolder:""},f=e(Object(ve.a)({serverData:c,itemSetKey:p,currentPageContext:s.currentPageContext,contentTypes:void 0,isItemSetRequest:!1})),b=f.itemResolver,v=f.childKeys,y=f.pageContext,h=n.__read(v,1),(F=h[0])&&l.mapKeys({mappings:(t={},t[F]=m.spItemFullUrlKeyFacet.serialize(a),t)}),y&&(g=m.spPageContextKeyFacet.serialize({webAbsoluteUrl:u,listFullUrl:d}),e(Object(me.a)({itemKey:g,options:{pageContext:y}}))),l.merge(b),m.spItemKeyFacet.matches(F)&&l.merge(e(Object(ge.a)({parentKey:m.spItemKeyFacet.deserialize(F),serverData:c})).itemResolver),w=m.spListKeyFacet.serialize({webAbsoluteUrl:u,listFullUrl:d}),l.resolveItems({items:(i={},i[m.spItemKeyFacet.serialize(p)]=n.__assign({},P.defaultChildItemSetFacet.pack({itemKey:m.spFolderItemSetKeyFacet.serialize(p)})),i[r]=n.__assign({},de.d.pack(m.spItemKeyFacet)),i[w]=n.__assign({},Object(pe.a)(c,y)),i)}),e(l.execute()),[2]}})})}}!function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter",e[e.saveColumnFormatter=1]="saveColumnFormatter",e[e.previewViewFormatter=2]="previewViewFormatter",e[e.saveViewFormatter=3]="saveViewFormatter"}(se||(se={}));var Ie=new y.Facet("updateFormatter"),_e=(Object(j.f)({operationTypeFacet:Ie}),r("3752b592d50f9c3fa6b5")),Se=r("e45a813de720285432ba"),Oe=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.formatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d;return n.__generator(this,function(m){switch(m.label){case 0:return l=n.__read(Object.keys(r),1),o=l[0],s=r[o],c=s.updateType,u=s.formatter,0!==c?[3,1]:[2,e(Object(k.resolveItems)({items:(a={},a[o]=n.__assign({},D.customFormatterFacet.pack(u)),a)}))];case 1:return 2!==c?[3,3]:(d=Object(_e.b)(u),[4,e(Object(ae.a)(function(e){e.demandItemFacet(Se.a,Se.b.serialize({}))}))]);case 2:return m.sent(),[2,e(Object(k.resolveItems)({items:(i={},i[t]=n.__assign({},D.viewFormatterFacet.pack(d)),i)}))];case 3:return[2]}})})}}),Ae=new y.Facet("modifyFieldProperties"),Ke=(Object(j.f)({operationTypeFacet:Ae}),r("08bf0219777f111bb2c9")),Te=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.fields;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f;return n.__generator(this,function(b){return a=n.__read(Object.keys(r),1),i=a[0],l=r[i],o=l.displayName,s=l.fieldDescription,c=l.showInFiltersPane,(u=e(Object(he.a)({setKey:m.spFolderItemSetKeyFacet},t)).setKey)&&i&&(d=e(Object(he.a)({id:D.fieldIdFacet},i)).id)?(p={__metadata:{type:"SP.Field"},Title:o,SchemaXml:s,ShowInFiltersPane:c},f=Object(E.a)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}).method("Fields",d).toString(),[2,e(Object(N.c)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,url:f,qosName:"modifyFieldProperties",body:JSON.stringify(p),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(k.resolveItems)({items:(t={},t[i]=n.__assign({},void 0!==c?Ke.b.pack(c):{},void 0!==o?x.displayNameFacet.pack(o):{}),t)}))})]):[2]})})}}),je=r("dea1b9d7d476fd78f2d7"),Ce=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spItemGroupKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s,c,u;return n.__generator(this,function(d){switch(d.label){case 0:return i=e(function(e){return function(t){var r=e.itemSetKey,a="";r.viewKey?a=r.viewKey.viewId:e.viewKey&&(a=e.viewKey.viewId);var n=r,i=t(Object(he.a)({pageContext:D.spPageContextFacet},m.spPageContextKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}))),l=t(Object(he.a)({groupString:D.groupStringFacet},m.spItemGroupKeyFacet.serialize(e)));return{webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,currentPageContext:i&&i.pageContext,qosName:"getSPItemGroup",rootFolder:n.rootFolder,groupString:l&&l.groupString,viewId:a,filterParams:r&&r.filterParams,sortField:r&&r.sortFieldKey,sortDir:r&&void 0===r.sortAscending?void 0:r&&r.sortAscending?"Asc":"Desc",postDataContext:{needsSchema:!0}}}}(a)),[4,e(Object(be.a)(i))];case 1:return l=d.sent(),o=e(Object(je.c)({itemSetKey:a.itemSetKey})),s=e(Object(ve.a)({serverData:l,itemSetKey:a.itemSetKey,currentPageContext:i.currentPageContext,contentTypes:o,parentGroupKey:r,isItemSetRequest:!0})),c=s.itemResolver,u=s.childKeys,c.resolveItems({items:(t={},t[r]=n.__assign({},u.length>0?P.childItemsFacet.pack({itemKeys:u}):{}),t)}),e(c.execute()),[2]}})})}});var ke=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spNeedsAttentionItemKeyFacet.deserialize(r),i={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,rootFolder:"",viewKey:{viewId:m.needsAttentionViewId}};return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,l;return n.__generator(this,function(n){switch(n.label){case 0:return t=e(Object(je.c)({itemSetKey:i})),[4,e(Object(je.b)({itemSetKey:i,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:a=n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,e(Object(be.a)(a))];case 3:return l=n.sent(),[4,e(xe(l,r))];case 4:return n.sent(),[3,7];case 5:return n.sent(),[4,e(xe(void 0,r))];case 6:return n.sent(),[3,7];case 7:return[2]}})})}});function xe(e,t){var r=this;return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,i,l,o;return n.__generator(this,function(s){return i=!1,(l=e&&e.ListData&&e.ListData.Row)&&l.length>0&&l[0]&&(i=!0),(o=new G.a).resolveItems({items:(r={},r[t]=n.__assign({},x.missingMetadataFacet.pack(i)),r)}),a(o.execute()),[2]})})}}var Pe,De=r("5abe0a4e18e69c009f41"),Ne=r("ba9b9c401d4d91d63e29");function Re(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.fieldInternalName,n=e.viewId,i=e.rootFolder,l=e.excludeFieldFilteringHtml,o=e.filterParams,s=Object(E.a)({webAbsoluteUrl:t,listFullUrl:r}).segment("RenderListFilterData").parameter("FieldInternalName",a||"");if(n&&(s=s.parameter("ViewId",n)),i&&(s=s.parameter("RootFolder",{raw:Object(De.encodeURIComponent)(i)})),l&&(s=s.parameter("ExcludeFieldFilteringHtml",!0)),o){var c=Ne.a.getFilterParams(o,!0);s=s.rawParameter(c)}return s.toString()}!function(e){e.getFilterData=function(e,t,a){var n=[];e=e.split("<br>")[0];var i=document.createElement("DIV");i.innerHTML=e;var l=i.querySelector("#diidFilter"+t);if(null!=l)for(var o=l.childNodes.length,s=l.childNodes,c=1;c<o;c++){var u=Ne.a.getText(s[c]),d=s[c].value.toString(),m={display:u,value:d};if(a){var p=r(d);p.filterType&&(m.value=p.value,m.calculatedFieldOriginFilterValue=d,m.calculatedFieldFilterType=p.filterType,n.push(m))}else n.push(m)}for(var f={},b=0,v=n;b<v.length;b++)(F=v[b]).display in f?f[F.display]++:f[F.display]=1;for(var y=0,h=n;y<h.length;y++){var F;f[(F=h[y]).display]>1&&(F.display=F.value)}return n};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function r(e){var r=e.indexOf("_"),a=e,n=void 0;if(r>0){a=e.substring(r+1);var i=Number(e.substring(0,r));!isNaN(i)&&i<t.length&&(n=t[i])}return{value:a,filterType:n}}e.getCalculatedFieldFilterValueAndType=r}(Pe||(Pe={}));var Ee=Pe,Le=r("291bfd7ca3e0ca52b70d"),ze=r("3d240143e32215cc23a5"),Ve=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spFilterOptionSetKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s;return n.__generator(this,function(c){switch(c.label){case 0:return i=e(function(e){var t=e.itemSetKey,r=e.fieldKey;return function(e){var a=e(Object(ze.a)({spDataSourceConfiguration:D.spDataSourceConfigurationFacet})).spDataSourceConfiguration,n=a&&a.ensureAuthToken,i=m.spItemKeyFacet.serialize(t),l=e(Object(he.a)({folderPath:D.folderPathFacet},i)),o=e(Object(he.a)({internalName:D.internalNameFacet,mappedColumnFieldType:D.mappedColumnFieldTypeFacet},m.spFieldKeyFacet.serialize(r))),s=l&&l.folderPath,c=o&&o.internalName&&o.internalName,u=o&&o.mappedColumnFieldType===Le.a.Taxonomy;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:s,ensureAuthToken:n,fieldInternalName:c,filterParams:t.filterParams,excludeFieldFilteringHtml:u,viewId:t.viewKey&&t.viewKey.viewId}}}({itemSetKey:a.itemSetKey,fieldKey:a.fieldKey})),[4,e((u=i,function(e){return e(Object(N.c)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,method:"POST",url:Re(u),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:return l=c.sent(),o=Ee.getFilterData(l,i.fieldInternalName||""),(s=new G.a).resolveItems({items:(t={},t[r]=n.__assign({},D.filterOptionSetFacet.pack(o)),t)}),e(s.execute()),[2]}var u})})}});var qe=r("d27387ede93a2620cbf6"),Me=r("3da5d317c00adfe8f79c"),Be=r("a9dd204dd0bee7467912"),Ge=-2147023080,We=-2130575282,He=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.folders;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v;return n.__generator(this,function(y){switch(y.label){case 0:return l=n.__read(Object.keys(r),1),o=l[0],s=m.spItemKeyFacet.deserialize(t),c=s.rootFolder||new ue.SimpleUri(s.listFullUrl).path,u=m.spListKeyFacet.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),d=e(Object(he.a)({list:D.listFacet},u)),p=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.parentFolderPath,n=e.isDocLib,i=void 0===n||n,l=e.needItemDetails,o=void 0!==l&&l,s=e.folderName,c=Object(E.c)({webAbsoluteUrl:t,listOrItemFullUrl:r});i?(c=(c=c.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:a+"/"+s,overwrite:!1}),o&&(c=c.oDataParameter("$Expand","ListItemAllFields"))):c=c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:s||"Folder"+(Math.floor(100*Math.random())+1)});return c.toString()}({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,parentFolderPath:c,isDocLib:!!d&&!!d.list&&d.list.isDocumentLibrary,folderName:o,needItemDetails:!1}),[4,e(Object(N.c)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,url:p,method:"POST",qosName:"createFolder"})).catch(function(e){if(e instanceof N.a&&e.message&&c){var t=c;"/"===t[0]&&(t=t.substr(1)),"/"!==t[t.length-1]&&(t+="/"),e.message=e.message.replace(t,"")}throw new j.a({innerError:e,facets:Je(e)})})];case 1:return y.sent(),(f=r[o].progressItemKey)&&(b=c+"/"+o,v=m.spItemKeyFacet.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,rootFolder:b}),e(Object(k.resolveItems)({items:(a={},a[f]=n.__assign({},Me.f.pack({itemKey:v})),a[v]=n.__assign({},D.folderPathFacet.pack(b)),a)}))),e(Object(qe.b)({items:(i={},i[t]=[P.defaultChildItemSetFacet],i)})),[2]}})})}});function Je(e){if(e instanceof N.a)switch(function(e){var t=e.errorData.code,r=void 0===t?"":t;return n.__read(r.split(",").map(function(e){return Number(e)}),1)[0]}(e)){case Ge:case We:return Be.j.pack({})}}var Qe=r("06bd4399cef6e6b5593c"),Xe=r("cdb9a7d2db44c7a9f4dd"),$e=r("c0ec8ed08a9b4b107886"),Ze=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new $e.ApiUrlHelperBasic({webAbsoluteUrl:!e&&t?new R.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var r={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),n=Number(a[0]),i=e.message.value;r.error={code:n,message:i}}return{items:[r]}},e.getBatchResponseText=function(e){var t,r,a,n=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){r=(e=e.replace(t.trim()+"--","")).split(t);for(var i=1;i<r.length;i++)(a=r[i].split("\n\r")).length>2&&n.push(a[2])}return n},e.processBatchResponse=function(e,t,r){var a,n,i,l,o=[],s=!1;if(e.split("\n").length>0&&(a=e.split("\n")[0]),a){n=(e=e.replace(a.trim()+"--","")).split(a);for(var c=1;c<n.length;c++)if((i=n[c].split("\n\r")).length>2){try{l=JSON.parse(i[2])}catch(e){l=i[2]}var u=t&&t[c-1],d=u?{key:u.key,id:u.id,newId:r?r+"/"+u.name:null}:{};if((l=l.error?l.error:l)&&l.code){var m=l.code?l.code.split(","):l.error.code.split(","),p=Number(m[0]),f=l.message.value;d.error={code:p,message:f},s=!0}o.push(d)}}return{items:o,hasError:s}},e.getBatchContent=function(e,t,r,a){for(var n=[],i=0;i<t.length;i++){for(var l=t[i],o=Xe.default.generate(),s=[],c=0;c<l.length;c++){var u=l[c];s.push("--changeset_"+o),s.push("Content-Type: application/http"),s.push("Content-Transfer-Encoding: binary"),s.push(""),s.push(r+" "+u+" HTTP/1.1"),s.push(a),s.push("")}s.push("--changeset_"+o+"--");var d=s.join("\r\n");n.push("--batch_"+e),n.push('Content-Type: multipart/mixed; boundary="changeset_'+o+'"'),n.push("Content-Length: "+d.length),n.push("Content-Transfer-Encoding: binary"),n.push(""),n.push(d),n.push("")}return n.push("--batch_"+e+"--"),n.join("\r\n")},e.getBatchContentExtended=function(e,t,r,a,n,i){var l=Xe.default.generate(),o=[];n&&n.length!==t.length&&(n=null);for(var s=0;s<t.length;s++){var c=t[s];o.push("--changeset_"+l),o.push("Content-Type: application/http"),o.push("Content-Transfer-Encoding: binary"),o.push(""),o.push(r+" "+c+" HTTP/1.1"),o.push(a),i&&o.push(i),n&&(o.push(""),o.push(n[s])),o.push("")}o.push("--changeset_"+l+"--");var u=o.join("\r\n");return(o=[]).push("--batch_"+e),o.push('Content-Type: multipart/mixed; boundary="changeset_'+l+'"'),o.push("Content-Length: "+u.length),o.push("Content-Transfer-Encoding: binary"),o.push(""),o.push(u),o.push(""),o.push("--batch_"+e+"--"),o.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}(),Ye=Ze,et=Object(i.c)()(function(e){var t=e.items;return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var a,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,U,I;return n.__generator(this,function(_){switch(_.label){case 0:o=void 0,s=void 0;try{for(c=n.__values(Object.keys(t)),u=c.next();!u.done;u=c.next())d=u.value,p=r(Object(he.a)({key:m.spItemKeyFacet,folderPath:D.folderPathFacet},d)),f=e.items[d],p&&p.key&&p.folderPath&&(o||(s=p.key.listFullUrl,o={webAbsoluteUrl:p.key.webAbsoluteUrl,items:[],checkInOutType:f.checkInOutType,checkInText:f.checkInText},s=p.key.listFullUrl),o.items.push({key:d,itemFullUrl:p.folderPath}))}catch(e){a={error:e}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(a)throw a.error}}return(b=o)&&b.items.length?(v=b.items.length>1,y=r(Object(L.a)({name:v?"batchCheckoutItem":"checkoutItem"})),h=void 0,h=1===b.checkInOutType?v?"batchCheckInItems":"CheckInItem":0===b.checkInOutType?v?"batchCheckOutItems":"CheckOutItem":v?"batchUndoCheckOutItems":"UndoCheckOutItem",F=0===b.checkInOutType,v?[3,2]:(g=b.items[0].key,w=tt(b.webAbsoluteUrl,b.items[0].itemFullUrl,b.checkInOutType,b.checkInText),[4,r(Object(N.c)({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:s,url:w,method:"POST",qosName:h})).then(function(){var e;r(y({resultType:Qe.ResultType.success})),r(Object(k.resolveItems)({items:(e={},e[g]=n.__assign({},x.isCheckedOutFacet.pack({byYou:!!F,byOther:void 0})),e)}))},function(e){throw r(y({resultType:Qe.ResultType.failure})),e})])):[3,4];case 1:return _.sent(),[3,4];case 2:return U=Xe.default.generate(),I="multipart/mixed; boundary=batch_"+U,[4,r(Object(N.c)({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:s,url:Ye.getBatchOperationUrl(b.webAbsoluteUrl),body:rt(b,U),method:"POST",additionalHeaders:void 0,contentType:I,parseResponse:function(e){return Ye.processBatchResponse(e,b.items)},qosName:"batch"})).then(function(e){var t,a,l,o,s;if(e.hasError){var c={items:{}};try{for(var u=n.__values(e.items),d=u.next();!d.done;d=u.next()){var m=d.value;m.error&&m.key&&(c.items[m.key]=new j.a({message:m.error.message}))}}catch(e){o={error:e}}finally{try{d&&!d.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}throw new i.a(c)}r(y({resultType:Qe.ResultType.success}));var p=new G.a;try{for(var f=n.__values(b.items),v=f.next();!v.done;v=f.next()){var h=v.value;p.resolveItems({items:(l={},l[h.key]=n.__assign({},x.isCheckedOutFacet.pack({byYou:!!F,byOther:void 0})),l)})}}catch(e){t={error:e}}finally{try{v&&!v.done&&(a=f.return)&&a.call(f)}finally{if(t)throw t.error}}r(p.execute())},function(e){throw r(y({resultType:Qe.ResultType.failure})),e})];case 3:_.sent(),_.label=4;case 4:return[2]}})})}});function tt(e,t,r,a){var n;n=1===r?"CheckIn":2===r?"UndoCheckOut":"CheckOut";var i=Object(E.c)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=1===r?i.methodWithAliases("CheckIn",{comment:a,checkintype:0}):i.segment(n)).toString()}function rt(e,t){var r=e.items,a=Ye.defaultBatchRequestPostData,n=r.map(function(t){return tt(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText)});return Ye.getBatchContentExtended(t,n,"POST",a)}function at(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r(Object(ae.a)(function(t){return t.demandItem({spItemKey:m.spItemKeyFacet,listItemId:D.listItemIdFacet},e)}))];case 1:if(t=n.sent(),a=t.spItemKey,i=t.listItemId,!(l=a||(m.spItemKeyFacet.matches(e)?m.spItemKeyFacet.deserialize(e):void 0)))throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(o=i||l.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:l,itemId:o}]}})})}}var nt,it=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(at(t))];case 1:return a=n.sent(),i=a.key,l=a.itemId,o=i.webAbsoluteUrl,s=i.listFullUrl,c=m.spListKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s}),(u=e(Object(ie.a)(function(e){return e.demandItemFacet(D.listFacet,c)})))&&u.id&&l?(d=e(Object(L.a)({name:"updateRating"})),[4,e(Object(N.c)({webAbsoluteUrl:o,listFullUrl:s,url:Object(E.b)({webAbsoluteUrl:o}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:u.id,itemID:l,rating:r.userNewRating}).toString(),method:"POST",qosName:"updateRating"})).then(function(){var r;e(d({resultType:Qe.ResultType.success})),e(Object(qe.b)({items:(r={},r[t]=[x.displayNameFacet],r)}))},function(t){throw e(d({resultType:Qe.ResultType.failure})),t})]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}}),lt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(at(t))];case 1:return a=n.sent(),i=a.key,l=a.itemId,o=i.webAbsoluteUrl,s=i.listFullUrl,c=m.spListKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s}),(u=e(Object(ie.a)(function(e){return e.demandItemFacet(D.listFacet,c)})))&&u.id&&l?(d=e(Object(L.a)({name:"updateLikes"})),[4,e(Object(N.c)({webAbsoluteUrl:o,listFullUrl:s,url:Object(E.b)({webAbsoluteUrl:o}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:u.id,itemID:l,like:r.liked}).toString(),method:"POST",qosName:"updateLikes"})).then(function(){var r;e(d({resultType:Qe.ResultType.success})),e(Object(qe.b)({items:(r={},r[t]=[x.displayNameFacet],r)}))},function(t){throw e(d({resultType:Qe.ResultType.failure})),t})]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}});!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(nt||(nt={}));var ot=nt,st=r("2852e19dad7ee30e33c6"),ct=Object(i.c)()(function(e){var t=e.items;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,U,I,_,S,O,A;return n.__generator(this,function(K){switch(K.label){case 0:u=void 0,d=void 0,p=void 0,f=function(t){var r=e(Object(ie.a)(function(e){return e.demandItem({key:m.spItemKeyFacet,folder:x.folderFacet,uniqueId:D.uniqueIdFacet,folderPath:D.folderPathFacet,oneNote:st.b,itemId:D.listItemIdFacet},t)}));if(r&&r.key&&r.folderPath){if(d=r.key.webAbsoluteUrl,p=r.key.listFullUrl,!u){var a=m.spListKeyFacet.serialize({webAbsoluteUrl:d,listFullUrl:p}),n=e(Object(ie.a)(function(e){return e.demandItemFacet(D.listFacet,a)}));u={webAbsoluteUrl:d,listFullUrl:p,items:[],deletionType:ot.Recycle,listId:n&&n.id}}u.items.push({key:t,serverRelativeItemUrl:r.folderPath,id:r.itemId,uniqueId:r.uniqueId,isFolder:!!r.folder||!!r.oneNote})}};try{for(b=n.__values(Object.keys(t)),v=b.next();!v.done;v=b.next())y=v.value,f(y)}catch(e){r={error:e}}finally{try{v&&!v.done&&(a=b.return)&&a.call(b)}finally{if(r)throw r.error}}return(h=u)&&h.items.length?1!==h.items.length?[3,2]:(F=h.items[0],g=ut({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,deletionType:h.deletionType,listId:h.listId,serverRelativeItemUrl:F.serverRelativeItemUrl,uniqueId:F.uniqueId,isFolder:!!F.isFolder,itemId:F.id}),w=e(Object(L.a)({name:"deleteItem"})),[4,e(Object(N.c)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:p||"",url:g,body:void 0,method:"POST",additionalHeaders:h.deletionType===ot.PermanantDelete?{"X-HTTP-Method":"DELETE"}:void 0,qosName:"deleteSingleItem"})).then(function(){e(w({resultType:Qe.ResultType.success}))},function(t){if(t.errorData.status===j.b)throw e(w({resultType:Qe.ResultType.expectedFailure})),new j.a({facets:n.__assign({},Be.i.pack({}))});throw e(w({resultType:Qe.ResultType.failure})),t})]):[3,5];case 1:return K.sent(),[3,4];case 2:return h.items.length>1?(U=Xe.default.generate(),I="multipart/mixed; boundary=batch_"+U,[4,e(Object(N.c)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:p||"",url:Ze.getBatchOperationUrl(h.webAbsoluteUrl),body:dt(h,U),method:"POST",additionalHeaders:void 0,contentType:I,parseResponse:function(e){return Ze.processBatchResponse(e,h.items)},qosName:"deleteMultipleItems"})).then(function(e){var t,r;if(e.hasError){var a={items:{}};try{for(var l=n.__values(e.items),o=l.next();!o.done;o=l.next()){var s=o.value;s.error&&s.key&&(a.items[s.key]=new j.a({message:s.error.message}))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}throw new i.a(a)}return Promise.resolve({data:e})})]):[3,4];case 3:K.sent(),K.label=4;case 4:_=new G.a;try{for(S=n.__values(h.items),O=S.next();!O.done;O=S.next())A=O.value,_.invalidateItems({items:(s={},s[A.key]=[x.deletedFacet],s)}),_.resolveItems({items:(c={},c[A.key]=x.deletedFacet.pack({}),c)})}catch(e){l={error:e}}finally{try{O&&!O.done&&(o=S.return)&&o.call(S)}finally{if(l)throw l.error}}e(_.execute()),K.label=5;case 5:return[2]}})})}});function ut(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.serverRelativeItemUrl,n=e.deletionType,i=e.uniqueId,l=e.isFolder,o=e.listId,s=e.itemId,c=Object(E.c)({webAbsoluteUrl:t,listOrItemFullUrl:r});return c=l?i?c.method("GetFolderById",i):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}):o&&s?c.method("Lists",o).method("GetItemById",s):c.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a}),n===ot.Recycle&&(c=c.segment("recycle")),c.toString()}function dt(e,t){var r=e.items,a=e.deletionType===ot.PermanantDelete?"DELETE":"POST",n=e.deletionType===ot.PermanantDelete?"If-Match: *":Ze.defaultBatchRequestPostData,i=r.map(function(t){return ut({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.itemId})});return Ze.getBatchContentExtended(t,i,a,n)}var mt=r("ec569ac9f2e5cb113534"),pt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.names;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,U,I,_,S,O,A;return n.__generator(this,function(K){switch(K.label){case 0:if(l=n.__read(Object.keys(r),1),o=l[0],s=r[o].newName,c=e(Object(ie.a)(function(e){return e.demandItem({existingFileName:x.fileNameFacet,spItemKey:m.spItemKeyFacet,listItemId:D.listItemIdFacet},t)})),u=c.existingFileName,d=c.spItemKey,p=c.listItemId,f=d||m.spItemKeyFacet.deserialize(t),!(b=p||f.itemId))throw new Error("Cannot find itemId for itemKey: "+t);return v=f.rootFolder||new ue.SimpleUri(f.listFullUrl).path,y=new Y.a({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}),h=y.getUrlParts({path:v}),F=y.getUrlParts({path:f.webAbsoluteUrl}),g=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(E.a)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).toString()}({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,itemId:b}),w={},(U=F.serverRelativeItemUrl)?[3,2]:[4,e(Object(N.c)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:(T={webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl},C=T.webAbsoluteUrl,P=T.listFullUrl,R=Object(E.a)({webAbsoluteUrl:C,listFullUrl:P}).segment("ParentWeb").segment("ServerRelativeUrl"),R.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){U=e.d.ServerRelativeUrl})];case 1:K.sent(),K.label=2;case 2:return!U&&h.serverRelativeListUrl&&((I=h.serverRelativeListUrl.indexOf("/lists/"))<0&&(I=h.serverRelativeListUrl.lastIndexOf("/")),I>=0&&(U=h.serverRelativeListUrl.substring(0,I))),(_=h.serverRelativeListUrl)&&(w.__metadata={type:Object(mt.b)(_,U)}),S=u&&u.extension?s+u.extension:s,w.FileLeafRef=S,(O={})["X-HTTP-Method"]="MERGE",O["If-Match"]="*",A=e(Object(L.a)({name:"renameItem"})),[4,e(Object(N.c)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:g,method:"POST",body:JSON.stringify(w),additionalHeaders:O,qosName:"renameItem"})).then(function(){e(A({resultType:Qe.ResultType.success}))},function(t){if(t.errorData.status===j.b)throw e(A({resultType:Qe.ResultType.expectedFailure})),new j.a({facets:n.__assign({},Be.i.pack({}))});throw t.errorData.code&&t.errorData.code.indexOf("-2130575257")>-1?e(A({resultType:Qe.ResultType.expectedFailure})):e(A({resultType:Qe.ResultType.failure})),t})];case 3:return K.sent(),e(Object(qe.b)({items:(a={},a[t]=[x.displayNameFacet],a)})),e(Object(k.resolveItems)({items:(i={},i[t]=n.__assign({},x.displayNameFacet.pack(u&&u.extension?s+u.extension:s),x.fileNameFacet.pack({name:s,extension:u&&u.extension||""})),i)})),[2]}var T,C,P,R})})}});var ft=r("3c88ca8e24c9c99ad593"),bt=r("4986dedaa57d766e48bb")._dyjnt3SdKkvQeou8Lavmyg,vt=r("cfef2ab49d0d7bc1e869"),yt=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({key:m.spItemKeyFacet,permissions:D.permissionsFacet,isCheckedOut:x.isCheckedOutFacet,rowData:D.rowDataFacet},r),i=a.key,l=a.permissions,o=a.isCheckedOut,s=a.rowData,c=i&&e.demandItemFacet(D.spPageContextFacet,m.spPageContextKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})),u=!(!c||c.isAnonymousGuestUser||!ft.a.hasItemPermission({permissions:l},ft.a.editListItems)||!ft.a.hasItemPermission({permissions:l},ft.a.deleteListItems)),d=s&&c&&o&&!!o.byOther,p=vt.a;return!c||c.supportPoundStorePath&&c.supportPercentStorePath||(p=vt.b),n.__assign({isAvailable:u,validator:p},d?{lockedWarningMessage:bt.FileCheckedoutOrLockedWarning,title:bt.FileCheckedoutOrLockedWarningTitle}:{})}}});var ht=r("5f37f5ec04a007134c18"),Ft=r("1adfad17f632aad72441"),gt=r("9ba97cc998d0be4df04a"),wt=r("1bdba4333337067e8d37"),Ut=r("90e9dbb8f74ee9c49c51"),It=r("a3886a89b418632a97c5"),_t=r("6631b0451e9f577f414d"),St=new y.Facet("updateItem"),Ot=Object(j.f)({operationTypeFacet:St}),At=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.documentType,i=r.fileName,l=r.newDocumentKey,o=r.templateItemKey,s=r.targetWindow;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,c,u,d,p,f,b,v,y,h,F,g,w,U,I,_,S,O;return n.__generator(this,function(A){switch(A.label){case 0:return c=m.spItemKeyFacet.deserialize(t),u=c.rootFolder||new ue.SimpleUri(c.listFullUrl).path,d=new Y.a({context:{webAbsoluteUrl:c.webAbsoluteUrl,listUrl:c.listFullUrl}}),p=d.getUrlParts({path:u}),f=new _t.a(null),b=e(Object(he.a)({createDocumentFormDigest:D.spCreateDocumentFormDigestFacet},ne.configurationItemKey)).createDocumentFormDigest,v=void 0,(y=e(Object(he.a)({pageContext:D.spPageContextForDataRequestorFacet},m.spPageContextForDataRequestorKeyFacet.serialize({webAbsoluteUrl:c.webAbsoluteUrl}))))&&y.pageContext&&(v=y.pageContext),h=new ue.SimpleUri(c.webAbsoluteUrl).authority,F=new ue.SimpleUri(v&&v.webAbsoluteUrl).authority,g=h!==F,o||!b||g||a!==Ft.a.Word&&a!==Ft.a.PowerPoint&&a!==Ft.a.Bohemia&&a!==Ft.a.Prague?[3,2]:("_layouts/15",w=a===Ft.a.Prague?"prague":"doc",U=c.webAbsoluteUrl+"/_layouts/15/"+w+".aspx",[4,It.createDocumentByDocAspxWithItemUrlParts(a,U,c.webAbsoluteUrl,f,s,i,p)]);case 1:return A.sent(),e(Object(qe.b)({items:(r={},r[t]=[P.defaultChildItemSetFacet],r)})),[3,4];case 2:return I="",m.spNewDocumentTemplateKeyFacet.matches(o)&&((S=e(Object(he.a)({documentTemplate:D.newDocumentTemplateFacet},o)).documentTemplate)&&S.url?(_=S,I=S.url):I=m.spNewDocumentTemplateKeyFacet.deserialize(o).templateUrl),O=function(e){var t=Ft.a.Visio,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.parentFolderPath,i=e.templateUrl,l=e.docName,o=e.docType;if(null!==o&&o>=Ft.a.Word&&o<=t&&o!==Ft.a.Text){if(o!==Ft.a.OneNote||l){if(l){var s=Object(Ut.getDocExtension)(o);l+=s}}else l="Notebook"+Math.floor(100*Math.random())+1;l||(l=""),o===Ft.a.ExcelForm&&(o=Ft.a.ExcelSurvey);var c=Object(E.a)({webAbsoluteUrl:r,listFullUrl:a}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:l,folderPath:n,documentTemplateType:o,templateUrl:i||""});return c.toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,parentFolderPath:p.listRelativeItemUrl||"",docType:a,docName:i,templateUrl:I}),[4,e(Object(N.c)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:O,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0})).then(function(r){var o,s,u=function(e){var t=e.responseText,r=e.documentType,a=e.fileName,n="",i="";if(null!=t){var l=JSON.parse(t);if(null!==l&&null!==l.d&&null!==l.d.CreateDocumentAndGetEditLink)i=l.d.CreateDocumentAndGetEditLink,n=Object(ht.b)(i,r,a||"",!1);else try{var o=new DOMParser,s=o.parseFromString(t,"text/xml");i=s.getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"",n=Object(ht.b)(i,r,a||"",!1)}catch(e){}}return{originalEditLink:i,redirectUrl:n}}({responseText:r,documentType:a,fileName:i}),d=u.redirectUrl,m=u.originalEditLink;if(m){var p=gt.deserializeQuery(gt.getQueryStringFromUrl(m.toLowerCase())).sourcedoc,f=p&&Object(wt.normalizeLower)(p),b=Object(Ut.getDocExtension)(a),v=_;if(v&&v.url){var y=function(e){var t=e.listFullUrl,r=e.uniqueId,a=e.webAbsoluteUrl;return Object(E.a)({webAbsoluteUrl:a,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:r}).toString()}({listFullUrl:c.listFullUrl,webAbsoluteUrl:c.webAbsoluteUrl,uniqueId:f});e(Object(N.c)({listFullUrl:c.listFullUrl,webAbsoluteUrl:c.webAbsoluteUrl,url:y,method:"POST",parseResponse:Kt,qosName:"getItemByUniqueId",noRedirect:!0})).then(function(r){var a;r&&e(Ot({items:(a={},a[t]={formValues:[{FieldName:"ContentTypeId",FieldValue:v.contentTypeId||""}],qosName:"updateTemplateDocContentType"},a)}))})}e(Object(k.resolveItems)({items:(o={},o[l]=n.__assign({},d?x.openUrlFacet.pack(d):{},x.fileNameFacet.pack({name:i||"",extension:b}),f?D.uniqueIdFacet.pack(f):{},st.b.pack(a===Ft.a.OneNote?{}:void 0),P.parentItemFacet.pack({itemKey:t})),o)}))}e(Object(qe.b)({items:(s={},s[t]=[P.defaultChildItemSetFacet],s)}))})];case 3:A.sent(),A.label=4;case 4:return[2]}})})}});function Kt(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}var Tt,jt,Ct=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=e.options,i=a.newDocumentKey,l=a.extension;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,o,s,c;return n.__generator(this,function(u){switch(u.label){case 0:return t=m.spItemKeyFacet.deserialize(r),a=t.rootFolder||new ue.SimpleUri(t.listFullUrl).path,o=new Y.a({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}}),s=o.getUrlParts({path:a}),c=s.fullItemUrl,[4,e(Object(N.c)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:kt({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:s.listRelativeItemUrl||"",extension:l}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var a,l,o=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!o)throw"Fail to create custom document";var s=c+"/"+o;e(Object(k.resolveItems)({items:(a={},a[i]=n.__assign({},x.displayNameFacet.pack(o),x.canonicalUrlFacet.pack(s)),a)})),e(Object(qe.b)({items:(l={},l[r]=[P.defaultChildItemSetFacet],l)}))})];case 1:return u.sent(),[2]}})})}});function kt(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.extension,n=e.parentFolderPath;if(!a)throw new Error("document extension is not valid");return Object(E.a)({webAbsoluteUrl:t,listFullUrl:r}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:n,extension:a}).toString()}!function(e){e[e.pin=0]="pin",e[e.unpin=1]="unpin",e[e.movePrevious=2]="movePrevious",e[e.moveNext=3]="moveNext"}(Tt||(Tt={})),function(e){e[e.success=0]="success",e[e.folderDoesNotExist=1]="folderDoesNotExist",e[e.itemDoesNotExist=2]="itemDoesNotExist",e[e.tooManyItems=3]="tooManyItems",e[e.itemNotInSpotlight=4]="itemNotInSpotlight",e[e.invalidArgument=5]="invalidArgument",e[e.serverError=6]="serverError",e[e.invalidServerJSON=7]="invalidServerJSON",e[e.unknownServerResult=8]="unknownServerResult"}(jt||(jt={}));var xt=r("655c29c4569d728dbf1e"),Pt=r("638c4a826f3cd38b4e52"),Dt=function(e){function t(t){void 0===t&&(t={});var r=e.call(this,t)||this,a=t.resultType,n=void 0===a?8:a;return r.resultType=n,r}return n.__extends(t,e),t}(xt.CustomError),Nt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.itemEditTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,U,I,_,S,O,A;return n.__generator(this,function(K){switch(K.label){case 0:return l=n.__read(Object.keys(r),1),o=l[0],s=r[o].editType,[4,e(at(o))];case 1:if(c=K.sent(),u=c.key,d=c.itemId,p=e(Object(ie.a)(function(e){return e.demandItem({deserializedPinnedItemSetKey:m.spPinnedItemSetKeyFacet,pinnedItems:P.childItemsFacet},t)})),f=p.deserializedPinnedItemSetKey,b=p.pinnedItems,f||(f=m.spPinnedItemSetKeyFacet.deserialize(t)),!u||!f||!d)throw new Dt({resultType:5});return u&&f&&d?(v="","",f.viewKey&&(v=f.viewKey.viewId),y=f.parentItemKey.rootFolder||new ue.SimpleUri(f.parentItemKey.listFullUrl).path,h=void 0,(F=b&&b.itemKeys||[])&&(g=F.indexOf(o))>-1&&(2===s&&g>=2?h=F[g-2]:3===s&&g<F.length-1&&(h=F[g+1])),w=void 0,h&&(w=e(Object(ie.a)(function(e){return e.demandItemFacet(D.listItemIdFacet,h)}))),U={webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,itemId:d,editType:s,viewId:v,rootFolder:y,afterItemId:w},t&&(I=function(e,t,r,a){var i,l,o=a.editType,s=[];(0===o||void 0===r&&1!==o)&&s.push(e);try{for(var c=n.__values(t),u=c.next();!u.done;u=c.next()){var d=u.value;d!==e&&s.push(d),d===r&&s.push(e)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(i)throw i.error}}return s}(o,F,h,U)).length<=3&&e(Object(k.resolveItems)({items:n.__assign((a={},a[t]=n.__assign({},P.childItemsFacet.pack({itemKeys:I})),a),Object(Pt.a)(I,function(){return n.__assign({},Object(qe.a)().forFacet(x.deletedFacet).thenInvalidate(t,P.childItemsFacet).pack())}))})),(_=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.viewId,n=e.editType,i=e.itemId,l=e.afterItemId,o=e.rootFolder,s=Object(E.a)({webAbsoluteUrl:t,listFullUrl:r});if(a&&(s=s.methodWithAliases("GetView",{viewGuid:a})),1!==n){var c=l?parseInt(l,10):-1;isNaN(c)&&(c=-1),s=s.methodWithAliases("AddToSpotlight",{itemId:i,folderPath:o||"",afterItemId:c})}else s=s.methodWithAliases("RemoveFromSpotlight",{itemId:i,folderPath:o||""});return s.toString()}(U))?[4,e(Object(N.c)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,url:_,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3]):[3,3];case 2:if(S=K.sent(),0!==(O=function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}}(S)).resultType)throw A=function(e,t){var r,a,i=[];if(e.order)try{for(var l=n.__values(e.order),o=l.next();!o.done;o=l.next()){var s=o.value;i.push(m.spItemKeyFacet.serialize(n.__assign({},t,{itemId:s.toString()})))}}catch(e){r={error:e}}finally{try{o&&!o.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return i}(O,u),e(Object(k.resolveItems)({items:n.__assign((i={},i[t]=n.__assign({},P.childItemsFacet.pack({itemKeys:A})),i),Object(Pt.a)(A,function(){return n.__assign({},Object(qe.a)().forFacet(x.deletedFacet).thenInvalidate(t,P.childItemsFacet).pack())}))})),new Dt({resultType:O.resultType});K.label=3;case 3:return[2]}})})}});var Rt=r("dafd9db62310f1337c17"),Et=r("0515cc2a21866a8c8924"),Lt=(r("c4e199bc4bcd0fb7cb54"),r("973c205c4a5eb301c7ad"),r("909f685fd22f763fd12f"));var zt=r("74f05cfae7f0304885c9");function Vt(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var r=zt.a(t);if(!r)throw new Error("Filter could not be serialized");var a=qt(e,t.id);if(a){var n=void 0;try{n=Lt.i(r).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}a.parentNode.replaceChild(n,a),e.setIsDirty(!0,Et.a.filters)}else e.addFilters([r])}function qt(e,t){var r=e.getDomParts();if(r&&r.where){var a=r.where.querySelectorAll('[id="'+t+'"]');if(a.length>1)throw new Error("More than one filter found with id "+t);return a[0]}}var Mt=r("3e9477666d09125bf1bf");function Bt(e){var t=e.sourceView,r=e.deserializedItemSetKey,a=e.appliedFilters,n=new Rt.a(t.getEffectiveViewXml());if(r.sortFieldKey&&n.updateSort({fieldName:r.sortFieldKey,isAscending:r.sortAscending},{overwriteAll:!0}),r.groupByFieldKey&&n.updateGroupBy({group1:{fieldName:r.groupByFieldKey,isAscending:!0}}),a)for(var i in a){if(a.hasOwnProperty(i))Vt(n,a[i])}try{var l=Object(Mt.a)(t.id,!0);l&&(n.updateColumnWidths(l),Object(Mt.b)(t.id))}catch(e){}return n}var Gt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,U,I,_;return n.__generator(this,function(S){return a=m.spListViewsSetKeyFacet.deserialize(t),i=n.__read(Object.keys(r),1),l=i[0],o=r[l],s=o.sourceView,c=o.isPublic,u=o.itemSetKey,d=o.progressItemKey,s&&a?(p=e(Object(he.a)({deserializedItemSetKey:m.spFolderItemSetKeyFacet,filterableSet:D.spFilterableSetFacet,childItems:P.childItemsFacet,parentItem:P.parentItemFacet,schema:P.schemaFacet},u)),f=p.deserializedItemSetKey,b=p.filterableSet,v=p.childItems,y=p.parentItem,h=p.schema,(F=f?Bt({sourceView:s,deserializedItemSetKey:f,appliedFilters:b&&b.appliedFilters}):s).prepareForSaving(),g=Object(E.a)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).segment("Views").segment("Add"),[2,e(Object(N.c)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:g.toString(),method:"POST",body:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:l,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:s.getEffectiveFieldNames()},Query:F.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!c,RowLimit:s.rowLimit}}),qosName:"addView",noRedirect:!0})).then(function(t){var r,a,i;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var l=t.d;I={viewId:Xe.default.normalizeLower(l.Id,!1)},U=new Rt.a(t.d),Object(Mt.c)(U);var o=new G.a;return o.resolveItems({items:(r={},r[m.spViewKeyFacet.serialize(I)]=n.__assign({},m.spViewKeyFacet.pack(I),D.serverViewFacet.pack(l),D.currentDerivedViewFacet.pack(U),D.showViewModifiedIndicatorFacet.pack(!1)),r)}),f&&(_=m.spFolderItemSetKeyFacet.serialize(n.__assign({},f,{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:I})),o.resolveItems({items:(a={},a[_]=n.__assign({},v?P.childItemsFacet.pack(v):{},y?P.parentItemFacet.pack(y):{},h?P.schemaFacet.pack(h):{}),a)})),d&&o.resolveItems({items:(i={},i[d]=n.__assign({},m.spViewKeyFacet.pack(I)),i)}),e(o.execute())}).then(function(){var r,a;if(s.scope)return e(Object(w.a)({items:(r={},r[t]={views:(a={},a[U.id]={scope:s.scope},a)},r)}))}).then(function(){var r;return e(Object(qe.b)({items:(r={},r[t]=[P.childItemsFacet],r)}))})]):[2]})})}}),Wt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c;return n.__generator(this,function(u){return a=m.spListViewsSetKeyFacet.matches(t)&&m.spListViewsSetKeyFacet.deserialize(t),i=n.__read(Object.keys(r),1),l=i[0],a&&l?(o=r[l],s=Object(E.a)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).method("Views",l),c={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title},"number"==typeof o.scope&&(c.Scope=o.scope),[2,e(Object(N.c)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:s.toString(),method:"POST",body:JSON.stringify(c),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var r,a,i,s,c=e(Object(he.a)({childItems:P.childItemsFacet},t)).childItems;if(c){var u=new G.a,d=m.spViewKeyFacet.serialize({viewId:l}),p=void 0,f=void 0,b=void 0;try{for(var v=n.__values(c.itemKeys),y=v.next();!y.done;y=v.next()){var h=y.value,F=e(Object(he.a)({view:D.currentDerivedViewFacet},h)).view;F&&(F.isDefault&&(p=F,f=h),h===d&&(b=F))}}catch(e){r={error:e}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(r)throw r.error}}return"boolean"==typeof o.isDefault&&(o.isDefault&&p&&f&&(p.isDefault=!1,u.resolveItems({items:(i={},i[f]=n.__assign({},D.currentDerivedViewFacet.pack(p)),i)})),b&&d&&(b.isDefault=o.isDefault,u.resolveItems({items:(s={},s[d]=n.__assign({},D.currentDerivedViewFacet.pack(b)),s)}))),e(u.execute())}})]):[2]})})}}),Ht=r("98da34addf7164483ddc"),Jt={key:m.spPersonKeyFacet,displayName:x.displayNameFacet,email:Ht.a,picture:Ht.b},Qt=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.likedByItemKeyFacet.deserialize(r),i=a&&a.spItem,l=i.webAbsoluteUrl,o=i.listFullUrl,s=i.itemId;return function(e,a,i){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,c,u,d,p;return n.__generator(this,function(f){switch(f.label){case 0:return a=s&&Object(E.a)({webAbsoluteUrl:l,listFullUrl:o}).method("GetItemById",s).segment("likedByInformation"),i=new G.a,(u=a)?[4,e(Object(N.e)({url:a.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:l,listFullUrl:o}))]:[3,2];case 1:u=f.sent(),f.label=2;case 2:return d=[],(p=(c=u)&&c.d&&c.d.likedBy&&c.d.likedBy.results)&&p.forEach(function(e){var t,r=e.email,a=m.spPersonKeyFacet.serialize({id:String(r)});i.resolveItems({items:(t={},t[a]=Object(y.pack)(Jt,{key:{id:String(r)},displayName:e.name,email:r,picture:r}),t)}),d.push(a)}),i.resolveItems({items:(t={},t[r]=n.__assign({},x.likedByPeopleFacet.pack({personKeys:d})),t)}),e(i.execute()),[2]}})})}});var Xt,$t,Zt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.views,i=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,U;return n.__generator(this,function(I){return r=m.spListViewsSetKeyFacet.deserialize(t),l=n.__read(Object.keys(a),1),o=l[0],r&&o&&(s=a[o],c=s.itemSetKey,u=s.shouldSaveViewFieldsOnly,d=s.newDocumentTemplatesJsonString,p=s.shouldSaveAggregationsOnly,f=e(Object(he.a)({deserializedViewKey:m.spViewKeyFacet,currentDerivedView:D.currentDerivedViewFacet},o)),b=f.deserializedViewKey,v=f.currentDerivedView,y=b&&b.viewId,v&&y&&(h=void 0,u||d||p?v.baseViewXml&&(h=new Rt.a(v.baseViewXml),u?h.replaceFields(v.getEffectiveFieldNames()):d?h.updateNewDocumentTemplates(d):p&&h.replaceAggregates(v.getEffectiveAggregatesData())):(F=e(Object(he.a)({deserializedItemSetKey:m.spFolderItemSetKeyFacet,filterableSet:D.spFilterableSetFacet},c)),g=F.deserializedItemSetKey,w=F.filterableSet,g&&(h=Bt({sourceView:v,deserializedItemSetKey:g,appliedFilters:w&&w.appliedFilters}))),h&&(h.prepareForSaving(),v.isDirty()||h.isDirty())))?(U=Object(E.a)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",y).method("SetViewXml"),[2,e(Object(N.c)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:U.toString(),method:"POST",body:JSON.stringify({viewXml:h.getEffectiveViewXml()}),qosName:i||"saveView"}))]):[2]})})}}),Yt=r("5004fc2f3329649ad54d"),er=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.columnModifyTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w,I,_,S,O;return n.__generator(this,function(A){switch(A.label){case 0:if(!(s=e(Object(he.a)({setKey:m.spFolderItemSetKeyFacet},t)).setKey))return[3,3];if(c=n.__read(Object.keys(r),1),u=c[0],d=r[u],p=d.modifyType,f=d.targetIndex,!(b=s.viewKey?m.spViewKeyFacet.serialize(s.viewKey):void 0))return[3,3];if(!(v=e(Object(he.a)({currentDerivedView:D.currentDerivedViewFacet},b)).currentDerivedView))return[3,3];if(y=v.getEffectiveFieldNames(),!(h=e(Object(he.a)({internalName:D.internalNameFacet},u)).internalName))return[3,3];if((F=y.indexOf(h))<0||1===p&&0===F||2===p&&F===y.length-1)return[2];switch(g=v.isDirty(),p){case 0:v.updateField(h);break;case 1:v.updateField(h,F-1);break;case 2:v.updateField(h,F+1);break;case 3:v.updateField(h,f)}return w={ODB:1318},I=e(Object(ie.a)(function(e){return e.demandItemFacet(D.spPageContextFacet,m.spPageContextKeyFacet.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))})),_=e(Object(ie.a)(function(e){return Object(Yt.a)(e,{feature:w,pageContext:I})})),S=!1,_?[4,e(Object(U.a)({items:(a={},a[m.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})]={views:(i={},i[b]={shouldSaveViewFieldsOnly:!0},i),qosName:"autoSaveModifyColumn"},a)})).then(function(){g||(v.baseViewXml=v.getEffectiveViewXml()),S=!0})]:[3,2];case 1:A.sent(),A.label=2;case 2:O=new G.a,_&&S||O.resolveItems({items:(l={},l[b]=n.__assign({},D.showViewModifiedIndicatorFacet.pack(!0)),l)}),O.invalidateItems({items:(o={},o[t]=[P.childItemsFacet],o[b]=[D.currentDerivedViewFacet],o)}),e(O.execute()),A.label=3;case 3:return[2]}})})}}),tr=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a,i,l,o,s;return n.__generator(this,function(c){return a=n.__read(Object.keys(t),1),i=a[0],l=t[i],o=l.updateType,s=l.formatter,0===o?[2,e(Object(k.resolveItems)({items:(r={},r[i]=n.__assign({},D.customFormatterFacet.pack(s)),r)}))]:[2]})})}}),rr=r("0b8514f932f40951d460"),ar=r("c1a09d7dd35e11297e15"),nr=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new ar.default(function(){r.canceled=!0,rr.default.is(r.result)&&r.result.cancel()}),this._queue.push(r),t=r.signal.getPromise()}return rr.default.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(r){t.signal.complete(r),e._promiseComplete()},function(r){t.signal.error(r),e._promiseComplete()}))}},e}(),ir=r("e9d155a6651c0bf6c9b0"),lr=r("f698cfbaff8a2434ab85"),or=r("62a856fb51e24a703bd6");!function(e){e[e.queued=0]="queued",e[e.started=1]="started",e[e.completed=2]="completed",e[e.aborted=3]="aborted",e[e.failed=4]="failed",e[e.none=5]="none"}(Xt||(Xt={})),function(e){e[e.none=0]="none",e[e.other=1]="other",e[e.general=2]="general",e[e.conflict=3]="conflict",e[e.invalidName=4]="invalidName",e[e.fileSize=5]="fileSize",e[e.emptyFileOrFolder=6]="emptyFileOrFolder",e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib",e[e.overQuota=8]="overQuota",e[e.accessDenied=9]="accessDenied",e[e.lockMismatch=10]="lockMismatch",e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder",e[e.folderUploadNotSupported=12]="folderUploadNotSupported",e[e.versionMismatch=13]="versionMismatch",e[e.authFailure=14]="authFailure",e[e.targetFolderMissing=15]="targetFolderMissing",e[e.malwareDetected=16]="malwareDetected",e[e.throttled=17]="throttled",e[e.pathTooLong=18]="pathTooLong",e[e.disconnected=19]="disconnected",e[e.unlockRequired=20]="unlockRequired",e[e.insufficientVaultQuota=21]="insufficientVaultQuota"}($t||($t={}));var sr=r("c1d76209a7f2fe28e159"),cr=r("00620f24248a4f158ff6");var ur=function(e){function t(t){var r=e.call(this,t)||this;return r.message=t.message,r.errorType=t.errorType||$t.other,r.maxSizeInBytes=t.maxSizeInBytes,r.allowRename=t.allowRename||!1,r.allowMerge=t.allowMerge||!1,r.extraData=t.extraData,r.libraryName=t.libraryName,r.isFolder=t.isFolder,r.fixItUrl=t.fixItUrl,r}return n.__extends(t,e),t}(xt.CustomError),dr=r("8e315e7d1c81f1fe46e0"),mr=r("256c2b1df06b9b785912"),pr=function(){function e(){var e=this.scope=new mr.a;this._events=e.attach(new dr.a(this))}return e.prototype.start=function(){},e.prototype.abort=function(){},e.prototype.dispose=function(){this.scope.dispose()},e.prototype.updateState=function(e){e!==this.state&&(this.state=e,this._events.raise("upload_state_change",e))},e}(),fr=8388608,br=262144e3,vr=new nr(3),yr=function(e){function t(t){var r=this,a=t.fileUpload;return(r=e.call(this)||this)._fileUpload=a,r._authToken=t.authToken,r._uploadId=null,r._chunkNumber=0,r._streamingChunkNumber=0,r._currentChunkSize=fr,r._currentStreamingChunkSize=br,r._onProgress=t.onProgress,r._dataRequestor=t.dataRequestor,r._async=r.scope.attach(new _t.a(r)),r.totalBytes=a.size,r.uploadedBytes=0,r.fileName=a.name,r.iconName=t.iconName,r.state=0,r.error=null,r.nameConflictBehavior=0,r.allowRename=!1,r._expandAllItemFields=t.expandAllItemFields,r._uniqueId=t.uniqueId,r._parentItemKey=t.parentItemKey,r._targetItemKey=t.targetItemKey,r._serverRelativeItemUrl=t.serverRelativeItemUrl,r._webApiUrl=t.webApiUrl,r}return n.__extends(t,e),t.prototype.start=function(){var e=this;this.updateState(0);var t=vr.enqueue(function(){return e.error=void 0,e.updateState(1),e._upload().then(function(){e.updateState(2)},function(t){var r;return r=t instanceof ur?t:new ur({message:t&&t.message||"",errorType:$t.general}),e.error=r,e.updateState(4),rr.default.reject(t)})});return this._uploadPromise=t,t},t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null,this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0,t&&(t.cancel(),t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()}))}},t.prototype.restart=function(){var e,t=this,r=this._uploadPromise;this._uploadPromise=void 0,r?(r.cancel(),e=r.catch(function(){return t._cancelChunkUpload().catch(function(){})})):e=rr.default.resolve(),e.done(function(){t.start()})},t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var r=this._fileUpload.size;return r<=25165824?e=this._sendSingleRequestUpload():(this._maxUploadRequestDuration=15e4,e=this._sendStreamingUpload()),e.then(function(e){t.uploadedBytes=r,t.item=e})},t.prototype._createUploadError=function(e){var t,r,a,n;switch("string"==typeof e?a=String(e):(t=this._getErrorCode(e),r=e.status,a="string"==typeof e.message?String(e.message):e.message.value),t){case-2130575257:n=$t.conflict;break;case-1:n=$t.general;break;case-2130575245:n=$t.invalidName;break;case-2130246326:n=$t.versionMismatch;break;case-2147023080:case-2130575282:n=$t.overQuota;break;default:switch(r){case 401:n=$t.authFailure;break;case 404:n=$t.targetFolderMissing;break;case 403:case 429:n=$t.accessDenied;break;case 409:n=$t.conflict;break;case 412:n=$t.versionMismatch;break;case 415:n=$t.emptyFileOrFolder;break;case 423:n=$t.lockMismatch;break;case 507:n=$t.overQuota;break;default:a?n||(n=$t.other):n=$t.general}}return new ur({message:a,errorType:n,allowRename:this.allowRename})},t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]},t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,r=this._webApiUrl;r=e?r.method("GetFolderById",e):hr(r,{serverRelativeItemUrl:t,isFolder:!0});var a=this._fileUpload.name,n=1===this.nameConflictBehavior;r=(r=r.segment("Files")).methodWithAliases("AddUsingPath",{DecodedUrl:a,overwrite:n});var i=null;return this._expandAllItemFields&&(i=(i||"ListItemAllFields")+"/ContentType/Fields"),i&&r.oDataParameter("$Expand",i),r.toString()},t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return rr.default.resolve(!1);var t=this._serverRelativeItemUrl,r=this._webApiUrl;return r=(r=hr(r,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+ir.default.encodeRestUriStringToken(this._fileUpload.name)+"'"),this._dataRequestor.getData({url:r.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var r=JSON.parse(t);return!!(r&&r.d&&r.d.results&&r.d.results.length>0)&&!(r.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!rr.default.isCanceled(e)&&rr.default.reject(e)})},t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)},t.prototype._getItemFromResponse=function(e){var t;try{var r=JSON.parse(e).d,a=this._targetItemKey,n=void 0;r.ListItemAllFields&&r.ListItemAllFields.Id&&(n=String(r.ListItemAllFields.Id));var i=!1;if(r.ListItemAllFields&&r.ListItemAllFields.ContentType&&r.ListItemAllFields.ContentType.Fields&&r.ListItemAllFields.ContentType.Fields.results){var l=r.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(l.length>0)for(var o=0,s=l;o<s.length;o++){var c=s[o];if(!r.ListItemAllFields[c.InternalName]){i=!0;break}}}var u=void 0;r.UniqueId&&(u=Xe.default.normalizeLower(r.UniqueId));var d=r.Name,m=or.b(d);t={key:a,parentKey:this._parentItemKey,type:lr.a.File,id:r.ServerRelativeUrl,name:d,displayName:d,extension:m,properties:{ID:n,uniqueId:u},itemFromServer:r,hasMissingMetadata:i}}catch(e){}return t},t.prototype._generateChunkPostUrl=function(e,t){var r,a=this._fileUpload,i=this._uniqueId,l=a.size<=t,o=this._serverRelativeItemUrl,s=this._webApiUrl,c={uploadId:{guid:this._uploadId}};return 0===this._chunkNumber&&0===this._streamingChunkNumber?(r="StartUpload",s=(s=i?s.method("GetFolderById",i):hr(s,{serverRelativeItemUrl:o,isFolder:!0})).segment("Files"),s=1===this.nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:a.name}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:a.name})):(r=l?"FinishUpload":"ContinueUpload",s=hr(s,{serverRelativeItemUrl:o+"/"+a.name,isFolder:!1}),c=n.__assign({},c,{fileOffset:e})),(s=s.methodWithAliases(r,c)).toString()},t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=a.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:r+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){return e.d&&e.d.ExpectedContentRange?parseInt(e.d.ExpectedContentRange.split("-")[0],10):rr.default.reject(new Error("No expected range from server response."))})},t.prototype._uploadFragment=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3);var a=this._fileUpload.size,n=Math.min(this._currentChunkSize+e,a);this._uploadId||(this._uploadId=Xe.default.generate());var i=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,n),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,n),offset:e,length:n-e}).then(function(e){return r.uploadedBytes=n,n<a?(r._chunkNumber++,Date.now()-i<6e4&&(r._currentChunkSize=Math.min(Math.floor(r._currentChunkSize*Math.pow(2,.25)),62914560)),r._uploadFragment(n)):r._processUploadCompleteResponse(e)},function(a){if(rr.default.isCanceled(a))return rr.default.reject(a);if(-2===r._getErrorCode(a)){if(r._currentChunkSize>262144){r._currentChunkSize=Math.max(Math.floor(r._currentChunkSize/2),262144);var n=void 0;return 0===r._chunkNumber&&(n=r._cancelChunkUpload()),rr.default.resolve(n).then(function(){return r._uploadFragment(e)})}}else if(t>0&&r._canRetry(a)){var i,l=new ar.default(function(){i&&r._async.clearTimeout(i)});return i=r._async.setTimeout(function(){return l.complete()},1e3),l.getPromise().then(function(){return r._uploadFragment(e,t-1)})}return rr.default.reject(r._createUploadError(a))})},t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var r=new ur({message:"",errorType:$t.conflict});return rr.default.reject(r)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){return rr.default.isCanceled(t)?rr.default.reject(t):-2===e._getErrorCode(t)?(e.nameConflictBehavior=1,e._uploadFragment()):rr.default.reject(e._createUploadError(t))})})},t.prototype._sendStreamingUpload=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3),this._uploadId||(this._uploadId=Xe.default.generate());var a=this._fileUpload.size,n=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,a):0;return this._isConflictFile().then(function(t){if(t){var a=new ur({message:"",errorType:$t.conflict});return rr.default.reject(a)}return r._fileUpload.slice(e,n)}).then(function(i){return r._sendFileData({url:r._generateChunkPostUrl(e,n),qosName:"SingleFileUploader.SendFileRequest",data:i,offset:e,length:i.size}).then(function(e){return r.uploadedBytes=n,n<a?(r._streamingChunkNumber++,r._sendStreamingUpload(n,t)):r._processUploadCompleteResponse(e)},function(e){if(rr.default.isCanceled(e))return rr.default.reject(e);if(-2===r._getErrorCode(e)){if(r._currentStreamingChunkSize<=1048576)return rr.default.reject(r._createUploadError(e));r._currentStreamingChunkSize=r._currentStreamingChunkSize/2}return r._getUploadStatus().then(function(e){return r._sendStreamingUpload(e,3)},function(a){if(t>0&&r._canRetry(e)){var n,i=new ar.default(function(){n&&r._async.clearTimeout(n)});return n=r._async.setTimeout(function(){return i.complete()},1e3),i.getPromise().then(function(){return r._sendStreamingUpload(0,t-1)})}return rr.default.reject(r._createUploadError(e))})})})},t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t},t.prototype._cancelChunkUpload=function(){var e=this._uploadId;if(this._uploadId=void 0,this._chunkNumber=0,e){var t=this._fileUpload,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=(a=hr(a,{serverRelativeItemUrl:r+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return rr.default.resolve()},t.prototype._sendFileData=function(e){var t,r,a,n=this,i=e.url,l=e.qosName,o=e.data,s=e.offset,c=e.length,u=new ar.default(function(){t.cancel()}),d=function(e){var t=n._chunkNumber>0&&s+c>=n._fileUpload.size?3e5:1e4,a=Math.max(.08*e,t);r&&n._async.clearTimeout(r),e&&(r=n._async.setTimeout(function(){u.error({code:"-1",message:""})},a))},m=Date.now(),p=Date.now(),f=0,b=0,v=0,y=this._async.debounce(function(e){e>n.uploadedBytes&&(n.uploadedBytes=e,n._onProgress&&n._onProgress(e))},100,{leading:!1});t=this._dataRequestor.getData({url:i,authToken:this._authToken,qosName:l,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:o,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();b+=(e.loaded-f)/(t-p),v++,a=e.loaded/(t-m),p=t,f=e.loaded,y(s+e.loaded),d(c-e.loaded)}}}),d(c);var h=this._async.setInterval(function(){v&&(Date.now()-m+(c-f)/((b+a)/(v+1))>n._maxUploadRequestDuration&&f<c&&u.error({code:"-2",message:""}))},1e4);return t.done(function(e){u.complete(e)},function(e){u.error(e)}),u.getPromise().done(function(){r&&n._async.clearTimeout(r),h&&n._async.clearInterval(h)},function(){t.cancel(),r&&n._async.clearTimeout(r),h&&n._async.clearInterval(h)}),u.getPromise()},t}(pr);!function(e){function t(t,r){var a=t.parentItem,n=t.fileUpload,i=r.listContext,l=r.itemUrlHelper,o=r.apiUrlHelper,s=i&&i.contentTypesEnabled&&i.listTemplateType!==cr.default.mySiteDocumentLibrary,c=l.getItemUrlParts(a.key),u=a.properties&&a.properties.uniqueId,d=a.key,m=function(e,t,r){var a=e.getItemUrlParts(t),n=a.serverRelativeItemUrl,i=a.normalizedListUrl;return l=n+"/"+r,o=i,s=l,0!==s.indexOf("id")&&(s=Object(le.a)({id:l,listurl:o})),s;var l,o,s}(l,d,n.name),p=c.serverRelativeItemUrl,f=o.build().webByItemUrl(c),b=new sr.default({pageContext:r.pageContext,qosName:"SingleFileUploader"});return e.call(this,{uniqueId:u,expandAllItemFields:s,dataRequestor:b,parentItemKey:d,targetItemKey:m,serverRelativeItemUrl:p,webApiUrl:f,iconName:n.iconName,fileUpload:n})||this}n.__extends(t,e)}(yr);function hr(e,t){var r=t.serverRelativeItemUrl,a=t.isFolder;return e=e.methodWithAliases(a?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:r})}var Fr=r("2be4cdf0880f45f00879"),gr=r("c21819129ba64362c121"),wr=r("a5db57338f8274c3300c");function Ur(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,i=m.spItemKeyFacet.deserialize(r),l=i.webAbsoluteUrl,o=i.listFullUrl,s=n.__read(Object.keys(a),1)[0],u=a[s],d=u.progressItemKey,p=u.conflictResolution;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,u,m,f,b,v,h,F,g,w,U,I,_;return n.__generator(this,function(S){switch(S.label){case 0:return[4,e(Object(N.d)({webAbsoluteUrl:l,listFullUrl:o}))];case 1:return a=S.sent(),[4,e(Object(N.b)({url:l||o}))];case 2:if(u=S.sent(),m=e(Object(he.a)({sourceFile:gr.b},s)).sourceFile,f=e(Object(he.a)({folderPath:D.folderPathFacet},r)).folderPath,b=void 0===f?i.rootFolder:f,!m)throw new Error("No source file for upload.");if(!b)throw new Error("No path information for target folder.");v=Object(E.c)({webAbsoluteUrl:l,listOrItemFullUrl:o}),h=new Fr.a(void 0),F=h.debounce(function(t){var r;d&&e(Object(k.resolveItems)({items:(r={},r[d]=Object(y.pack)({progressSize:Me.m},{progressSize:{current:t}}),r)}))},300,{leading:!1}),(g=new yr({authToken:u,dataRequestor:a,parentItemKey:"",targetItemKey:"",fileUpload:m,iconName:"",serverRelativeItemUrl:b,webApiUrl:v,onProgress:F})).nameConflictBehavior="replace"===p?1:0,d&&e(Object(k.resolveItems)({items:(t={},t[d]=n.__assign({},Me.m.pack({total:m.size,current:0})),t)})),w=g.start(),U=e(Object(ie.a)(function(e){return e.demandItemFacet(Me.e,d)})),I=U?U.token.subscribe(function(){g.abort()}):void 0,S.label=3;case 3:return S.trys.push([3,5,6,7]),[4,w];case 4:return S.sent(),[3,7];case 5:if(_=S.sent(),g.abort(),rr.default.isCanceled(_))throw new wr.a;if(_ instanceof ur)throw new c.a({facets:Ir(_),innerError:_});if((A=_)&&("status"in A||A.message&&"object"==typeof A.message))throw new c.a({facets:n.__assign({},"-2130575257"===_.code?n.__assign({},Be.c.pack({supportsRename:!1})):n.__assign({},Be.k.pack({})),D.spErrorDataFacet.pack(_)),message:(O=_,O&&O.message&&("object"==typeof O.message?O.message.value:O.message.toString())||"")});throw _;case 6:return I&&I(),g.dispose(),[7];case 7:return[2,g.item]}var O,A})})}}function Ir(e){switch(e.errorType){case $t.conflict:return n.__assign({},Be.c.pack({supportsRename:!1}));case $t.accessDenied:return n.__assign({},Be.a.pack({}));case $t.disconnected:return n.__assign({},Be.i.pack({}));case $t.emptyFileOrFolder:case $t.emptyFileOrFolderForDocLib:return n.__assign({},Be.d.pack({}));case $t.folderUploadNotSupported:return n.__assign({},Be.e.pack({}));case $t.invalidName:return n.__assign({},Be.f.pack({}));case $t.lockMismatch:return n.__assign({},Be.g.pack({}));case $t.malwareDetected:return n.__assign({},Be.h.pack({}));case $t.overQuota:return n.__assign({},Be.j.pack({}));case $t.targetFolderMissing:return n.__assign({},Be.l.pack({}));case $t.throttled:return n.__assign({},Be.m.pack({}));case $t.versionMismatch:return n.__assign({},Be.n.pack({}))}return n.__assign({},Be.k.pack({}))}var _r=r("bb1d3dd843cb19bcdb5a"),Sr=Object(i.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,i=m.spItemKeyFacet.deserialize(r),l=i.webAbsoluteUrl,o=i.listFullUrl,s=n.__read(Object.keys(a),1)[0],c=a[s].progressItemKey;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,u,d,p,f,b,v,h,F,g;return n.__generator(this,function(w){switch(w.label){case 0:return p=a(Object(he.a)({sourceFile:gr.b},s)).sourceFile,[4,a(Ur(e))];case 1:return f=w.sent(),b=f.properties,v=b&&b.ID||f.id,h=new G.a,c&&p&&(F=m.spItemKeyFacet.serialize({webAbsoluteUrl:l,listFullUrl:o,itemId:v}),h.resolveItems({items:(t={},t[c]=n.__assign({},Me.f.pack({itemKey:F}),Object(y.pack)({progressSize:Me.m},{progressSize:{current:p.size}})),t[F]=n.__assign({},x.displayNameFacet.pack(f.displayName),m.spItemKeyFacet.pack({itemId:f.id,webAbsoluteUrl:l,listFullUrl:o})),t)})),h.invalidateItems({items:(u={},u[r]=[P.defaultChildItemSetFacet],u)}),F&&f&&i.rootFolder&&-1!==(i.rootFolder+"/").indexOf(i.listFullUrl+"/Forms/")&&(g=m.spListKeyFacet.serialize({webAbsoluteUrl:l,listFullUrl:o}),a(Object(_r.a)({items:(d={},d[g]={childItemKey:F},d)}))),a(h.execute()),[2]}})})}});var Or,Ar=r("d6e6a1e726db94fe6759"),Kr=r("4986dedaa57d766e48bb")["_5CoIJg/6Hl4qwvkQ8ev5+w"],Tr=r("9c98f89a0e31dc353072"),jr=((Or={})[Me.d.started]=function(e,t){return Object(Ar.format)(Object(Ar.getLocalizedCountValue)(Kr.assignToGroupStartedItemsTitle,Kr.assignToGroupTitleIntervals,e)||"",e,t)},Or[Me.d.completed]=function(e,t){return Object(Ar.format)(Object(Ar.getLocalizedCountValue)(Kr.assignToGroupCompletedItemsTitle,Kr.assignToGroupTitleIntervals,e)||"",e,t)},Or[Me.d.failed]=function(e,t){return Object(Ar.format)(Object(Ar.getLocalizedCountValue)(Kr.assignToGroupFailedItemsTitle,Kr.assignToGroupTitleIntervals,e)||"",e,t)},Or[Me.d.canceled]=function(e,t){return Object(Ar.format)(Object(Ar.getLocalizedCountValue)(Kr.assignToGroupFailedItemsTitle,Kr.assignToGroupTitleIntervals,e)||"",e,t)},Or),Cr=Object(i.b)(function(){return function(e){e(Object(_.d)(g,Tr.a)(Object(_.a)()(kr)))}});function kr(){return function(e){return xr}}function xr(e,t){var r=t.itemKey,a=Object(h.f)(e,t),i=a.phase,l=a.count,o=jr,s=e.demandItemFacet(P.childItemsFacet,r),c=s&&s.itemKeys,u="",d="";if(c&&c.length>0){var m=e.demandItemFacet(F,c[0]),p=m&&m.groupKey;p&&(u=e.demandItemFacet(x.displayNameFacet,p)||""),d=o[i](l,u)}else{var f=e.demandItemFacet(g,r);if(f){var b=f.taskKey,v=b&&e.demandItemFacet(x.displayNameFacet,b);v&&(d=v)}}return n.__assign({},d?{title:d}:{})}var Pr=Object(j.f)({operationTypeFacet:F}),Dr=(Object(h.g)({operationTypeFacet:F,progressKeyFacet:g,initializeBatch:function(){return Cr}}),Object(i.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,i=m.spItemGroupKeyFacet.deserialize(r),l=i&&i.itemSetKey,o=l.webAbsoluteUrl,s=l.listFullUrl,c=l.rootFolder,u=m.spItemKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s,rootFolder:c}),d=n.__read(Object.keys(a),1)[0],p=a[d].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,c;return n.__generator(this,function(f){switch(f.label){case 0:return t=e(Object(he.a)({sourceFile:gr.b},d)).sourceFile,[4,e(Ur({itemKey:u,options:{sourceEntries:a}}))];case 1:return i=f.sent(),l=i.itemFromServer.ListItemAllFields.__deferred.uri,c=function(r){var a,i;e(Object(qe.b)({items:(a={},a[u]=[P.defaultChildItemSetFacet],a)})),p&&t&&e(Object(k.resolveItems)({items:(i={},i[p]=n.__assign({},Me.f.pack({itemKey:r}),Object(y.pack)({progressSize:Me.m},{progressSize:{current:t.size}})),i)}))},[4,e(Object(N.c)({webAbsoluteUrl:o,listFullUrl:s,url:l,method:"POST",qosName:"getUploadItem",noRedirect:!0})).then(function(t){var a,n=t.d.ID,i=m.spItemKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s,itemId:n});e(Pr({items:(a={},a[i]={groupKey:r},a)})).then(function(){c(i)},function(e){c(i)})},function(e){var t=i.properties&&i.properties.ID,r=m.spItemKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s,itemId:t});c(r)})];case 2:return f.sent(),[2]}})})}}));var Nr=r("85bfca0cd3bb87373c39"),Rr=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spListViewsSetKeyFacet.deserialize(r),i=a.webAbsoluteUrl,l=a.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,s,c,u,d,p,f,b,v,y,h,F;return n.__generator(this,function(g){switch(g.label){case 0:return c=[],u=new G.a,d=e(Object(he.a)({pageContext:D.spPageContextFacet},m.spPageContextKeyFacet.serialize({webAbsoluteUrl:i,listFullUrl:l}))),p=m.spListKeyFacet.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),f=e(Object(he.a)({list:D.listFacet},p)),b=e(Object(ze.a)({localeConfiguration:ne.localeFacet})).localeConfiguration,[4,e(Object(Nr.a)({webAbsoluteUrl:i,listFullUrl:l,listTemplate:f.list&&f.list.templateType,preferredLanguage:b&&b.language}))];case 1:return v=g.sent(),y={},h=void 0,F=[],v.filter(function(e){return!!e.view}).map(function(e){var t,r,a,o,s,p=e.serverView,b=e.view,v=b.id,g={viewId:v},w=m.spViewKeyFacet.serialize(g);if(d&&d.pageContext&&f&&f.list&&f.list.id&&(s=function(e){var t=e.webAbsoluteUrl,r=e.layoutsUrl,a=e.viewId,n=e.listId,i=e.sourceUrl;return t+"/"+r+"/ViewEdit.aspx?"+Object(le.a)({View:Xe.default.normalizeUpper(a,!0),List:Xe.default.normalizeUpper(n,!0),Source:i})}({webAbsoluteUrl:i,layoutsUrl:d.pageContext.layoutsUrl,viewId:v,listId:f.list.id,sourceUrl:p.ServerRelativeUrl})),b.isDefault){h=w;var U=b.getDomParts().newDocumentTemplates;if(U&&U.textContent)try{if((F=JSON.parse(U.textContent)).length)try{for(var I=n.__values(F),_=I.next();!_.done;_=I.next()){var S=_.value;if(S.url){var O=m.spNewDocumentTemplateKeyFacet.serialize({templateUrl:S.url,listKey:{webAbsoluteUrl:i,listFullUrl:l}});u.resolveItems({items:(a={},a[O]=n.__assign({},D.newDocumentTemplateFacet.pack(S)),a)})}S.templateId||(S.isUpload?S.templateId=S.title:S.isContentType&&S.contentTypeId&&(S.templateId=S.contentTypeId))}}catch(e){t={error:e}}finally{try{_&&!_.done&&(r=I.return)&&r.call(I)}finally{if(t)throw t.error}}}catch(e){}}y[w]=b,Object(Mt.c)(b),u.resolveItems({items:(o={},o[w]=n.__assign({},m.spViewKeyFacet.pack(g),D.serverViewFacet.pack(p),D.currentDerivedViewFacet.pack(b),D.showViewModifiedIndicatorFacet.pack(!1),s?x.openUrlFacet.pack(s):{}),o)}),c.push(w)}),u.resolveItems({items:(t={},t[p]=n.__assign({},D.newDocumentTemplatesFacet.pack(F)),t)}),c.sort(function(e,t){return y[e].compareTo(y[t])}),u.resolveItems({items:(o={},o[r]=n.__assign({},m.spListViewsSetKeyFacet.pack(a),P.childItemsFacet.pack({itemKeys:c})),o)}),h&&u.resolveItems({items:(s={},s[p]=n.__assign({},D.defaultViewFacet.pack({viewKey:h})),s)}),e(u.execute()),[2]}})})}});var Er=r("f553bf0f97ddfedc1f32"),Lr=r("4d934992108cb28aa92f"),zr=r("5730cedeedcb5640bb56"),Vr=r("843110fa06f12b102717");function qr(e,t,r){var a=Object(E.a)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(n){return n(Object(N.e)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:a.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return function(e,t){return Object(zr.b)(e,t)}(e.d.CustomActionElements.Items.results,r)})}}function Mr(e,t){var r=De.escapeUrlForCallback(e)+"/_layouts/15/tenantappinfo.ashx?etag=0&lcid="+Vr.Locale.lcid;return function(a){return a(Object(N.c)({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:r,qosName:"getTenantAppCustomAction",noRedirect:!0})).then(function(e){return e.apps?function(e,t){var r=[];return e.forEach(function(e,a){e.customActions&&(r=r.concat(Object(zr.c)(e.customActions,t)))}),r}(e.apps,t):[]})}}var Br=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.legacyCustomActionSetKeyFacet.deserialize(r),i=a.webAbsoluteUrl,l=a.listFullUrl,o=m.contextMenuCustomActionSetKeyFacet.serialize({webAbsoluteUrl:i,listFullUrl:l});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,s,c,u,d,p,f;return n.__generator(this,function(n){switch(n.label){case 0:return t=Qr(e,i,l),a=e(Object(he.a)({listViewAdapter:Lr.d},m.spItemKeyFacet.serialize({webAbsoluteUrl:i,listFullUrl:l}))),s=a&&a.listViewAdapter,c=new G.a,[4,e(qr(i,l,t))];case 1:return u=n.sent(),d=t.isDocumentLibrary,[4,Hr({setKey:r,actions:u[d?"Ribbon.Documents":"Ribbon.List"],listViewAdapter:s})];case 2:return p=n.sent().itemResolver,[4,Hr({setKey:o,actions:u.ContextMenu,listViewAdapter:s})];case 3:return f=n.sent().itemResolver,c.merge(f),c.merge(p),e(c.execute()),[2]}})})}}),Gr=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.tenantAppCustomActionSetKeyFacet.deserialize(r),i=a.webAbsoluteUrl,l=a.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,o;return n.__generator(this,function(n){switch(n.label){case 0:return t=Qr(e,i,l),[4,e(Mr(i,t))];case 1:return a=n.sent(),[4,Hr({setKey:r,actions:a})];case 2:return o=n.sent().itemResolver,e(o.execute()),[2]}})})}}),Wr=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.customActionSetKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o;return n.__generator(this,function(s){return i=new G.a,l=m.legacyCustomActionSetKeyFacet.serialize(a),o=m.tenantAppCustomActionSetKeyFacet.serialize(a),i.resolveItems({items:(t={},t[r]=n.__assign({},H.e.pack(!0),P.childItemsFacet.pack({itemKeys:[l,o]})),t)}),e(i.execute()),[2]})})}});function Hr(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,a,i,l,o,s,c,u,d,p,f,b,v;return n.__generator(this,function(y){switch(y.label){case 0:i=e.setKey,l=e.actions,o=e.listViewAdapter,s=new G.a,c=[],u=0,d=function(e){var t,r,a,i,l,d,p,f,b,v,y,h,F,g,w,U,I,_,S;return n.__generator(this,function(O){switch(O.label){case 0:if(l=[],!Object(zr.a)(e))return[3,10];d=e.children,p=0,O.label=1;case 1:O.trys.push([1,8,9,10]),f=n.__values(d),b=f.next(),O.label=2;case 2:return b.done?[3,7]:(v=b.value,y=v.id?v.id:v.text+u+"."+p,h=m.customActionKeyFacet.serialize({actionId:y}),Xr(v)?[3,3]:(s.resolveItems({items:(a={},a[h]=n.__assign({},x.displayNameFacet.pack(v.text),x.openUrlFacet.pack(v.action),Er.a.pack(v.allowMultiSelect),Er.c.pack(v.isEnabled||!1),Er.b.pack(v.iconUrl)),a)}),[3,5]));case 3:return o?[4,Jr({action:v,listViewAdapter:o})]:[3,5];case 4:F=O.sent(),I=F.actionKeys,U=F.itemResolver,s.merge(U),I.forEach(function(e){l.push(e)}),O.label=5;case 5:l.push(h),p++,O.label=6;case 6:return b=f.next(),[3,2];case 7:return[3,10];case 8:return g=O.sent(),t={error:g},[3,10];case 9:try{b&&!b.done&&(r=f.return)&&r.call(f)}finally{if(t)throw t.error}return[7];case 10:return!Object(zr.a)(e)&&Xr(e)&&o?[4,Jr({action:e,listViewAdapter:o})]:[3,12];case 11:return w=O.sent(),U=w.itemResolver,I=w.actionKeys,s.merge(U),c=c.concat(I),[3,13];case 12:_=e.id?e.id:e.text+u.toString(),S=m.customActionKeyFacet.serialize({actionId:_}),s.resolveItems({items:(i={},i[S]=n.__assign({},x.displayNameFacet.pack(e.text),P.childItemsFacet.pack({itemKeys:l}),x.openUrlFacet.pack(Object(zr.a)(e)?"":e.action),Object(zr.a)(e)?{}:Er.a.pack(e.allowMultiSelect),Object(zr.a)(e)?{}:Er.c.pack(e.isEnabled||!1),Object(zr.a)(e)?{}:Er.b.pack(e.iconUrl)),i)}),c.push(S),O.label=13;case 13:return u++,[2]}})},y.label=1;case 1:y.trys.push([1,6,7,8]),p=n.__values(l),f=p.next(),y.label=2;case 2:return f.done?[3,5]:(b=f.value,[5,d(b)]);case 3:y.sent(),y.label=4;case 4:return f=p.next(),[3,2];case 5:return[3,8];case 6:return v=y.sent(),t={error:v},[3,8];case 7:try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}return[7];case 8:return s.resolveItems({items:(a={},a[i]=n.__assign({},H.e.pack(!0),P.childItemsFacet.pack({itemKeys:c})),a)}),[2,{itemResolver:s}]}})})}function Jr(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,a,i,l,o,s;return n.__generator(this,function(c){switch(c.label){case 0:return t=e.action,r=e.listViewAdapter,a=new G.a,i=[],l=t.clientSideComponentId&&t.clientSideComponentId.toString()||"",o=t.clientSideComponentProperties||"",l&&l!==Xe.default.Empty?[4,r.loadCommandSet(l,o)]:[2,{itemResolver:a,actionKeys:[]}];case 1:return(s=c.sent())&&s.commandAdapters&&s.commandAdapters.forEach(function(e){var r,l=t.clientSideComponentId+"."+e.commandId,o=m.customActionKeyFacet.serialize({actionId:l});a.resolveItems({items:(r={},r[o]=n.__assign({},x.displayNameFacet.pack(e.title),x.openUrlFacet.pack(t.action),Er.a.pack(t.allowMultiSelect),Er.c.pack(t.isEnabled||!1),Lr.c.pack(e)),r)}),i.push(o)}),[2,{itemResolver:a,actionKeys:i}]}})})}function Qr(e,t,r){var a=e(Object(he.a)({pageContext:D.spPageContextFacet},m.spPageContextKeyFacet.serialize({webAbsoluteUrl:t,listFullUrl:r}))),n=e(Object(he.a)({list:D.listFacet},m.spListKeyFacet.serialize({webAbsoluteUrl:t,listFullUrl:r})));return{currentUserIsSiteAdmin:a.pageContext&&a.pageContext.isSiteAdmin||!1,listTemplate:n.list&&n.list.templateType||cr.ListTemplateType.invalidType,listId:n.list&&n.list.id||"",isDocumentLibrary:n.list&&n.list.isDocumentLibrary}}function Xr(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==Xe.default.Empty)||!1}var $r=r("455751f14e5c7456742c");function Zr(e){var t=e.serverRelativeItemUrl,r=e.dataRequestor,a=e.webApiUrl,n=e.duration,i=void 0===n?1:n,l=e.authToken,o=a;return o=(o=o.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",i),r.getData({url:o.toString(),method:"GET",authToken:l,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}var Yr=r("df0590cb07119b259360"),ea=r("c42c356815f80924f647"),ta=r("aa112348dbd293212a65"),ra=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKeys,a=n.__read(r,1),i=a[0],l=e.demandItemFacet(x.folderFacet,i),o=e.demandItemFacet(st.b,i);return 1!==r.length||l||o?r.length>0?function(e,t){var r,a,i=t.itemKeys,l=e.demandItemFacet(m.spItemKeyFacet,i[0]);if(!l||!l.webAbsoluteUrl||!l.listFullUrl)return{};var o=l.webAbsoluteUrl,s=l.listFullUrl,c=m.spListKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:s}),u=e.demandItem({listFacets:D.listFacet,downloadZipApiUrl:Yr.a},c),d=u.listFacets,p=u.downloadZipApiUrl;if(!d||!p||d.templateType===cr.ListTemplateType.webPageLibrary)return{};var f=[];try{for(var b=n.__values(i),v=b.next();!v.done;v=b.next()){var y=v.value,h=e.demandItem({name:x.displayNameFacet,size:x.fileSizeFacet,itemUrl:x.vroomUrlFacet,folder:x.folderFacet,permissions:D.permissionsFacet,itemComplianceStatus:ea.a},y),F=h.name,g=h.size,w=h.itemUrl,U=h.folder,I=h.permissions,_=h.itemComplianceStatus;if(!w)return{};var S=e.demandItemFacet(Yr.b,c),O=Object($r.getItemUrlWithToken)(w,(S?S.accessToken:void 0)||"");if(O){var A=!!U;3!==_&&4!==_&&ft.a.hasItemPermission({permissions:I},ft.a.openItems)&&f.push({name:F||"",size:g||0,docId:O,isFolder:A})}}}catch(e){r={error:e}}finally{try{v&&!v.done&&(a=b.return)&&a.call(b)}finally{if(r)throw r.error}}if(0===f.length)return{};return{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,r=e.webAbsoluteUrl,a=e.listFullUrl,i=e.zipApiUrl,l=e.itemsData;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,s,c;return n.__generator(this,function(n){switch(n.label){case 0:return t=l&&l[0]&&l[0].docId,o=void 0,t&&-1!==t.indexOf("access_token")?[3,2]:[4,e(Object(N.b)({url:r||a}))];case 1:o=n.sent(),n.label=2;case 2:return s=l&&1===l.length?l[0].name+".zip":"OneDrive_"+ ++aa+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip",c=Xe.default.generate(),[2,{url:i,method:"POST",postData:{zipFileName:s,guid:c,provider:"spo",files:JSON.stringify({items:l}),oAuthToken:o||""}}]}})})}}({webAbsoluteUrl:o,listFullUrl:s,zipApiUrl:p,itemsData:f})}}}(e,{itemKeys:r}):{}:function(e,t){var r=t.itemKey,a=e.demandItem({spItem:m.spItemKeyFacet,permissions:D.permissionsFacet,folderPath:D.folderPathFacet,itemComplianceStatus:ea.a},t.itemKey),i=a.spItem,l=a.permissions,o=a.folderPath,s=a.itemComplianceStatus,c=e.demandItemFacet(x.malwareDetectedFacet,t.itemKey),u=i&&m.spPageContextKeyFacet.serialize(i),d=e.demandItemFacet(D.spPageContextFacet,u);if(!d||!i)return{};var p=i.webAbsoluteUrl,f=i.listFullUrl,b=m.spListKeyFacet.serialize(i),v=e.demandItemFacet(D.listFacet,b);if(v&&v.templateType===cr.ListTemplateType.webPageLibrary)return{};if(3===s||4===s||!ft.a.hasItemPermission({permissions:l},ft.a.openItems))return{};if(c){if(!d.allowInfectedDownload)return{};var y=e.demandItemFacet(x.canonicalUrlFacet,r);if(!y)return{};var h=Object(ta.a)(e,{spCookieDomainConfiguration:D.spCookieDomainConfigurationFacet}).spCookieDomainConfiguration;return h?new ue.SimpleUri(h).authority!==new ue.SimpleUri(y).authority?{}:{isAvailable:!0,getDownloadData:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(r){return(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1"),[2,{url:t,method:"GET"}]})})}}({canconicalUrl:y})}}:{}}if(!o)return{};var F=d.layoutsUrl;if(!F)return{};return{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,r=e.webAbsoluteUrl,a=e.listFullUrl,i=e.folderPath;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l,o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(Object(N.d)({webAbsoluteUrl:r,listFullUrl:a}))];case 1:return t=n.sent(),[4,e(Object(N.b)({url:r||a}))];case 2:return l=n.sent(),o=Object(E.c)({webAbsoluteUrl:r,listOrItemFullUrl:a}),[4,Zr({dataRequestor:t,authToken:l,serverRelativeItemUrl:i,webApiUrl:o})];case 3:return[2,{url:n.sent(),method:"GET"}]}})})}}({webAbsoluteUrl:p,listFullUrl:f,folderPath:o,layoutsUrl:F})}}}(e,{itemKey:i})}}});var aa=0;var na=r("8c495b09d9111445d5b0"),ia=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({permissions:D.permissionsFacet},r).permissions;return{isAvailable:ft.a.hasItemPermission({permissions:a},ft.a.deleteListItems)}}}});var la=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=m.spWebPageContextKeyFacet.deserialize(r).webAbsoluteUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s;return n.__generator(this,function(c){switch(c.label){case 0:return i=Object(E.b)({webAbsoluteUrl:a}).segments("ComponentContextInfo"),[4,r(Object(N.c)({url:i.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:a,noRedirect:!0}))];case 1:return l=c.sent(),o=JSON.parse(l.d.SerializedData),(s=new G.a).resolveItems({items:(t={},t[e.itemKey]=n.__assign({},m.spWebPageContextKeyFacet.pack({webAbsoluteUrl:a}),D.spPageContextFacet.pack(o)),t)}),r(s.execute()),[2]}})})}});var oa=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.groupKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c,u,d,p,f,b,v,y,h,F,g,w;return n.__generator(this,function(n){switch(n.label){case 0:if(a=e(Object(he.a)({spGroupField:D.spGroupFieldFacet,groupValue:D.groupValueFacet,parentGroupKey:D.parentGroupKeyFacet},r)),i=a.spGroupField,l=a.groupValue,o=a.parentGroupKey,s=m.spItemGroupKeyFacet.matches(r)&&m.spItemGroupKeyFacet.deserialize(r),c=m.spItemKeyFacet.deserialize(t),U={webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,itemId:c.itemId||""},I=U.webAbsoluteUrl,_=U.listFullUrl,S=U.itemId,u=Object(E.a)({webAbsoluteUrl:I,listFullUrl:_}).method("Items",S).method("ValidateUpdateListItem").toString(),d=[],p=function(e,t){return{FieldName:e,FieldValue:t,HasException:!1,ErrorMessage:null}},i&&i.internalName&&l&&d.push(p(i.internalName,l)),o&&o.itemKey&&(f=e(Object(he.a)({parentGroupField:D.spGroupFieldFacet,parentGroupValue:D.groupValueFacet},o.itemKey)),b=f.parentGroupField,v=f.parentGroupValue,b&&b.internalName&&v&&d.push(p(b.internalName,v))),s&&s.itemSetKey&&s.itemSetKey.filterParams&&(y=Ne.a.getFilterList(s.itemSetKey.filterParams,void 0,!0)).length>0)for(h=0;h<y.length;h++)F=y[h],g=e(Object(he.a)({isReadOnly:D.isReadOnlyFacet},m.spFieldKeyFacet.serialize({internalName:F.fieldName}))).isReadOnly,1===F.values.length&&!1===g&&d.push(p(F.fieldName,F.values[0]));return(w={}).formValues=d,w.bNewDocumentUpdate=!1,w.checkInComment=null,d.length>0?[4,e(Object(N.c)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:u,method:"POST",body:JSON.stringify(w),qosName:"assignItemToGroup",noRedirect:!0})).then(function(t){var a,n=t.d.ValidateUpdateListItem.results[0];if(n.HasException)throw new Error(n.ErrorMessage||void 0);e(Object(qe.b)({items:(a={},a[r]=[P.childItemsFacet],a)}))})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}var U,I,_,S})})}});var sa=r("264a40ebead766e0e784"),ca=new sa.a("getDefaultShareLinkActionControl");function ua(e){for(var t=e,r="",a=0,n=void 0,i=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|i)||(l="=",i%1);r+=l.charAt(63&a>>8-i%1*8)){if((n=t.charCodeAt(i+=.75))>255)throw new Error("Unable to obtain default share URL: btoa failed");a=a<<8|n}return r}var da=Object(_.a)()(function(){return function(e){return ma}});function ma(e,t){var r=t.itemKey,a=e.demandItem({driveItem:m.spItemKeyFacet,canonicalLinkUrl:x.canonicalUrlFacet},r),i=a.driveItem,l=a.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s,c;return n.__generator(this,function(n){switch(n.label){case 0:if(t=e.driveItem,a=e.canonicalLinkUrl,t&&a)return[3,1];throw new Error("Unable to obtain default share URL");case 1:return i=void 0,a&&(l=ua(a.toString()),i="u!"+l.replace("=","").replace("/","_").replace("+","-")),o=t.webAbsoluteUrl.split("/"),s=o[0]+"//"+o[2],[4,r(Object(N.c)({webAbsoluteUrl:s,listFullUrl:void 0,url:s+"/_api/v2.0/shares/"+i+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(c=n.sent()).value[0].link.webUrl,scope:c.value[0].link.scope}]}})})}}({driveItem:i,canonicalLinkUrl:l})}}}var pa=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.bNewDocumentUpdate,i=r.checkInComment,l=r.formValues,o=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,s,c,u,d;return n.__generator(this,function(n){switch(n.label){case 0:return l.length>0?[4,e(at(t))]:[3,3];case 1:return r=n.sent(),s=r.key,c=r.itemId,u=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(E.a)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).method("ValidateUpdateListItem").toString()}({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:c||s.itemId||""}),(d={}).formValues=l,d.bNewDocumentUpdate=a,d.checkInComment=i,[4,e(Object(N.c)({body:JSON.stringify(d),listFullUrl:s.listFullUrl,method:"POST",qosName:o,url:u,webAbsoluteUrl:s.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:n.sent(),n.label=3;case 3:return[2]}})})}});var fa=new y.Facet("refreshItemsInSet");Object(j.f)({operationTypeFacet:fa});var ba=r("7ac3ab87caf33903810b");function va(e){return function(t){var r,a,i,l,o=e.itemSetKey,s=e.itemKeys,c=t(Object(ie.a)(function(e){var t=e.demandItemFacet(m.spFolderItemSetKeyFacet,o)||m.spFolderItemSetKeyFacet.deserialize(o);return n.__assign({},t,{pageContext:Object(ba.a)(e,m.spItemKeyFacet.serialize(t))})})),u=c.webAbsoluteUrl,d=c.listFullUrl,p=c.pageContext,f=[];try{for(var b=n.__values(s),v=b.next();!v.done;v=b.next()){var y=v.value,h=m.spItemKeyFacet.deserialize(y).itemId;if(!h)h=t(Object(he.a)({listItemId:D.listItemIdFacet},y)).listItemId;h&&f.push(h)}}catch(e){r={error:e}}finally{try{v&&!v.done&&(a=b.return)&&a.call(b)}finally{if(r)throw r.error}}var F=t(function(e,t){return function(r){var a,i,l=r(Object(he.a)({schema:P.schemaFacet},t)).schema,o=l&&l.columnKeys,s=[];if(o)try{for(var c=n.__values(o),u=c.next();!u.done;u=c.next()){var d=u.value,m=r(Object(he.a)(e,d));s.push(m)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}return s}}({internalName:D.internalNameFacet},o)),g=[];if(F)try{for(var w=n.__values(F),U=w.next();!U.done;U=w.next()){var I=U.value;I.internalName&&g.push(I.internalName)}}catch(e){i={error:e}}finally{try{U&&!U.done&&(l=w.return)&&l.call(w)}finally{if(i)throw i.error}}return{webAbsoluteUrl:u,listFullUrl:d,currentPageContext:p,qosName:"refreshItemsInSet",viewXml:Object(ye.getViewXml)({itemIds:f,recurseInFolders:!0,pageSize:s.length,fieldNames:g.length>0?g:void 0}),postDataContext:{needsSchema:!0}}}}var ya=Object(i.e)()(function(e){var t=e.itemKey;return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,l,o,s,c;return n.__generator(this,function(n){switch(n.label){case 0:return a=m.spFolderItemSetKeyFacet.deserialize(t),i=r(Object(je.c)({itemSetKey:a})),l=Object.keys(e.options),[4,r(va({itemSetKey:t,itemKeys:l}))];case 1:return o=n.sent(),[4,r(Object(be.a)(o))];case 2:return s=n.sent(),c=r(Object(ve.a)({serverData:s,itemSetKey:a,currentPageContext:o.currentPageContext,contentTypes:i,isItemSetRequest:!0})).itemResolver,r(c.execute()),[2]}})})}}),ha=new sa.a("permissionInviteActionControl"),Fa=Object(_.a)()(function(){return function(e){return ga}});function ga(e,t){var r=t.itemKey,a=t.recipients,i=e.demandItem({driveItem:m.spItemKeyFacet,canonicalLinkUrl:x.canonicalUrlFacet},r),l=i.driveItem,o=i.canonicalLinkUrl;return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,l,o,s,c,u,d,m,p;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.driveItem,a=e.canonicalLinkUrl,i=e.recipients,t?(l=void 0,a&&(o=ua(a.toString()),l="u!"+o.replace("=","").replace("/","_").replace("+","-")),s=i.map(function(e){return{email:e}}),c={recipients:s,roles:["read"]},u=t.webAbsoluteUrl.split("/"),d=u[0]+"//"+u[2],[4,r(Object(N.c)({webAbsoluteUrl:d,listFullUrl:void 0,url:d+"/_api/v2.0/shares/"+l+"/permission/invite",body:JSON.stringify(c),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))]):[3,2];case 1:return m=n.sent(),p=m.value.splice(m.value.length,1).map(function(e){return{email:e.grantedTo.user.email}}),[2,{recipients:p}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}}({driveItem:l,canonicalLinkUrl:o,recipients:a})}}}var wa=r("661b65dcf8351e92fe44"),Ua=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItemFacet(m.spItemKeyFacet,r);if(!a)return{};var n={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl},i=e.demandItemFacet(D.listFacet,m.spListKeyFacet.serialize(n)),l=e.demandItemFacet(D.spPageContextFacet,m.spPageContextKeyFacet.serialize(n));if(!l)return{};var o=i&&i.templateType===cr.ListTemplateType.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:l.currentUICultureName||l.currentCultureName||"en-US",client:o?"OneDrive":"SharePoint",domainHint:"organizations",userId:l.userLoginName}}}}});var Ia=r("83f2d47bcced97f0a85c"),_a=r("4fab54035bc77294dc42"),Sa=r("6dec44e5485412f70439"),Oa=Object(_.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=void 0,n=e.dispatch(Object(he.a)({key:m.spItemKeyFacet,driveItemKey:_a.a},r)),i=n.key,l=n.driveItemKey;if(l)return{driveItemFullUrl:Object(Sa.b)(l)};if(i){var o={webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl},s=e.dispatch(Object(he.a)({listMediaFacets:Fe.b},m.spListKeyFacet.serialize(o))).listMediaFacets;if(s&&s[".driveUrl"]){var c=s[".driveUrl"],u=i.rootFolder||"",d="";if(u){var p=new Y.a({context:{webAbsoluteUrl:i.webAbsoluteUrl,listUrl:i.listFullUrl}}),f=p.getUrlParts();f.serverRelativeListUrl&&"/"!==(d=u.replace(f.serverRelativeListUrl,"")).charAt(0)&&(d="/"+d)}return{driveItemFullUrl:a=c+"/items/root"+(d?":":"")+d}}}return{driveItemFullUrl:a}}}});var Aa=r("9478e86dcd48357093ed"),Ka=r("87e95cd1ff4b249d307f"),Ta=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.aggregateType,i=r.columnKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,l,o,s,c,u,d,p,f,b,v,y,h;return n.__generator(this,function(n){switch(n.label){case 0:return(o=e(Object(he.a)({setKey:m.spFolderItemSetKeyFacet},t)).setKey)&&((s=o.viewKey?m.spViewKeyFacet.serialize(o.viewKey):void 0)&&(c=e(Object(he.a)({currentDerivedView:D.currentDerivedViewFacet},s)).currentDerivedView))?(u=e(Object(he.a)({internalName:D.internalNameFacet,fieldType:D.fieldTypeFacet,fieldFieldType:D.fieldFieldTypeFacet},i)),d=u.internalName,p=u.fieldType,f=u.fieldFieldType,d?(b=e(Object(he.a)({spFolderAggregates:D.columnTotalsFacet},t)).spFolderAggregates,v=c.isDirty(),y=b&&b[i]?b[i].aggregateFunctionType:void 0,(h=Aa.a[a])===y&&(h=void 0),c.updateColumnAggregateType(d,h),[4,e(Object(U.a)({items:(r={},r[m.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl})]={views:(l={},l[s]={shouldSaveAggregationsOnly:!0},l),qosName:"SaveModifyColumnAggregateType"},r)})).then(function(){var r;c.setIsDirty(v);var a=new G.a;a.invalidateItems({items:(r={},r[t]=[P.childItemsFacet],r[s]=[D.spAggregatesFacet],r)}),e(a.execute())},function(e){throw Ka.default.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:p,fieldFieldType:f,currentAggregateType:y||"None",newAggregateType:h||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),c.updateColumnAggregateType(d,y),c.setIsDirty(v),e})]):[3,2]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})}}),ja=r("f594c3c93ec9f3598a3f");r.d(t,"spDataOnlyAddonDeferred",function(){return Ca});var Ca=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(i.f)(m.spItemGroupKeyFacet,u.a)(Ce)),e(Object(i.f)(m.spNeedsAttentionItemKeyFacet,u.a)(ke)),e(Object(i.f)(m.spFilterOptionSetKeyFacet,u.a)(Ve)),e(Object(i.f)(m.spItemKeyFacet,l.b)(He)),e(Object(i.f)(m.spItemKeyFacet,f.c)(et)),e(Object(i.f)(m.spItemKeyFacet,b.b)(it)),e(Object(i.f)(m.spItemKeyFacet,v.b)(lt)),e(Object(i.f)(m.spItemKeyFacet,o.b)(ct)),e(Object(i.f)(m.spItemKeyFacet,s.b)(pt)),e(Object(_.d)(m.spItemKeyFacet,S.a)(yt)),e(Object(i.f)(m.spItemKeyFacet,d.d)(At)),e(Object(i.f)(m.spItemKeyFacet,d.b)(Ct)),e(Object(i.f)(m.spPinnedItemSetKeyFacet,p.a)(Nt)),e(Object(i.f)(m.spItemKeyFacet,F)(oa)),e(Object(i.f)(m.spListViewsSetKeyFacet,I.b)(Gt)),e(Object(i.f)(m.spListViewsSetKeyFacet,w.b)(Wt)),e(Object(i.f)(m.spListViewsSetKeyFacet,U.b)(Zt)),e(Object(i.f)(m.spFolderItemSetKeyFacet,O.b)(er)),e(Object(i.f)(m.spFolderItemSetKeyFacet,ja.b)(Ta)),e(Object(i.f)(m.spFolderItemSetKeyFacet,C)(tr)),e(Object(i.f)(m.spFolderItemSetKeyFacet,fa)(ya)),e(Object(i.f)(m.spItemKeyFacet,c.b)(Sr)),e(Object(i.f)(m.spItemGroupKeyFacet,c.b)(Dr)),e(Object(i.f)(m.likedByItemKeyFacet,u.a)(Qt)),e(Object(i.f)(m.spListViewsSetKeyFacet,u.a)(Rr)),e(Object(i.f)(m.legacyCustomActionSetKeyFacet,u.a)(Br)),e(Object(i.f)(m.tenantAppCustomActionSetKeyFacet,u.a)(Gr)),e(Object(i.f)(m.customActionSetKeyFacet,u.a)(Wr)),e(Object(_.d)(m.spItemKeyFacet,A.a)(ra)),e(Object(_.d)(m.spItemKeyFacet,K.a)(na.a)),e(Object(_.d)(m.spItemKeyFacet,T.a)(ia)),e(Object(i.f)(m.spWebPageContextKeyFacet,u.a)(la)),e(Object(i.f)(m.spFolderItemSetKeyFacet,Ie)(Oe)),e(Object(i.f)(m.spFolderItemSetKeyFacet,Ae)(Te)),e(Object(_.d)(m.spItemKeyFacet,wa.a)(Ua)),e(Object(_.d)(m.spItemKeyFacet,Ia.a)(Oa)),e(te),e(re.a),e(we),e(ce),e(Object(_.d)(m.spItemKeyFacet,ca)(da)),e(Object(i.f)(m.spItemKeyFacet,St)(pa)),e(Object(_.d)(m.spItemKeyFacet,ha)(Fa)),[2]})})}})},c70c28d41140929c0281:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var a=r("98bae3dbabd51089d613"),n=r("69cac92887c58482641e");function i(e){var t=this;return function(r,i){return a.__awaiter(t,void 0,void 0,function(){var t,i,l,o,s,c,u,d;return a.__generator(this,function(m){switch(m.label){case 0:o=3,m.label=1;case 1:m.trys.push([1,6,7,12]),s=a.__asyncValues(r(Object(n.a)(e))),m.label=2;case 2:return[4,s.next()];case 3:if((c=m.sent()).done)return[3,5];if(u=c.value,l={result:u},--o<0)throw new Error("Unable to resolve items.");m.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return d=m.sent(),t={error:d},[3,12];case 7:return m.trys.push([7,,10,11]),c&&!c.done&&(i=s.return)?[4,i.call(s)]:[3,9];case 8:m.sent(),m.label=9;case 9:return[3,11];case 10:if(t)throw t.error;return[7];case 11:return[7];case 12:if(!l)throw new Error("No result.");return[2,l.result]}})})}}},cfef2ab49d0d7bc1e869:function(e,t,r){"use strict";var a,n=r("d6e6a1e726db94fe6759"),i=r("4986dedaa57d766e48bb")._Qr9VWNQuRRaLzAyN3mwy4A;function l(e){return function(t){return function(e,t){switch(e){case a.InvalidCharacters:return n.format(i.invalidNameError,t.invalidCharacters);case a.InvalidStart:return n.format(i.invalidNameStartError,t.cannotStartWith);case a.InvalidEnd:return n.format(i.invalidNameEndError,t.cannotEndWith);case a.Empty:return i.emptyNameError;case void 0:return}}(function(e,t){var r=e.trim();return 0===r.length?a.Empty:t.invalidCharactersRegex.test(r)?a.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(r)?a.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(r)?a.InvalidEnd:void 0}(t,e),e)}}r.d(t,"a",function(){return o}),r.d(t,"b",function(){return s}),function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(a||(a={}));var o=l({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),s=l({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},d0af51c98de7406fa9c5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var r=t.createElement("form");r.action=e.url,r.method="POST",r.style.visibility="hidden",r.target="_self";var a=e.postdata;for(var n in a)if(a.hasOwnProperty(n)){var i=t.createElement("input");i.type="hidden",i.name=n,i.value=a[n],r.appendChild(i)}t.body.appendChild(r),r.submit()}},e2ea1f13f9b3e771ed24:function(e,t,r){"use strict";var a;r.r(t),r.d(t,"DocumentType",function(){return a}),function(e){e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PowerPoint=3]="PowerPoint",e[e.OneNote=4]="OneNote",e[e.ExcelSurvey=5]="ExcelSurvey",e[e.Text=6]="Text",e[e.ExcelForm=7]="ExcelForm",e[e.Visio=8]="Visio",e[e.Bohemia=9]="Bohemia",e[e.Prague=10]="Prague"}(a||(a={})),t.default=a},f553bf0f97ddfedc1f32:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"c",function(){return i}),r.d(t,"b",function(){return l});var a=r("447964f318fe44ff3682"),n=new a.Facet("enabledForMultipleItems"),i=new a.Facet("isEnabledFunction"),l=new a.Facet("iconUrl")},f594c3c93ec9f3598a3f:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.Facet("modifyColumnAggregateType"),l=Object(n.f)({operationTypeFacet:i})},f698cfbaff8a2434ab85:function(e,t,r){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut"}(a||(a={})),t.a=a},f805b591e29f83f7dfba:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r("98bae3dbabd51089d613").__exportStar(r("90e9dbb8f74ee9c49c51"),t)}}]);
//# sourceMappingURL=precompiled-addon-sp-deferredactions.min.dfae4fe2e9002ddd9f87.js.map