var Microsoft;!function(e){!function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(e.BondDataType||(e.BondDataType={}));!function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.ProtocolType||(e.ProtocolType={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){!function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n}(e.Collections||(e.Collections={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(t){!function(e){var i=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();e.Utf8=i;var r=function(){function e(){}return e.GetString=function(e){var t,n,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],s=e.length%3;for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(function(e){return[r.charAt(e>>18&63),r.charAt(e>>12&63),r.charAt(e>>6&63),r.charAt(63&e)].join("")}(n));switch(s){case 1:n=e[e.length-1],o.push(r.charAt(n>>2)),o.push(r.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(r.charAt(n>>10)),o.push(r.charAt(n>>4&63)),o.push(r.charAt(n<<2&63)),o.push("=")}return o.join("")},e}();e.Base64=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=o;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();e.Varint64=s;var a=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(4));i.setFloat32(0,e,!0);for(var r=[],o=0;o<4;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!1)},e}();e.Float=a;var u=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(8));i.setFloat64(0,e,!0);for(var r=[],o=0;o<8;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!0)},e}();e.Double=u;var c=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,i=e.high,r=i<<1|n>>>31,o=n<<1;2147483648&i&&(r=~r,o=~o);var s=new t.UInt64("0");return s.low=o,s.high=r,s},e}();e.Zigzag=c}(t.Encoding||(t.Encoding={}));!function(i){var r=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){r=e[++n];t.push(String.fromCharCode((31&i)<<6|63&r))}else if(i<=239){var r=e[++n],o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else i=(7&i)<<18|(63&(r=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}return t.join("")},e}();i.Utf8=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i));n.push(r<<2|o>>4),s>=0&&(n.push(o<<4&240|s>>2),a>=0&&n.push(s<<6&192|a))}return n},e}();i.Base64=o;var s=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),i=this._Read(t);return n.low=i[0],i.length>1&&(n.high=i[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){if(i=0!=(128&(o=e.shift())),o&=127,!(r<28)){n|=o<<r,t.push(n),n=o>>4,r=3;break}n|=o<<r,r+=7}for(;i;){var o=e.shift();if(i=0!=(128&o),o&=127,n|=o<<r,(r+=7)>=32)break}return t.push(n),t},t}();i.Varint=s;var a=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(4)),r=0;r<4;++r)i.setUint8(r,e[r]);return i.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e}();i.Float=a;var u=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(8)),r=0;r<8;++r)i.setUint8(r,e[r]);return i.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e}();i.Double=u;var c=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,i=t.high>>>1,r=1&t.low,o=t.low>>>1;o|=n<<31,r&&(o^=4294967295,i^=4294967295);var s=new e.Bond.UInt64("0");return s.low=o,s.high=i,s},t}();i.Zigzag=c}(t.Decoding||(t.Decoding={}));var n=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?11:8,i=t?52:23,r=(1<<n-1)-1,o=1-r,s=r,a=e<0?1:0;e=Math.abs(e);for(var u=Math.floor(e),c=e-u,l=2*(r+2)+i,d=new Array(l),_=0;_<l;)d[_++]=0;for(_=r+2;_&&u;)d[--_]=u%2,u=Math.floor(u/2);for(_=r+1;_<l-1&&c>0;)(c*=2)>=1?(d[++_]=1,--c):d[++_]=0;for(var p=0;p<l&&!d[p];++p);var h=r+1-p,f=p+i;if(d[f+1]){for(_=f;_>p&&!(d[_]=1-d[_]);--_);_==p&&++h}if(h>s||u)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<o)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(_=0;_<20;++_)g=g<<1|d[++p];for(var T=0;_<52;++_)T=T<<1|d[++p];return v=[255&T,T>>8&255,T>>16&255,T>>>24,255&(g=a<<31|2147483647&(g|=h+r<<20)),g>>8&255,g>>16&255,g>>>24]}var y=0;for(_=0;_<23;++_)y=y<<1|d[++p];var v=[255&(y=a<<31|2147483647&(y|=h+r<<23)),y>>8&255,y>>16&255,y>>>24];return v},e.ConvertArrayToNumber=function(e,n){var i=(1<<(n?11:8)-1)-1,r=0!=(128&e[n?7:3]),o=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new t.Exception("Not a valid float/double buffer.");var s=1,a=1;if(n){var u=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!u&&!c)return 0;for(d=0;d<20;++d)a/=2,u<0&&(s+=a),u<<=1;for(d=0;d<32;++d)a/=2,c<0&&(s+=a),c<<=1}else{var l=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!l)return 0;for(var d=0;d<23;++d)a/=2,l<0&&(s+=a),l<<=1}return s*=Math.pow(2,o-i),r?0-s:s},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}()}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){!function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}();t.MemoryStream=n}(e.IO||(e.IO={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){var t=function(){return function(e,t){this.Type=e,this.Id=t}}();e.FieldTag=t;var n=function(){return function(e,t){this.ElementType=e,this.Size=t}}();e.ContainerTag=n;var i=function(){return function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}}();e.KeyValueContainerTag=i;var r=function(){return function(){}}();e.Bonded=r;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.Int64=o;var s=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.UInt64=s;var a=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=a;var u=function(){return function(e){this.Message=e}}();e.Exception=u;var c=function(){return function(){}}();e.KeyValuePair=c;var l=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=l}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){!function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}();e.CompactBinaryProtocolWriter=t;var n=function(){return function(){}}();e.CompactBinaryProtocolReader=n}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var sct;!function(e){var t=function(){function e(){}return e.IsSafariOrFirefox=function(){return null===e._isSafariOrFirefox&&e._DetectBrowser(),e._isSafariOrFirefox},e.ajax=function(t){var n=e._createConnection();if(t.headers){var i="qsp=true";for(var r in t.headers)i+="&",i+=encodeURIComponent(r),i+="=",i+=encodeURIComponent(t.headers[r]);t.url.indexOf("?")<0?t.url+="?":t.url+="&",t.url+=i}n.open(t.type,t.url),t.complete&&(n.onload=function(){void 0===n.status&&(n.status=200),t.complete(n)},n.ontimeout=function(){void 0===n.status&&(n.status=500),t.complete(n)},n.onerror=function(){t.complete(n)}),n.send(t.data)},e.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.IsUsingXDomainRequest=function(){if(null==e._usingXDomainRequest){var t=new XMLHttpRequest;e._usingXDomainRequest=void 0===t.withCredentials&&"undefined"!=typeof XDomainRequest}return e._usingXDomainRequest},e._createConnection=function(){var t=new XMLHttpRequest;return e.IsUsingXDomainRequest()?new XDomainRequest:t},e._DetectBrowser=function(){var t=navigator.userAgent.toLowerCase();e._isSafariOrFirefox=(t.indexOf("safari")>=0||t.indexOf("firefox")>=0)&&t.indexOf("chrome")<0},e._isSafariOrFirefox=null,e._usingXDomainRequest=null,e}();e.Utils=t}(sct||(sct={}));var microsoft;!function(e){!function(e){!function(e){!function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();t.utils=n;!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={}));!function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(t.PIIScrubber||(t.PIIScrubber={}));!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.PIIKind||(t.PIIKind={}));var i=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.PII=i;var r=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,i){var r=new e.datamodels.PII;r.RawContent=n,r.Kind=i,r.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,r)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var i=0;i<this.Extension.GetBuffer().length;++i)t.WriteString(this.Extension.GetBuffer()[i].Key),t.WriteString(this.Extension.GetBuffer()[i].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(var r=0;r<this.PIIExtensions.GetBuffer().length;++r)t.WriteString(this.PIIExtensions.GetBuffer()[r].Key),this.PIIExtensions.GetBuffer()[r].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.Record=r;var o=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.DataPackage=o;var s=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.ClientToCollectorRequest=s}(e.datamodels||(e.datamodels={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var microsoft;!function(e){!function(t){!function(t){!function(n){var i;!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(i=n.CallbackEventType||(n.CallbackEventType={}));var r;!function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(r=n.DATARV_ERROR||(n.DATARV_ERROR={}));var o=function(){function e(e){this._errorCode=r.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case r.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case r.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case r.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case r.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case r.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case r.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();n.Exception=o;var s=function(){return function(){}}();n.TelemetryConfig=s;var a=function(){function e(){}return e.CreateTelemetryManager=function(){return new l},e}();n.TelemetryManagerFactory=a;var u,c=function(){function e(){}return e.MaxPackageSizeInBytes=3e6,e.TimeIntervalForNextSendInMS=15e3,e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(u||(u={}));var l=function(){function n(){this._MaxPackageSizeInBytes=c.MaxPackageSizeInBytes,this._listeners=[],this._status=u.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._isPaused=!1,this._testHookListeners=[]}return n.prototype.Initialize=function(i){if(this._status!=u.Created)throw new o(r.DATARV_ERROR_INVALID_STATUS);if(!i||!i.collectorUrl)throw new o(r.DATARV_ERROR_INVALID_CONFIG);if(this._config=i,this._Reset(),this._status=u.Initialized,i.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=i.ecsClient),i.overwriteSendTimeInterval&&i.overwriteSendTimeInterval>=0&&(c.TimeIntervalForNextSendInMS=i.overwriteSendTimeInterval),i.enableTeamsStats){this.AddListener(function(i,r,o,s){if(!n.defaultLogger){var a=t.LogManager.getDefaultToken();a&&(n.defaultLogger=new e.applications.telemetry.Logger(a))}if(n.defaultLogger){for(var u=s.length,c=0,l=0;l<s.length;++l)"userbi"===s[l].EventType.toLowerCase()&&++c;var d=new t.EventProperties;d.name="scenario",d.setProperty("Scenario_Name","sdk_stats"),200===r?(d.setProperty("AriaStats_EventSentUserBi",c),d.setProperty("AriaStats_EventSent",u)):400===r&&(d.setProperty("AriaStats_EventDropUserBi",c),d.setProperty("AriaStats_EventDrop",u),d.setProperty("AriaStats_EventDropReason",r));var _=t.Logger.popEventReceivedCount();d.setProperty("AriaStats_EventRec",_);var p=t.Logger.popEventRejectCount();d.setProperty("AriaStats_EventReject",p);var h=t.Logger.popTryToSendCount();d.setProperty("AriaStats_TryToSend",h);var f=t.Logger.popEventPackageSize();d.setProperty("AriaStats_PackageSize",f),n.defaultLogger.logEvent(d)}})}this._Verbose("Initialize() done")},n.prototype.AddListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},n.prototype.RemoveListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},n.prototype.Start=function(){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",n._tag].join(" ")),this._status>=u.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++n._tag,this._status=u.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",n._tag].join(""))},n.prototype.Stop=function(){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=u.Initialized?(this._Reset(),this._status=u.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")},n.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e)},n.prototype.SendAsync=function(e,i){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",i.length].join(" ")),this._status<u.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!i)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new o(r.DATARV_ERROR_INVALID_ARG);for(var s=0;s<i.length;++s)if(!i[s].Id||!n._eventTypeRegex.test(i[s].EventType)||i[s].Timestamp.Equals("0"))throw this._Error(["eventId:",i[s].Id,"eventType:",i[s].EventType,"timestamp high:",i[s].Timestamp.high,"timestamp low:",i[s].Timestamp.low].join("")),t.Logger.addEventRejectCount(i.length),new o(r.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,i),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},n.prototype.Pause=function(){this._isPaused||(this._CleanTimer(),this._isPaused=!0)},n.prototype.Resume=function(){this._isPaused&&(this._isPaused=!1,this._ScheduleTimer(!1))},n.prototype._WorkThread=function(e){var i=this;if(this._isPaused)this._CleanTimer();else try{var r=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<u.Started)return void this._Verbose("_WorkThread, status is not started, return");var o=this._eventsCache.DequeuEvents();if(null==o)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var s=o.events.length,a=this._PackEvents(o.tenantToken,o.events);this._eventsCache.AddEvents(o.tenantToken,a.remainedEvents);var c=a.remainedEvents.length;if(null==a.buffer||0==a.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var l=0;l<this._testHookListeners.length;++l)this._testHookListeners[l](a.sendEvents);if(this._testServerResponseHook){var d=this._testServerResponseHook();return void setTimeout(this._SendCallback(p,o.tenantToken,a.sendEvents,d,null),100)}var _={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(t){return i._SendCallback(p,o.tenantToken,a.sendEvents,t,e)}};this._config.useJsonTextStream?(_.data=a.buffer,_.headers["content-type"]="application/json"):sct.Utils.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),_.data=Microsoft.Bond.Encoding.Base64.GetString(a.buffer),_.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),_.data=new Uint8Array(a.buffer)),o.tenantToken&&(_.headers["x-apikey"]=o.tenantToken);var p=n._tag;if(this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(_),this._config.enableTeamsStats){var h=s-c;t.Logger.addTryToSendCount(h),t.Logger.addEventPackageSize(a.buffer.length)}this._Verbose("_Workthread, send via jquery, tag: "+p),this._Info("Processing telemetry events took "+(Date.now()-r)+" ms for "+(s-c)+" events with total size of "+a.buffer.length+" bytes, remaining events - "+c)}catch(e){this._Error("_WorkThread, exception: "+e)}},n.prototype._PackEvents=function(e,n){this._Verbose("_PackageEvents, total Count: "+n.length);var i=new t.datamodels.ClientToCollectorRequest,r=new t.datamodels.DataPackage;r.Source="JS_default_source",r.DataPackageId=t.datamodels.utils.GetGuid(),r.Timestamp=t.datamodels.utils.GetTimeStamp();var o,s=n;if(n=[],s.length>200){var a=s.splice(0,200);n.push.apply(n,s),s=a}for(;;){if(r.Records=[],r.Records.push.apply(r.Records,s),i.DataPackages=[],i.DataPackages.push(r),o=this._Serialize(i),this._Verbose(["_PackageEvents, sendEvents.length:",s.length," buffer.length:",o.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),o.length<this._MaxPackageSizeInBytes)break;if(1==s.length){s=[],o=null;break}var u=s.splice(0,Math.floor(s.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,s),s=u}return this._Verbose(["_PakcageEvents done, sendEventsCount:",s.length,"buffer.length:",null==o?0:o.length,"remained events:",n.length].join("")),{buffer:o,sendEvents:s,remainedEvents:n}},n.prototype._Serialize=function(e){if(this._config.useJsonTextStream){var n=new t.JsonTextWriter;return e.Write(n),JSON.stringify(n.data)}var i=new Microsoft.Bond.IO.MemoryStream,r=new Microsoft.Bond.CompactBinaryProtocolWriter(i);return e.Write(r),i.GetBuffer()},n.prototype._SendCallback=function(e,t,r,o,s){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",n._tag,"tenantToken:",t,"events count:",r.length,"jqXHR:",o].join("")),null==s){var a=null!=o&&o.status>=200&&o.status<300;if(this._status<u.Started||e<n._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(a||o&&400==o.status))return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(t,r),void this._ScheduleTimer(!0);for(var c=0;c<this._listeners.length;++c)this._listeners[c](a?i.SENT:i.SEND_FAILED,o?o.status:0,t,r);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else s(o?o.status:0,t,r)},n.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},n.prototype._ScheduleTimer=function(e){var t=this;if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var n=0,i=(new Date).getTime()-this._lastActiveTime;n=i>c.TimeIntervalForNextSendInMS?0:c.TimeIntervalForNextSendInMS-i,this._timer=setTimeout(function(){return t._WorkThread(null)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},n.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},n.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},n.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},n.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new d,this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)},n.prototype._CreateEcsCallback=function(){var e=this;return function(t){t==ecs.CallbackEventType.CONFIG_UPDATED&&(e._etag=e._ecsClient.GetETag())}},n.prototype.__AddTestHookListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)},n.prototype.__ClearTestHookListener=function(){this._testHookListeners=[]},n.prototype.__GetListenerArray=function(){return this._listeners},n.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},n.prototype.__IsScheduled=function(){return null!=this._timer},n.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},n.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},n.defaultLogger=void 0,n._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,n._tag=0,n}();n.TelemetryManagerImpl=l;var d=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(t.length>1e4||(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}(t._sender||(t._sender={}))}(t.telemetry||(t.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var clienttelemetry_build;!function(e){e.version="2.5.0"}(clienttelemetry_build||(clienttelemetry_build={}));var microsoft;!function(e){!function(e){!function(e){e.globalTelemetryManager=null;var t=function(){return function(){this.collectorUrl=null}}();e.LogConfiguration=t;var n=function(){function t(){this.key=null,this.value=null,this.pii=null}return t._isPii=function(t){if(t==e.datamodels.PIIKind.NotSet)return!1;var n=!1;for(var i in e.datamodels.PIIKind)isNaN(i)||i==t&&(n=!0);return n},t}();e.Property=n;var i=function(){function t(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}return t.prototype.setProperty=function(n,i,s){if(!n||!this.properties[n]&&!t._propertyNameRegex.test(n))throw new o(r.INVALID_PROPERTY_NAME);this.properties[n]={key:n,value:i,pii:s!=e.datamodels.PIIKind.NotSet?s:null}},t.prototype.unsetProperty=function(e){if(!e)throw new o(r.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])},t._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,t}();e.EventProperties=i;var r;!function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(r=e.TelemetryError||(e.TelemetryError={}));var o=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case r.INVALID_TENANT_TOKEN:return"Invalid tenant token";case r.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case r.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case r.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case r.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case r.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case r.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case r.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case r.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}},e}();e.Exception=o;var s=function(){function t(t){this.contextMap=new Microsoft.Bond.Collections.Map,this.piiKind=e.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=t}return t.prototype.setAppId=function(e){e&&this.contextMap.Add("AppInfo.Id",e)},t.prototype.setAppVersion=function(e){e&&this.contextMap.Add("AppInfo.Version",e)},t.prototype.setAppLanguage=function(e){e&&this.contextMap.Add("AppInfo.Language",e)},t.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)},t.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)},t.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)},t.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)},t.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)},t.prototype.setUserId=function(e,t){e&&this.contextMap.Add("UserInfo.Id",e),n._isPii(t)&&(this.piiKind=t)},t.prototype.setUserMsaId=function(e){e&&this.contextMap.Add("UserInfo.MsaId",e)},t.prototype.setUserANID=function(e){e&&this.contextMap.Add("UserInfo.ANID",e)},t.prototype.setUserAdvertisingId=function(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)},t.prototype.setUserTimeZone=function(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)},t.prototype.setUserLanguage=function(e){e&&this.contextMap.Add("UserInfo.Language",e)},t}();e.SemanticContext=s;var a,u=function(){function e(){}return e.initialize=function(t){e.documentInfo=t;var n=t.appLanguage;n&&e.semanticContext.setAppLanguage(n);var i=t.userLanguage;i&&e.semanticContext.setUserLanguage(i);var r=(new Date).getTimezoneOffset(),o=r%60,s=(r-o)/60,a="+";s>0&&(a="-"),o=Math.abs(o);var u=a+((s=Math.abs(s))<10?"0"+s:s.toString())+":"+(o<10?"0"+o:o.toString());e.semanticContext.setUserTimeZone(u),e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion()),e.semanticContext.setDeviceId(t.deviceId),e.firstLaunchTime=t.firstLaunchTime},e.checkAndUpdateDeviceId=function(e){},e._setCookie=function(e,t){},e._getCookie=function(e){return""},e._getUserAgent=function(){return e.documentInfo.userAgent},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isEdgeAnaheim=function(){return e._userAgentContainsString("Edg/")},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isEdge()?e.BROWSERS.EDGE:e._isEdgeAnaheim()?e.BROWSERS.EDGEANAHEIM:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e._isIe()?e.BROWSERS.MSIE:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?function(){var t,n=e._getUserAgent(),i=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return i?i[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0}():function(t){var n;return t===e.BROWSERS.SAFARI?t="Version":t===e.BROWSERS.EDGEANAHEIM&&(t="Edg"),(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?n[1]:e.UNKNOWN_VERSION}(e._getBrowserName())},e._getOsName=function(){var t=/(windows|win32)/i,n=/ arm;/i,i=/windows\sphone\s\d+\.\d+/i,r=/(macintosh|mac os x)/i,o=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,s=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,a=/android/i;return e._getUserAgent().match(i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(n)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(o)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(a)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(s)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(r)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(t)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){function t(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var n=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(n){var i=n[1].replace(/_/g,".");if(i){var r=t(i);return r?i.split(r)[0]:i}}return e.UNKNOWN_VERSION}():e.UNKNOWN_VERSION},e.semanticContext=new s(!0),e.firstLaunchTime=-1,e.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},e.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},e.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},e.REGEX_VERSION="([\\d,.]+)",e.REGEX_VERSION_MAC="([\\d,_,.]+)",e.UNKNOWN_VERSION="Unknown",e.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",e.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",e}();!function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(a=e.SessionState||(e.SessionState={}));var c=function(){function t(){}return t.initialize=function(n,i){if(!t._initialized){if(!i)throw new o(r.INVALID_TENANT_TOKEN);t._defaultToken=i,t._config.collectorUrl||(t._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),e.globalTelemetryManager||(e.globalTelemetryManager=e._sender.TelemetryManagerFactory.CreateTelemetryManager(),e.globalTelemetryManager.Initialize(t._config)),e.globalTelemetryManager.Start(),u.initialize(n),t._initialized=!0}},t.initializeWithConfiguration=function(e,n,i){if(!i.collectorUrl)throw new o(r.INVALID_COLLECTOR_URL);t._config.collectorUrl=i.collectorUrl,t.initialize(e,n)},t.flush=function(t){e.globalTelemetryManager.Flush(t)},t.addCallbackListener=function(n){t._initialized&&e.globalTelemetryManager.AddListener(n)},t.setContext=function(e,n,i){""!==n&&"null"!==n&&"undefined"!==n?t._contextProperties.setProperty(e,n,i):t._contextProperties.unsetProperty(e)},t.isInitialized=function(){return t._initialized},t.getDefaultToken=function(){return t._defaultToken},t.getSemanticContext=function(){return t._semanticContext},t.__addTestHookListener=function(n){t._initialized&&e.globalTelemetryManager.__AddTestHookListener(n)},t.__clearTestHookListener=function(){t._initialized&&e.globalTelemetryManager.__ClearTestHookListener()},t.__backToUninitialized=function(){t._config=new e._sender.TelemetryConfig,t._semanticContext=new s(!0),t._contextProperties=new i,e.globalTelemetryManager=e._sender.TelemetryManagerFactory.CreateTelemetryManager(),t._initialized=!1},t._initialized=!1,t._defaultToken=null,t._config=new e._sender.TelemetryConfig,t._contextProperties=new i,t._semanticContext=new s(!0),t}();e.LogManager=c;var l=function(){function t(t){this._initId=e.datamodels.utils.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new i,this._semanticContext=new s(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=t||c.getDefaultToken()}return t.popEventReceivedCount=function(){var e=t.eventReceivedCount;return t.eventReceivedCount=0,e},t.popEventRejectCount=function(){var e=t.eventRejectCount;return t.eventRejectCount=0,e},t.addEventRejectCount=function(e){t.eventRejectCount+=e},t.popTryToSendCount=function(){var e=t.eventPackageSize;return t.eventPackageSize=0,e},t.addTryToSendCount=function(e){t.eventTryToSendCount+=e},t.popEventPackageSize=function(){var e=t.eventPackageSize;return t.eventPackageSize=0,e},t.addEventPackageSize=function(e){t.eventPackageSize+=e},t.prototype.logEvent=function(e){if(!e.name)throw++t.eventRejectCount,new o(r.MISSING_EVENT_PROPERTIES_NAME);++t.eventReceivedCount;var n=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(n,e),this._sendRecord(n)},t.prototype.logFailure=function(e,t,n,i,s){if(!e)throw new o(r.MISSING_FAILURE_SIGNATURE);if(!t)throw new o(r.MISSING_FAILURE_DETAIL);var a=this._createEventRecord("failure","failure");a.Extension.Add("Failure.Signature",e),a.Extension.Add("Failure.Detail",t),n&&a.Extension.Add("Failure.Category",n),i&&a.Extension.Add("Failure.Id",i),this._addCustomPropertiesToEvent(a,s),this._sendRecord(a)},t.prototype.logPageView=function(e,t,n,i,s,a){if(!e)throw new o(r.MISSING_PAGEVIEW_ID);if(!t)throw new o(r.MISSING_PAGEVIEW_NAME);var u=this._createEventRecord("pageview","pageview");u.Extension.Add("PageView.Id",e),u.Extension.Add("PageView.Name",t),n&&u.Extension.Add("PageView.Category",n),i&&u.Extension.Add("PageView.Uri",i),s&&u.Extension.Add("PageView.ReferrerUri",s),this._addCustomPropertiesToEvent(u,a),this._sendRecord(u)},t.prototype.logSession=function(t,n){if(t!==a.STARTED&&t!==a.ENDED)throw new o(r.INVALID_SESSION_STATE);var i=this._createEventRecord("session","session");if(t===a.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=e.datamodels.utils.GetGuid(),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Started")}else if(t===a.ENDED){if(0==this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.Extension.Add("Session.Duration",s.toString()),i.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(s)),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}i.Extension.Add("Session.FirstLaunchTime",new Date(u.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(i,n),this._sendRecord(i)},t.prototype.getSessionId=function(){return this._sessionId},t.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},t.prototype.getSemanticContext=function(){return this._semanticContext},t.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},t.prototype._createEventRecord=function(t,n){var i=new e.datamodels.Record;n||(n="custom"),i.EventType=t.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,i.Extension.Add("EventInfo.Sequence",this._sequence.toString()),i.Extension.Add("EventInfo.Name",t.toLowerCase());var r=new Date;return i.Timestamp=e.datamodels.utils.GetTimeStampWithValue(r.getTime()),i.Extension.Add("EventInfo.Time",r.toISOString()),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version),i},t.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,u.semanticContext),this._addSemanticContext(e,c._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,c._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},t.prototype._addSemanticContext=function(t,n){if(n&&n.contextMap.Count()>0)for(var i=n.contextMap.GetBuffer(),r=0;r<i.length;r++)"UserInfo.Id"==i[r].Key&&n.piiKind!=e.datamodels.PIIKind.NotSet?t.AddOrReplacePII(i[r].Key,i[r].Value,n.piiKind):t.Extension.AddOrReplace(i[r].Key,i[r].Value)},t.prototype._addEventPropertiesToEvent=function(t,i){if(i){i.timestamp&&i.timestamp>=new Date("1/1/2000").getTime()&&(t.Timestamp=e.datamodels.utils.GetTimeStampWithValue(i.timestamp),t.Extension.AddOrReplace("EventInfo.Time",new Date(i.timestamp).toISOString())),i.name&&(t.EventType=i.name.toLowerCase(),t.Extension.AddOrReplace("EventInfo.Name",i.name.toLowerCase()));var r=i.properties;if(r)for(var o in r)r[o].key&&"string"==typeof r[o].key&&(r[o].value||0==r[o].value||0==r[o].value||""==r[o].value)&&(n._isPii(r[o].pii)?(t.AddOrReplacePII(r[o].key,r[o].value.toString(),r[o].pii),t.Extension.Remove(r[o].key)):(t.Extension.AddOrReplace(r[o].key,r[o].value.toString()),t.PIIExtensions.Remove(r[o].key)))}},t.prototype._sendRecord=function(t){c.isInitialized()&&e.globalTelemetryManager.SendAsync(this._tenantToken,[t])},t.eventReceivedCount=0,t.eventRejectCount=0,t.eventTryToSendCount=0,t.eventPackageSize=0,t}();e.Logger=l}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var ecs;!function(e){var t;!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(t=e.ECS_ERROR||(e.ECS_ERROR={}));var n=function(){function e(e){this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case t.ECS_ERROR_OK:return"ECS_ERROR_OK";case t.ECS_ERROR_INVALID_STATUS:return"ECS_ERROR_INVALID_STATUS";case t.ECS_ERROR_INVALID_RESPONSE:return"ECS_ERROR_INVALID_RESPONSE";case t.ECS_ERROR_INVALID_CONFIG:return"ECS_ERROR_INVALID_CONFIG";default:return"Unknown error"}},e}();e.Exception=n;var i;!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(i=e.CallbackEventType||(e.CallbackEventType={}));var r=function(){function e(){}return e.prototype.Copy=function(e){if(this.uiVersion=e.uiVersion,this.log=e.log,this.servers=void 0,e.servers&&e.servers.length){this.servers=[];for(var t=0;t<e.servers.length;++t)this.servers.push(e.servers[t])}},e}();e.EcsClientConfig=r;var o=function(){function e(){}return e.CreateEcsClient=function(){return new u},e.__ChangeFailedRetryFactorInMS=function(e){a.FailedRetryFactorInMS=e},e}();e.EcsClientFactory=o;var s,a=function(){function e(){}return e.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],e.RefreshIntervalInMS=36e5,e.FailedRetryFactorInMS=1e4,e.MaxRetryIntervalForFailedInMS=36e5,e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(s||(s={}));var u=function(){function e(){this._tag=0,this._status=s.Created,this._listeners=[],this._failedTimes={},this._skypeToken=null,this._pendingToken=[],this._queryParams={}}return e.prototype.Initialize=function(e){if(this._status!=s.Created)throw new n(t.ECS_ERROR_INVALID_STATUS);if(!e||!e.uiVersion)throw new n(t.ECS_ERROR_INVALID_CONFIG);this._config=new r,this._config.Copy(e),this._config.uiVersion=this._config.uiVersion.replace("/","_");var i=[];if(this._config.servers&&this._config.servers.length)i=this._config.servers;else for(var o=0;o<a.Servers.length;++o)i.push(a.Servers[o]);for(var u=[];i.length;){var c=Math.floor(Math.random()*i.length);u.push(i[c]),c==i.length-1?i.pop():i[c]=i.pop()}this._config.servers=u,this._Info("servers: "+this._config.servers.join(",")),this._status=s.Initialized,this._Verbose("Initialize() done")},e.prototype.AddListener=function(e){this._Verbose("AddListener()"),this._CheckStatus(s.Initialized);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e)},e.prototype.RemoveListener=function(e){this._Verbose("RemoveListener()"),this._CheckStatus(s.Initialized);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void(t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop())},e.prototype.Start=function(){this._Verbose("Start()"),this._CheckStatus(s.Initialized),this._status>=s.Started?this._Verbose("Start() already, ignore"):(++this._tag,this._status=s.Started,this.ConfigReloadAsync())},e.prototype.Stop=function(){this._Verbose("Stop()"),this._CheckStatus(s.Initialized),this._status!=s.Initialized?(this._CleanTimer(),this._ecsConfig=null,this._etag=null,this._expireTime=null,this._failedTimes={},this._status=s.Initialized):this._Verbose("Stop() already, ignore")},e.prototype.GetETag=function(){return this._CheckStatus(s.Started),this._etag},e.prototype.SetSkypeToken=function(e){this._Verbose("SetToken()"),this._CheckStatus(s.Started),e=e||null,this._status==s.Loading?(this._Verbose("A request is ongoing, postpone."),this._pendingToken.push(e)):(this._skypeToken=e,this.ConfigReloadAsync())},e.prototype.ConfigReloadAsync=function(){var e=this;if(this._Verbose("ConfigReloadAsync()"),this._CheckStatus(s.Started),this._status!=s.Loading){this._CleanTimer();var t=this._tag,n=this._config.servers[0]+this._config.uiVersion,i={};for(var r in this._queryParams){i[r]={};for(var o in this._queryParams[r])i[r][o]=this._queryParams[r][o]}i.Headers={},!sct.Utils.IsUsingXDomainRequest()&&this._etag&&(i.Headers["If-None-Match"]=this._etag),this._skypeToken&&(i.Headers.SkypeToken=this._skypeToken),0==sct.Utils.keys(i.Headers).length&&delete i.Headers,sct.Utils.ajax({type:"POST",url:n,data:JSON.stringify(i),complete:function(n){return e._HttpCallback(t,n)}}),this._status=s.Loading}else this._Verbose("ConfigReloadAsync() is loading, ignore")},e.prototype.AddQueryParameter=function(e,t,n){if(t&&n){e||(e="global");var i=e.toLowerCase();if("headers"==i)return;i in this._queryParams||(this._queryParams[i]={}),this._queryParams[i][t.toLowerCase()]=n.toLowerCase()}},e.prototype.RemoveQueryParameter=function(e,t){var n="global";e&&(n=e.toLowerCase()),t&&(t=t.toLowerCase(),n in this._queryParams&&t in this._queryParams[n]&&(delete this._queryParams[n][t],0==sct.Utils.keys(this._queryParams[n]).length&&delete this._queryParams[n]))},e.prototype.RemoveQueryParameterByNamespace=function(e){e=e?e.toLowerCase():"global",delete this._queryParams[e]},e.prototype.GetSetting=function(e,t,n){return this._CheckStatus(s.Started),e?this._GetSettingAsDefault(e,t,n,JSON.stringify):this._ecsConfig?JSON.stringify(this._ecsConfig):""},e.prototype.GetSettingAsString=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,function(e){return""+e})},e.prototype.GetSettingAsInt=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,parseInt)},e.prototype.GetSettingAsBool=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,function(e){return!!e})},e.prototype.GetSettingAsReal=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,parseFloat)},e.prototype.GetSettingAsList=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,function(e){return""+e})},e.prototype.GetSettingAsListOfInts=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,parseInt)},e.prototype.GetSettingAsListOfReal=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,parseFloat)},e.prototype.GetKeys=function(e,t){if(this._CheckStatus(s.Started),!e)return this.GetAgents();var n=this._NormalizePath(e,t);return n?this._GetObjectKeys(this._GetObject(n)):[]},e.prototype.GetAgents=function(){return this._CheckStatus(s.Started),this._GetObjectKeys(this._ecsConfig)},e.prototype._HttpCallback=function(e,r){if(this._Verbose("_HttpCallback"),this._status==s.Loading&&e==this._tag){var o=!0,a=!1;try{if(null==r)throw this._Error("jqXHR is null. exception"),new n(t.ECS_ERROR_INVALID_RESPONSE);var u=this._ParseResponse(r),c=u.statuscode;if(this._Info("status of HttpCallback: "+c),c>=200&&c<=299){var l=u.etag;if(this._Verbose("etag: "+l),!l)throw new n(t.ECS_ERROR_INVALID_RESPONSE);u.expires;this._Verbose("2xx: JSON.parse() success."),this._etag=l,this._ecsConfig=u.data,this._expireTime=u.expires,this._Notify(i.CONFIG_UPDATED)}else switch(c){case 304:this._Verbose("Config is not changed. Update expire time only."),this._expireTime=u.expires;break;case 401:this._Warning("token is invalid"),o=!1,this._Notify(i.TOKEN_IS_INVALID);break;case-1:o=!1;break;default:throw new n(t.ECS_ERROR_INVALID_RESPONSE)}}catch(e){this._Error("exception: "+e),a=!0}o&&this._ScheduleTimer(a),this._status=s.Started}else this._Verbose("_status != loading || tag != _tag, ignore")},e.prototype._Notify=function(e){for(var t=0;t<this._listeners.length;++t)this._listeners[t](e)},e.prototype._ScheduleTimer=function(e){var t=this;if(this._CleanTimer(),e){var n=this._config.servers.shift();this._failedTimes[n]?++this._failedTimes[n]:this._failedTimes[n]=1,this._config.servers.push(n);var i=this._failedTimes[this._config.servers[0]]||0,r=0;i&&(r=Math.pow(2,i-1)*a.FailedRetryFactorInMS)>a.MaxRetryIntervalForFailedInMS&&(r=a.MaxRetryIntervalForFailedInMS),this._timer=setTimeout(function(){return t.ConfigReloadAsync()},r)}else{this._failedTimes[this._config.servers[0]]=0;var o=!1;if(this._pendingToken.length){this._Verbose("Pending token found.");var s=this._pendingToken.pop();this._pendingToken.splice(0,this._pendingToken.length),s!=this._skypeToken&&(this._Verbose("Trigger new request immediately."),this._skypeToken=s,o=!0)}r=0;o||(r=a.RefreshIntervalInMS,this._expireTime&&(r=this._expireTime-(new Date).getTime())<0&&(r=0)),this._timer=setTimeout(function(){return t.ConfigReloadAsync()},r)}},e.prototype._CleanTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},e.prototype._GetSettingAsDefault=function(e,t,n,i){if(!e)return n;var r=this._NormalizePath(e,t);if(!r)return n;var o=this._GetObject(r);if(null==o)return n;try{return i(o)}catch(e){return n}},e.prototype._GetSettingAsList=function(e,t,n){if(!e)return[];var i=this._NormalizePath(e,t);if(!i)return[];var r=this._GetObject(i);if(null==r)return[];try{for(var o=[],s=0;s<r.length;++s)o.push(n(r[s]));return o}catch(e){return[]}},e.prototype._CheckStatus=function(e){if(this._status<e)throw this._Error(["status is error, current status:",this._status,"minimalStatus:",e].join(" ")),new n(t.ECS_ERROR_INVALID_STATUS)},e.prototype._GetObjectKeys=function(e){var t=[];if(null!=e)for(var n in e)t.push(n);return t},e.prototype._GetObject=function(e){for(var t=e.split("/"),n=this._ecsConfig,i=0;i<t.length&&n;++i)n=n[t[i]];return n},e.prototype._NormalizePath=function(e,t){return null!=t&&t.length&&"/"==t[0]&&(t=t.substr(1)),null!=t&&t.length&&"/"==t[t.length-1]&&(t=t.substr(0,t.length-1)),t?e?e+"/"+t:t:e},e.prototype._Verbose=function(e){this._config&&this._config.log&&this._config.log.Verbose("[EcsClient]: "+e)},e.prototype._Info=function(e){this._config&&this._config.log&&this._config.log.Info("[EcsClient]: "+e)},e.prototype._Warning=function(e){this._config&&this._config.log&&this._config.log.Warning("[EcsClient]: "+e)},e.prototype._Error=function(e){this._config&&this._config.log&&this._config.log.Error("[EcsClient]: "+e)},e.prototype._ParseResponse=function(e){var t={};if(e&&void 0!==e.status)if(304==e.status){r=e.getResponseHeader("Expires");this._Verbose("expires: "+r),t.expires=r?Date.parse(r):null,t.etag=e.getResponseHeader("ETag"),t.statuscode=e.status}else if(e.status>=500)t.statuscode=e.status;else if(0==e.status)this._Verbose("Blocked by same-origin policy."),t.statuscode=-1;else try{t.statuscode=e.status;var n=JSON.parse(e.responseText),i=this._GetHeader(n);if(i){this._Verbose("Header found in body.");var r=i.expires;t.expires=r?Date.parse(r):null,t.statuscode=parseInt(i.statuscode),t.etag=i.etag}else this._Error("Header missing in response body.");t.data=n}catch(e){this._Error("Failed when parsing")}else this._Verbose("IE8/IE9 general error handler."),t.statuscode=-1;return this._Verbose("Return code = "+t.statuscode),t},e.prototype._GetHeader=function(e){var t=null;for(var n in e)if("headers"==n.toLowerCase()){t={};for(var i in e[n])t[i.toLowerCase()]=e[n][i];break}return t},e.prototype.__GetListenerArray=function(){return this._listeners},e.prototype.__UpdateServers=function(e){this._config.servers=e},e.prototype.__GetQueryParameters=function(){return this._queryParams},e}()}(ecs||(ecs={}));var microsoft;!function(e){!function(e){!function(e){var t=function(){function e(){this.data=[]}return e.prototype.WriteBlob=function(e){var t={type:"blob",value:e};this.data.push(t)},e.prototype.WriteBool=function(e){var t={type:"boolean",value:e};this.data.push(t)},e.prototype.WriteContainerBegin=function(e,t){var n={type:"containerBegin",size:e,elementType:t};this.data.push(n)},e.prototype.WriteMapContainerBegin=function(e,t,n){var i={type:"mapContainerBegin",size:e,keyType:t,valueType:n};this.data.push(i)},e.prototype.WriteContainerEnd=function(){var e={type:"containerEnd"};this.data.push(e)},e.prototype.WriteDouble=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteFloat=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteFieldBegin=function(e,t,n){var i={type:"fieldBegin",id:t};this.data.push(i)},e.prototype.WriteFieldEnd=function(){var e={type:"fieldEnd"};this.data.push(e)},e.prototype.WriteFieldOmitted=function(e,t,n){var i={type:"fieldOmitted",id:t};this.data.push(i)},e.prototype.WriteInt16=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteInt32=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteInt64=function(e){var t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)},e.prototype.WriteInt8=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteString=function(e){var t={type:"string",value:e};this.data.push(t)},e.prototype.WriteStructBegin=function(e,t){var n={type:"structBegin",isBase:t};this.data.push(n)},e.prototype.WriteStructEnd=function(e){var t={type:"structEnd",isBase:e};this.data.push(t)},e.prototype.WriteUInt16=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt32=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt64=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt8=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteWString=function(e){var t={type:"string",value:e};this.data.push(t)},e}();e.JsonTextWriter=t}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("webpack",[],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=30)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={}));!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={}));!function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={}));!function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={}));!function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={}));!function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},function(e,t,n){"use strict";function i(e){return"string"==typeof e}function r(e){return"number"==typeof e}function o(e){return"boolean"==typeof e}function s(e){return e instanceof Date}function a(e){return(e+m)*I}function u(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function c(e){return e<10?"0"+e:e.toString()}function l(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}function d(e,t){switch(t=f(t)?t:v.AWTPropertyType.Unspecified){case v.AWTPropertyType.Unspecified:return _(e);case v.AWTPropertyType.String:return i(e)?t:E;case v.AWTPropertyType.Boolean:return o(e)?t:E;case v.AWTPropertyType.Date:return s(e)&&NaN!==e.getTime()?t:E;case v.AWTPropertyType.Int64:return r(e)&&e%1==0?t:E;case v.AWTPropertyType.Double:return r(e)?t:E}return E}function _(e){switch(typeof e){case"string":return v.AWTPropertyType.String;case"boolean":return v.AWTPropertyType.Boolean;case"number":return v.AWTPropertyType.Double;case"object":return s(e)?v.AWTPropertyType.Date:E}return E}function p(e){return!!(r(e)&&e>=0&&e<=13)}function h(e){return!!(r(e)&&e>=0&&e<=1)}function f(e){return!!(r(e)&&e>=0&&e<=4)}function g(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function T(e){return void 0===e||e===E||""===e}Object.defineProperty(t,"__esModule",{value:!0});var y=n(4),v=n(0),S=/[xy]/g,m=621355968e5,I=1e4,E=null;t.EventNameDotRegex=/\./g,t.EventNameAndTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.PropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var A=E,R=E,C=E;t.numberToBondInt64=function(e){var t=new y.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(S,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.isString=i,t.isNumber=r,t.isBoolean=o,t.isDate=s,t.msToTicks=a,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return A===E&&(A="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),A},t.isUint8ArrayAvailable=function(){return R===E&&(R="undefined"!=typeof Uint8Array&&!g()&&!u()),R},t.isPriority=function(e){return!(!r(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||T(n)?E:(T(n.value)&&(n={value:n,type:v.AWTPropertyType.Unspecified}),n.type=d(n.value,n.type),n.type?(s(n.value)&&(n.value=a(n.value.getTime())),n.pii>0&&n.cc>0?E:n.pii?p(n.pii)?n:E:n.cc?h(n.cc)?n:E:n):E)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+c(e.getUTCMonth()+1)+"-"+c(e.getUTCDate())+"T"+c(e.getUTCHours())+":"+c(e.getUTCMinutes())+":"+c(e.getUTCSeconds())+"."+l(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(C===E){var e=new XMLHttpRequest;C=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return C},t.isReactNative=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e,t){for(var n=this,i=this,r=0;r<this.listeners.length;++r)!function(r){i.listeners[r].eventsSent&&setTimeout(function(){return n.listeners[r].eventsSent(e,t)},0)}(r)},e.eventsDropped=function(e,t){for(var n=this,i=this,r=0;r<this.listeners.length;++r)!function(r){i.listeners[r].eventsDropped&&setTimeout(function(){return n.listeners[r].eventsDropped(e,t)},0)}(r)},e.eventsRetrying=function(e){for(var t=this,n=this,i=0;i<this.listeners.length;++i)!function(i){n.listeners[i].eventsRetrying&&setTimeout(function(){return t.listeners[i].eventsRetrying(e)},0)}(i)},e.eventsRejected=function(e,t){for(var n=this,i=this,r=0;r<this.listeners.length;++r)!function(r){i.listeners[r].eventsRejected&&setTimeout(function(){return n.listeners[r].eventsRejected(e,t)},0)}(r)},e.listeners=[],e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(14),r=n(0),o=n(28),s=n(10),a=n(5),u=n(11),c=n(1),l=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(e._config.enableScheduleTimerEvenWithoutEvent||this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout(function(){return e._batchAndSendEvents()},t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),s.default.initialize(function(e,n){if(t._config.canSendStatEvent("awt_stats")){var i=new a.default("awt_stats");i.setEventPriority(r.AWTEventPriority.High),i.setProperty("TenantId",n);for(var o in e)e.hasOwnProperty(o)&&i.setProperty(o,e[o].toString());u.default.getLogger(c.StatsApiKey).logEvent(i)}})},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){this._resetTransmitProfiles();for(var t in e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(i=2;i>=0;--i)if(e[t][i]<0){for(var n=i;n>=0;--n)e[t][n]=-1;break}for(var i=2;i>0;--i)if(e[t][i]>0&&e[t][i-1]>0){var r=e[t][i-1]/e[t][i];e[t][i-1]=Math.ceil(r)*e[t][i]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===r.AWTEventPriority.Immediate_sync&&(e.priority=r.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&(0===this._lastUploadNowCall||this._lastUploadNowCall+3e4<t)&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){s.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=i.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=r.AWTEventPriority.High;++this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=r.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=r.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[i.AWT_REAL_TIME]=[4,2,1],this._profiles[i.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[i.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=i.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=i;var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=r;var o=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(0),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified);var o={value:t,type:n,pii:r.AWTPiiKind.NotSet,cc:r.AWTCustomerContentKind.NotSet};null!==(o=i.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var s={value:t,type:o,pii:n,cc:r.AWTCustomerContentKind.NotSet};null!==(s=i.sanitizeProperty(e,s))?this._event.properties[e]=s:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var s={value:t,type:o,pii:r.AWTPiiKind.NotSet,cc:n};null!==(s=i.sanitizeProperty(e,s))?this._event.properties[e]=s:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={}));!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",s={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},a={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",CROS:"Chrome OS",UNKNOWN:"Unknown"},u={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},c={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},l=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(r),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(r),n=this._getData(o);t!==e&&(n=i.getISOString(new Date)),this._saveData(r,e),this._saveData(o,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(r);e||(e=i.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,i="+";n>0&&(i="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(i+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?s.OPERA:this._userAgentContainsString(s.PHANTOMJS,e)?s.PHANTOMJS:this._userAgentContainsString(s.EDGE,e)?s.EDGE:this._userAgentContainsString(s.ELECTRON,e)?s.ELECTRON:this._userAgentContainsString(s.CHROME,e)?s.CHROME:this._userAgentContainsString("Trident",e)?s.MSIE:this._userAgentContainsString(s.FIREFOX,e)?s.FIREFOX:this._userAgentContainsString(s.SAFARI,e)?s.SAFARI:this._userAgentContainsString(s.SKYPE_SHELL,e)?s.SKYPE_SHELL:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=i.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){return t===s.MSIE?this._getIeVersion(e):this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(s.MSIE+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===s.SAFARI&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(u.WINPHONE)?a.WINDOWS_PHONE:e.match(u.WINRT)?a.WINDOWS_RT:e.match(u.IOS)?a.IOS:e.match(u.ANDROID)?a.ANDROID:e.match(u.LINUX)?a.LINUX:e.match(u.OSX)?a.MACOSX:e.match(u.WIN)?a.WINDOWS:e.match(u.CROS)?a.CROS:"Unknown"},e._getOsVersion=function(e,t){return t===a.WINDOWS?this._getGenericOsVersion(e,"Windows NT"):t===a.ANDROID?this._getGenericOsVersion(e,t):t===a.MACOSX?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?c[n[1]]?c[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(a.MACOSX+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var i=this._getDelimiter(n);return i?n.split(i)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var i="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+i}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n],r=0;" "===i.charAt(r);)r++;if(0===(i=i.substring(r)).indexOf(e))return i.substring(e.length,i.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=n(0),o=n(6),s=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(i.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var i=void 0;switch(t){case r.AWTPiiKind.SipAddress:i=o.AWTUserIdType.SipAddress;break;case r.AWTPiiKind.PhoneNumber:i=o.AWTUserIdType.PhoneNumber;break;case r.AWTPiiKind.SmtpAddress:i=o.AWTUserIdType.EmailAddress;break;default:i=o.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",i.toString())}if(isNaN(t)||null===t||t===r.AWTPiiKind.NotSet||t>13)switch(n){case o.AWTUserIdType.Skype:t=r.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=r.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=r.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=r.AWTPiiKind.SipAddress;break;default:t=r.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),r=n(0),o=n(2),s=n(1),a=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,a=new i.IO.MemoryStream,u=new i.CompactBinaryProtocolWriter(a);u._WriteFieldBegin(i._BondDataType._BT_MAP,3,null),u._WriteMapContainerBegin(t,i._BondDataType._BT_STRING,i._BondDataType._BT_LIST);for(var c in e)if(e.hasOwnProperty(c)){u._WriteString(c);var l=e[c];u._WriteContainerBegin(1,i._BondDataType._BT_STRUCT),u._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),u._WriteString("act_default_source"),u._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),u._WriteString(s.newGuid()),u._WriteFieldBegin(i._BondDataType._BT_INT64,6,null),u._WriteInt64(s.numberToBondInt64(Date.now())),u._WriteFieldBegin(i._BondDataType._BT_LIST,8,null);var d=a._GetBuffer().length+1;u._WriteContainerBegin(e[c].length,i._BondDataType._BT_STRUCT);for(var _=a._GetBuffer().length-d,p=0;p<l.length;++p){var h=a._GetBuffer().length;if(this.writeEvent(l[p],u),a._GetBuffer().length-h>2936012)o.default.eventsRejected([l[p]],r.AWTEventsRejectedReason.SizeLimitExceeded),l.splice(p--,1),a._GetBuffer().splice(h),this._addNewDataPackageSize(l.length,a,_,d);else if(a._GetBuffer().length>2936012){a._GetBuffer().splice(h),n||(n={}),e[c]=l.splice(0,p),n[c]=l,this._addNewDataPackageSize(e[c].length,a,_,d);break}}u._WriteStructEnd(!1)}return u._WriteStructEnd(!1),{payloadBlob:a._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,r){for(var o=i._Encoding._Varint_GetBytes(i.Number._ToUInt32(e)),s=0;s<n;++s){if(!(s<o.length)){t._GetBuffer().slice(r+s,n-s);break}t._GetBuffer()[r+s]=o[s]}},e.writeEvent=function(e,t){t._WriteFieldBegin(i._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(i._BondDataType._BT_INT64,3,null),t._WriteInt64(s.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(i._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},o=0,a={},u=0,c={},l=0,d={},_=0,p={},h=0,f={},g=0,T={},y=0;for(var v in e.properties)if(e.properties.hasOwnProperty(v))if((m=e.properties[v]).cc>0)T[v]=m,y++;else if(m.pii>0)f[v]=m,g++;else switch(m.type){case r.AWTPropertyType.String:n[v]=m.value,o++;break;case r.AWTPropertyType.Int64:a[v]=m.value,u++;break;case r.AWTPropertyType.Double:c[v]=m.value,l++;break;case r.AWTPropertyType.Boolean:d[v]=m.value,_++;break;case r.AWTPropertyType.Date:p[v]=m.value,h++}if(o){t._WriteFieldBegin(i._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,i._BondDataType._BT_STRING,i._BondDataType._BT_STRING);for(var v in n)if(n.hasOwnProperty(v)){S=n[v];t._WriteString(v),t._WriteString(S.toString())}}if(g){t._WriteFieldBegin(i._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(g,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT);for(var v in f)if(f.hasOwnProperty(v)){m=f[v];t._WriteString(v),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(i._BondDataType._BT_INT32,2,null),t._WriteInt32(m.pii),t._WriteFieldBegin(i._BondDataType._BT_STRING,3,null),t._WriteString(m.value.toString()),t._WriteStructEnd(!1)}}if(_){t._WriteFieldBegin(i._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(_,i._BondDataType._BT_STRING,i._BondDataType._BT_BOOL);for(var v in d)if(d.hasOwnProperty(v)){S=d[v];t._WriteString(v),t._WriteBool(S)}}if(h){t._WriteFieldBegin(i._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64);for(var v in p)if(p.hasOwnProperty(v)){S=p[v];t._WriteString(v),t._WriteInt64(s.numberToBondInt64(S))}}if(u){t._WriteFieldBegin(i._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(u,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64);for(var v in a)if(a.hasOwnProperty(v)){S=a[v];t._WriteString(v),t._WriteInt64(s.numberToBondInt64(S))}}if(l){t._WriteFieldBegin(i._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,i._BondDataType._BT_STRING,i._BondDataType._BT_DOUBLE);for(var v in c)if(c.hasOwnProperty(v)){var S=c[v];t._WriteString(v),t._WriteDouble(S)}}if(y){t._WriteFieldBegin(i._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(y,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT);for(var v in T)if(T.hasOwnProperty(v)){var m=T[v];t._WriteString(v),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(m.cc),t._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),t._WriteString(m.value.toString()),t._WriteStructEnd(!1)}}t._WriteStructEnd(!1)},e.base64Encode=function(e){return i._Encoding._Base64_GetString(e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(2),o=n(0),s=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,r.default.addNotificationListener({eventsSent:function(e,n){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout(function(){return t.flush()},6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout(function(){return e.flush()},6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==i.StatsApiKey){var r=i.getTenantId(n);this._stats[r]||(this._stats[r]={}),this._stats[r][e]?this._stats[r][e]=this._stats[r][e]+t:this._stats[r][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(6),o=n(12),s=n(13),a=n(3),u=n(2),c=n(7),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),c.default.addPropertyStorageOverride(this._config.propertyStorageOverride),c.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),a.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(r.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&a.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(r.AWTSessionState.Ended),a.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&a.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&a.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&a.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&a.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,n,r)},e.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,r)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new s.default(t)),this._loggers[t]},e.addNotificationListener=function(e){u.default.addNotificationListener(e)},e.removeNotificationListener=function(e){u.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins),e.enableScheduleTimerEvenWithoutEvent&&(this._config.enableScheduleTimerEvenWithoutEvent=e.enableScheduleTimerEvenWithoutEvent)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0,enableScheduleTimerEvenWithoutEvent:!1},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),r=n(8),o=function(){function e(){}return e.logManagerContext=new i.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new r.default(!0,e.logManagerContext),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(6),o=n(5),s=n(1),a=n(10),u=n(2),c=n(3),l=n(12),d=n(15),_=n(8),p=n(7),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new _.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,r)},e.prototype.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,r)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var n=!0;s.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),n=!1),a.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(l.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,n),o.priority=i.AWTEventPriority.High,t===r.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=s.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==r.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var a=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=a.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(a),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=p.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,r,o,s){if(t&&n){var a={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(a,s),a.properties["Failure.Signature"]=t,a.properties["Failure.Detail"]=n,r&&(a.properties["Failure.Category"]=r),o&&(a.properties["Failure.Id"]=o),a.priority=i.AWTEventPriority.High,this.logEvent(a)}},e.prototype.logPageView=function(t,n,i,r,o,s){if(t&&n){var a={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(a,s),a.properties["PageView.Id"]=t,a.properties["PageView.Name"]=n,i&&(a.properties["PageView.Category"]=i),r&&(a.properties["PageView.Uri"]=r),o&&(a.properties["PageView.ReferrerUri"]=o),this.logEvent(a)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=s.newGuid())},e._addPropertiesToEvent=function(e,t){if(t){t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority);for(var n in t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])}},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&s.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(s.EventNameDotRegex,"_"),e.type&&s.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",s.EventNameAndTypeRegex.test(e.name)?((!s.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),s.isPriority(e.priority)||(e.priority=i.AWTEventPriority.Normal),this._sendEvent(e)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:i.AWTPiiKind.NotSet,type:i.AWTPropertyType.String}},e._sendEvent=function(e){c.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var i in e.properties)e.properties.hasOwnProperty(i)&&(e.properties[i]=s.sanitizeProperty(i,e.properties[i]),null===e.properties[i]&&delete e.properties[i]);var r=e;return r.id=s.newGuid(),r.apiKey=t,r},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.1",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.AWTPropertyType=i.AWTPropertyType,t.AWTPiiKind=i.AWTPiiKind,t.AWTEventPriority=i.AWTEventPriority,t.AWTEventsDroppedReason=i.AWTEventsDroppedReason,t.AWTEventsRejectedReason=i.AWTEventsRejectedReason,t.AWTCustomerContentKind=i.AWTCustomerContentKind;var r=n(6);t.AWTUserIdType=r.AWTUserIdType,t.AWTSessionState=r.AWTSessionState;var o=n(14);t.AWT_BEST_EFFORT=o.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=o.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=o.AWT_REAL_TIME;var s=n(5);t.AWTEventProperties=s.default;var a=n(13);t.AWTLogger=a.default;var u=n(11);t.AWTLogManager=u.default;var c=n(29);t.AWTTransmissionManager=c.default;var l=n(9);t.AWTSerializer=l.default;var d=n(8);t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(19),o=n(22);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},t._Base64_GetString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=e.length%3,r=0,o=e.length-i;r<o;r+=3)s=(e[r]<<16)+(e[r+1]<<8)+e[r+2],n.push(function(e){return[t.charAt(e>>18&63),t.charAt(e>>12&63),t.charAt(e>>6&63),t.charAt(63&e)].join("")}(s));switch(i){case 1:var s=e[e.length-1];n.push(t.charAt(s>>2)),n.push(t.charAt(s<<4&63)),n.push("==");break;case 2:var a=(e[e.length-2]<<8)+e[e.length-1];n.push(t.charAt(a>>10)),n.push(t.charAt(a>>4&63)),n.push(t.charAt(a<<2&63)),n.push("=")}return n.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],i=0;i<8;++i)n.push(t.getUint8(i));return n}return r.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=i.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,r=n<<1|t>>>31,o=t<<1;2147483648&n&&(r=~r,o=~o);var s=new i.UInt64("0");return s.low=o,s.high=r,s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?11:8,i=t?52:23,r=(1<<n-1)-1,o=1-r,s=r,a=e<0?1:0;e=Math.abs(e);for(var u=Math.floor(e),c=e-u,l=2*(r+2)+i,d=new Array(l),_=0;_<l;)d[_++]=0;for(_=r+2;_&&u;)d[--_]=u%2,u=Math.floor(u/2);for(_=r+1;_<l-1&&c>0;)(c*=2)>=1?(d[++_]=1,--c):d[++_]=0;for(var p=0;p<l&&!d[p];)p++;var h=r+1-p,f=p+i;if(d[f+1]){for(_=f;_>p&&(d[_]=1-d[_],!d);--_);_===p&&++h}if(h>s||u)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<o)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(_=0;_<20;++_)g=g<<1|d[++p];for(var T=0;_<52;++_)T=T<<1|d[++p];return v=[255&T,T>>8&255,T>>16&255,T>>>24,255&(g=a<<31|2147483647&(g|=h+r<<20)),g>>8&255,g>>16&255,g>>>24]}var y=0;for(_=0;_<23;++_)y=y<<1|d[++p];var v=[255&(y=a<<31|2147483647&(y|=h+r<<23)),y>>8&255,y>>16&255,y>>>24];return v},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(i.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17);t._BondDataType=i._BondDataType;var r=n(18);t._Encoding=r;var o=n(20);t.IO=o;var s=n(4);t.Int64=s.Int64,t.UInt64=s.UInt64,t.Number=s.Number;var a=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=r._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=r._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(r._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=r._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?i._BondDataType._BT_STOP_BASE:i._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=r._Varint_GetBytes(s.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=r._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(s.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout(function(){return e._reset()},6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var i=1e3*parseInt(t,10),r=0;r<n.length;++r)this._killedTokenDictionary[n[r]]=Date.now()+i}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===i.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t=0,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(9),o=n(26),s=n(24),a=n(23),u=n(15),c=n(1),l=n(2),d=n(3),_="POST",p=function(){function e(e,t,n,i,r){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=i,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString,this._killSwitch=new s.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new a.default(r),c.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!c.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,i,r,s){try{if(c.useXDomainRequest()){var a=new XDomainRequest;a.open(_,e),a.onload=function(){r(200,null)},a.onerror=function(){i(400,null)},a.ontimeout=function(){n(500,null)},a.send(t)}else if(c.isReactNative())fetch(e,{body:t,method:_}).then(function(e){var t={};e.headers&&e.headers.forEach(function(e,n){t[n]=e}),r(e.status,t)}).catch(function(e){i(0,{})});else{var u=new XMLHttpRequest;u.open(_,e,!s),u.onload=function(){r(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){i(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){n(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){i(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=i.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,o){var s=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var a=0,u="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(l.default.eventsRejected(e[d],i.AWTEventsRejectedReason.KillSwitch),delete e[d]):(u.length>0&&(u+=","),u+=d,a++));if(a>0){var _=r.default.getPayloadBlob(e,a);_.remainingRequest&&this._requestQueue.push(_.remainingRequest);var p=this._urlString+"&x-apikey="+u+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(p=p+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;h=c.isUint8ArrayAvailable()?new Uint8Array(_.payloadBlob):r.default.base64Encode(_.payloadBlob);for(var d in e)if(e.hasOwnProperty(d))for(var f=0;f<e[d].length;++f)e[d][f].sendAttempt>0?e[d][f].sendAttempt++:e[d][f].sendAttempt=1;if(this._useBeacons&&n&&c.isBeaconsSupported()&&navigator.sendBeacon(p,h))return;this._httpInterface.sendPOST(p,h,function(i,r){s._retryRequestIfNeeded(i,r,h.length,e,a,u,t,n,o)},function(i,r){s._retryRequestIfNeeded(i,r,h.length,e,a,u,t,n,o)},function(i,r){s._retryRequestIfNeeded(i,r,h.length,e,a,u,t,n,o)},n||o)}else n||this._handleRequestFinished(!1,0,{},n,o)}catch(e){this._handleRequestFinished(!1,0,{},n,o)}},e.prototype._retryRequestIfNeeded=function(e,t,n,r,s,a,u,c,_){var p=this,h=!0;if(void 0!==e){if(t){var f=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var g=0;g<f.length;++g)l.default.eventsRejected(r[f[g]],i.AWTEventsRejectedReason.KillSwitch),delete r[f[g]],s--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,r,c,_);(!o.default.shouldRetryForStatus(e)||s<=0)&&(h=!1)}if(h)if(_)this._activeConnections--,r[a][0].priority=i.AWTEventPriority.High,this._queueManager.addBackRequest(r);else if(u<1){for(var T in r)r.hasOwnProperty(T)&&l.default.eventsRetrying(r[T]);setTimeout(function(){return p._sendRequest(r,u+1,!1)},o.default.getMillisToBackoffForRetry(u))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(r);else this._handleRequestFinished(!1,n,r,c,_)},e.prototype._handleRequestFinished=function(e,t,n,r,o){e&&d.default.clearBackOff();for(var s in n)n.hasOwnProperty(s)&&(e?l.default.eventsSent(n[s],t):l.default.eventsDropped(n[s],i.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,o||r||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");t[r[0]]=r[1]}return t},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(27),o=n(3),s=n(25),a=n(2),u=200,c=function(){function e(e,t,n,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[i.AWTEventPriority.High]=[],this._inboundQueues[i.AWTEventPriority.Normal]=[],this._inboundQueues[i.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new s.default(this._outboundQueue,u),this._httpManager=new r.default(this._outboundQueue,e,this,n,o)}return e.prototype.addEvent=function(e){e.priority===i.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit?this._addEventToProperQueue(e):this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):a.default.eventsDropped([e],i.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[i.AWTEventPriority.High][0].length>0||this._inboundQueues[i.AWTEventPriority.Normal][0].length>0||this._inboundQueues[i.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):a.default.eventsDropped([e[t][n]],i.AWTEventsDroppedReason.NonRetryableStatus);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(i.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout(function(){return t._uploadNow(e)},0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[i.AWTEventPriority.High][0].length+this._inboundQueues[i.AWTEventPriority.Normal][0].length+this._inboundQueues[i.AWTEventPriority.Low][0].length,this._inboundQueues[i.AWTEventPriority.High][0]=[],this._inboundQueues[i.AWTEventPriority.Normal][0]=[],this._inboundQueues[i.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[i.AWTEventPriority.High].shift(),this._inboundQueues[i.AWTEventPriority.Normal].shift(),this._inboundQueues[i.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[i.AWTEventPriority.High].push([]),this._inboundQueues[i.AWTEventPriority.Normal].push([]),this._inboundQueues[i.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=i.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return a.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],i.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=i.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(i.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent(function(){t._removeFirstQueues(),null!==e&&void 0!==e&&e(),t._uploadNowQueue.length>0?setTimeout(function(){return t._uploadNow(t._uploadNowQueue.shift())},0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())})},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(e)},250)},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=function(){function e(){}return e.setEventsHandler=function(e){i.default.setEventsHandler(e)},e.getEventsHandler=function(){return i.default.getEventsHandler()},e.scheduleTimer=function(){i.default.scheduleTimer()},e}();t.default=r},function(e,t,n){e.exports=n(16)}])});var PerfDetectWebWorker=function(){function e(){}return e.prototype.initialize=function(e){e.registerEventListener("runBenchMarkPerformanceDetectStrategy",function(){for(var t=Date.now(),n=1e5;n>0;)n--;var i={name:"handleBenchMarkPerformanceDetectStrategy",params:{elapse:Date.now()-t}};e.postMessageToUiThread(i)})},e}(),worker=self,recCount=0,OldAriaTransporter=function(){function e(e){this.enableHideAria=e,this.telemetry=new microsoft.applications.telemetry._sender.TelemetryManagerImpl,this.ariaLoggers={},microsoft.applications.telemetry.globalTelemetryManager=this.telemetry}return e.prototype.initialize=function(e){this.telemetry.Initialize(e.config),microsoft.applications.telemetry.LogManager.initialize(e.documentInfo,e.appToken)},e.prototype.start=function(){this.telemetry.Start()},e.prototype.stop=function(){this.telemetry.Stop()},e.prototype.pause=function(){this.telemetry.Pause()},e.prototype.resume=function(){this.telemetry.Resume()},e.prototype.flush=function(e){var t=this,n=8,i=function(){var r=t.telemetry._eventsCache.IsEmpty(),o=0==--n;r||o?e.postMessageToUiThread({name:"flushed"}):t.telemetry.Flush(i)};i()},e.prototype.createNewLogger=function(e,t){this.ariaLoggers[e]=new microsoft.applications.telemetry.Logger(t)},e.prototype.logEvent=function(e,t){if(e&&t){var n;if(this.enableHideAria){(n=new microsoft.applications.telemetry.EventProperties).name=t.name,n.eventType=t.eventType,n.timestamp=t.timestamp;var i=t.properties;for(var r in i){var o=i[r],s=o.pii;n.setProperty(o.name,o.value,s)}}else n=t;this.ariaLoggers[e].logEvent(n)}},e.prototype.logSession=function(e,t){var n=this.ariaLoggers[t.name],i=t.state;n.logSession(i,t.properties),e.postMessageToUiThread({name:"sessionId",params:{name:t.name,sessionId:n.getSessionId()}})},e.prototype.setContext=function(e){var t=e.pii;microsoft.applications.telemetry.LogManager.setContext(e.key,e.value,t)},e.prototype.setUserId=function(e){microsoft.applications.telemetry.LogManager.getSemanticContext().setUserId(e)},e.prototype.changeMaxPackageSizeInKB=function(e){},e.prototype.disableTestHook=function(){microsoft.applications.telemetry.LogManager.__clearTestHookListener()},e.prototype.enableTestHook=function(e,t){microsoft.applications.telemetry.LogManager.__addTestHookListener(function(n){n.forEach(function(n){if(t&&t.eventTypes&&t.eventTypes.indexOf(n.EventType)>-1){var i={};n.Extension._buffer.forEach(function(e){i[e.Key]=e.Value}),i.EventType=n.EventType,i.Type=n.Type,e.postMessageToUiThread({name:"telemetryTestHook",params:{event:i}})}})})},e}(),AwtAriaTransporter=function(){function e(){this.ariaLoggers={}}return e.prototype.initialize=function(e){var t;if(worker.AWTLogManager.initialize(e.appToken,{userAgent:e.documentInfo.userAgent,propertyStorageOverride:{getProperty:function(t){return"MicrosoftApplicationsTelemetryFirstLaunchTime"===t?""+e.documentInfo.firstLaunchTime:"MicrosoftApplicationsTelemetryDeviceId"===t?e.documentInfo.deviceId:void 0},setProperty:function(e,t){}},canSendStatEvent:function(t){return e.enableAriaStats},cacheMemorySizeLimitInNumberOfEvents:e.ariaCacheSizeInNumberOfEvents,clockSkewRefreshDurationInMins:e.clockSkewRefreshDurationInMins,enableScheduleTimerEvenWithoutEvent:e.enableScheduleTimerEvenWithoutEvent,enableTeamsStats:e.enableTeamsStats}),e.enableTeamsStats){var n=this.ariaLoggers.default;n||(this.createNewLogger("default",e.appToken),n=this.ariaLoggers.default);this.testHookListener={eventsSent:function(e,t){var i=0;e.forEach(function(e){"userbi"===e.name.toLowerCase()&&++i});var r=new worker.AWTEventProperties;r.setName("scenario"),r.setProperty("Scenario_Name","sdk_stats"),r.setProperty("AriaStats_EventRec",recCount),r.setProperty("AriaStats_EventSentUserBi",i),r.setProperty("AriaStats_EventSent",e.length),r.setProperty("AriaStats_PackageSize",t),recCount=0,n.logEvent(r)},eventsDropped:function(e,t){var i=0;e.forEach(function(e){"userbi"===e.name.toLowerCase()&&++i});var r=new worker.AWTEventProperties;r.setName("scenario"),r.setProperty("Scenario_Name","sdk_stats"),r.setProperty("AriaStats_EventDropUserBi",i),r.setProperty("AriaStats_EventDrop",e.length),r.setProperty("AriaStats_EventDropReason",t),n.logEvent(r)},eventsRejected:function(e,t){var i=0;e.forEach(function(e){"userbi"===e.name.toLowerCase()&&++i});var r=new worker.AWTEventProperties;r.setName("scenario"),r.setProperty("Scenario_Name","sdk_stats"),r.setProperty("AriaStats_EventRejectUserBi",i),r.setProperty("AriaStats_EventReject",e.length),r.setProperty("AriaStats_EventRejectReason",t),n.logEvent(r)}},worker.AWTLogManager.addNotificationListener(this.testHookListener)}var i=(t={},t.TeamsProfile=[e.lowPrioritySendTimeInSecs,e.normalPrioritySendTimeInSecs,e.highPrioritySendTimeInSecs],t);worker.AWTLogManager.loadTransmitProfiles(i),worker.AWTLogManager.setTransmitProfile("TeamsProfile");var r=worker.AWTLogManager.getSemanticContext();r.setAppLanguage(e.documentInfo.appLanguage),r.setUserLanguage(e.documentInfo.userLanguage)},e.prototype.start=function(){worker.AWTLogManager.resumeTransmision()},e.prototype.stop=function(){worker.AWTLogManager.pauseTransmission()},e.prototype.pause=function(){worker.AWTLogManager.pauseTransmission()},e.prototype.resume=function(){worker.AWTLogManager.resumeTransmision()},e.prototype.flush=function(e){worker.AWTLogManager.flush(function(){e.postMessageToUiThread({name:"flushed"})})},e.prototype.createNewLogger=function(e,t){this.ariaLoggers[e]=worker.AWTLogManager.getLogger(t)},e.prototype.logEvent=function(e,t){if(e&&t){var n=new worker.AWTEventProperties;n.setName(t.name),n.setType(t.eventType),n.setTimestamp(t.timestamp);var i=t.properties;for(var r in i){var o=i[r],s=o.pii;n.setPropertyWithPii(o.name,o.value,s)}this.ariaLoggers[e].logEvent(n)}},e.prototype.logSession=function(e,t){var n=this.ariaLoggers[t.name],i=t.state;n.logSession(i,t.properties),e.postMessageToUiThread({name:"sessionId",params:{name:t.name,sessionId:n.getSessionId()}})},e.prototype.setContext=function(e){var t=e.pii;worker.AWTLogManager.setContextWithPii(e.key,e.value,t)},e.prototype.setUserId=function(e){worker.AWTLogManager.getSemanticContext().setUserId(e)},e.prototype.changeMaxPackageSizeInKB=function(e){},e.prototype.disableTestHook=function(){},e.prototype.enableTestHook=function(e,t){this.testHookListener={eventsSent:function(n){n.forEach(function(n){if(t&&t.eventTypes&&t.eventTypes.indexOf(n.name)>-1){var i={};for(var r in n.properties){var o=n.properties[r];i[r]=o&&o.value}i.EventType=n.name,i.Type=n.type,delete i.length,e.postMessageToUiThread({name:"telemetryTestHook",params:{event:i}})}})}},worker.AWTLogManager.addNotificationListener(this.testHookListener)},e}(),TelemetryWebWorker=function(){function e(){}return e.prototype.initialize=function(e){var t=this;this.workerManager=e,e.registerEventListener("initialize",function(e){e.config&&(e.config.log=t),e.enableAwtAriaSdk?t.telemetryTransport=new AwtAriaTransporter:t.telemetryTransport=new OldAriaTransporter(e.enableHideAria),t.telemetryTransport.initialize(e)}),e.registerEventListener("start",function(e){t.telemetryTransport.start()}),e.registerEventListener("stop",function(e){t.telemetryTransport.stop()}),e.registerEventListener("flush",function(n){t.telemetryTransport.flush(e)}),e.registerEventListener("pause",function(e){t.telemetryTransport.pause()}),e.registerEventListener("resume",function(e){t.telemetryTransport.resume()}),e.registerEventListener("newLogger",function(e){t.telemetryTransport.createNewLogger(e.name,e.token)}),e.registerEventListener("changeMaxPackageSizeInKB",function(e){t.telemetryTransport.changeMaxPackageSizeInKB(e.size)}),e.registerEventListener("logEvent",function(e){++recCount,t.telemetryTransport.logEvent(e.name,e.eventProperties)}),e.registerEventListener("logSession",function(e){t.telemetryTransport.logSession(t.workerManager,e)}),e.registerEventListener("setContext",function(e){t.telemetryTransport.setContext(e)}),e.registerEventListener("setUserId",function(e){t.telemetryTransport.setUserId(e.id)}),e.registerEventListener("disableTestHook",function(e){t.telemetryTransport.disableTestHook()}),e.registerEventListener("enableTestHook",function(n){t.telemetryTransport.enableTestHook(e,n)})},e.prototype.Verbose=function(e){},e.prototype.Info=function(e){this.workerManager&&this.workerManager.logInfo(e)},e.prototype.Error=function(e){this.workerManager&&this.workerManager.logError(e)},e}(),WebWorkerManager=function(){function e(){var e=this;this.messageHandlers={},this.worker=self,this.worker.addEventListener("message",function(t){if(t&&t.data&&t.data.name){var n=e.messageHandlers[t.data.name];n?n(t.data.params):e.logError("Unhandled webworker message - "+JSON.stringify(t.data))}})}return e.prototype.setupRegistrations=function(e){for(var t=0,n=e;t<n.length;t++)n[t].initialize(this)},e.prototype.registerEventListener=function(e,t){this.messageHandlers[e]?this.logError("Detected duplicate event listener registered to the same key: "+e+"!"):this.messageHandlers[e]=t},e.prototype.postMessageToUiThread=function(e){this.worker.postMessage(e)},e.prototype.logInfo=function(e){this.worker.postMessage({name:"info",params:{msg:e}})},e.prototype.logError=function(e){this.worker.postMessage({name:"error",params:{msg:e}})},e}(),webWorkerManager1=new WebWorkerManager;webWorkerManager1.setupRegistrations([new TelemetryWebWorker,new PerfDetectWebWorker]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/webworker.js-07f4db20.map