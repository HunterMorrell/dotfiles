webpackJsonp([22],{1692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1693)},1693:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=n(1694),s=n(1695),u=n(1696),c=function(){function e(e,t,n,r,i,o,a){this.constants=e,this.utilityService=t,this.settingsService=n,this.authenticationService=r,this.logger=i,this.actionCallbacks=o,this.dataCallbacks=a}return Object.defineProperty(e.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLivePersonaCardEnabled",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),e.prototype.initializeLPC=function(){return i(this,void 0,void 0,function(){var e,t,n;return o(this,function(i){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];e=this.utilityService.generateUUID(),t=this.getTeamsConfig(e);try{return this.lpcPromise=a.initializeLivePersonaCard(r({},t,{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,getAuthToken:this.getAuthToken(e),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)}})),[2,this.lpcPromise]}catch(e){throw n="Could not load live persona card: "+e,new Error(n)}return[2]})})},e.prototype.createLPC=function(e,t){var n=t.profile,i=t.olsPersonaId,o=t.locationId,a=t.externalAppSessionCorrelationId,s=t.behavior;{if(this.isLivePersonaCardInitialized){var u={personaInfo:{identifiers:{PersonaType:"BOT"===n.type?"NotResolved":"User",HostAppPersonaId:n.mri,PersonaAadObjectId:n.objectId,Smtp:n.userPrincipalName,OlsPersonaId:i,LocationId:o},displayName:n.displayName,firstName:n.givenName,lastName:n.surname},behavior:r({disableHover:!1,locationToOpen:"Card"},s),externalAppSessionCorrelationId:a};return window.LPC.addedPersonaToPageV2(e,u),{destroy:function(){window.LPC.removedPersonaFromPage(e)}}}this.logger.error("Not initialized")}},e.prototype.getTeamsConfig=function(e){return{culture:window.navigator.language||"en-us",region:"df",clientCorrelationId:e,clientType:"MicrosoftTeams",clientContextType:"Generic",options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!0}}},e.prototype.getAuthToken=function(e){var t=this;return function(n,r){return i(t,void 0,void 0,function(){var t,i;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.authenticationService.getAuthTokens(["https://loki.delve.office.com/"])];case 1:return t=o.sent(),n(t,e),[3,3];case 2:return i=o.sent(),r(i,e),[3,3];case 3:return[2]}})})}},e}();t.LivePersonaCardService=c,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService"]).factory("lpcService",["constants","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","messageService","peopleService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService",function(e,t,n,r,i,o,a,l,f,p,d,h,v,g,y,m,w,b){var C=r.newLogger("LivePersonaCardService"),S=s.LPCActionCallbackFactory(o,e,C,p,l,a,d,f),P=u.LPCDataCallbackFactory(C,h,t,v,g,n,e,y,m,w,b);return new c(e,t,n,i,C,S,P)}])},1694:function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=22)}([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){return function(e,t,n,r,i){this.type=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i}}()},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r,i=n(3),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(20),u=function(){function e(e){this.bootstrapperConfig=e,this.ariaCdnUrl="https://res.delve.office.com/lpc/versionless/aria-webjs-sdk-1.6.0.min.js",this.logManager=void 0,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return(n=o.sent()).logEvent(e),[4,this.getLogManagerAsync()];case 2:return(r=o.sent()).flush(this.noOp),[3,4];case 3:return i=o.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return o(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=i.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[2,n];case 2:throw r=i.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return o(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return(t=this.loggers.get(e))?[3,2]:[4,this.getLogManagerAsync()];case 1:n=r.sent(),t=n.getLogger(e),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion",s),r.label=2;case 2:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=this,(t=this.logManager||this.bootstrapperConfig.awtLogManager||window.AWTLogManager)?[3,2]:[4,this.getLogManagerFromCdnAsync()];case 1:t=n.sent(),n.label=2;case 2:return e.logManager=t,[2,this.logManager]}})})},e.prototype.getLogManagerFromCdnAsync=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.i(i.a)(this.ariaCdnUrl)];case 1:return t.sent(),window.AWTLogManager.initialize(e.AriaLPCBootstrapperTenantToken),[2,window.AWTLogManager]}})})},e.prototype.noOp=function(){},e}();u.AriaLPCBootstrapperTenantToken="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"},function(e,t,n){"use strict";t.a=function(e,t){return new Promise(function(o,s){e?(n.i(r.a)(a,e),o(e)):t(function(e,t){e?(n.i(r.a)(a,e),o(e)):s(new i.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){s(new i.a("GetAuthTokenError",e,t))})})},t.b=function(e){if(!e)throw Error("Empty AuthToken");var t=o(e);return{tenantId:t.tid,userAadId:t.oid,userPuid:t.puid,expirationTimeEpoch:t.exp}};var r=n(16),i=n(0),o=n(8),a=(n.n(o),"LokiAuthToken")},function(e,t,n){"use strict";function r(e){return a(this,void 0,void 0,function(){var t;return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,6]),[4,i(e)];case 1:return n.sent(),[3,6];case 2:return t=n.sent(),c<u?(c++,[4,r(e)]):[3,4];case 3:return n.sent(),[3,5];case 4:throw t.numberOfRetries=c,t;case 5:return[3,6];case 6:return[2]}})})}function i(e){return new Promise(function(t,n){var r=document.createElement("script");r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",function(){t()}),r.addEventListener("error",function(){n(new o.a("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(r)})}t.a=r;var o=n(0),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},u=2,c=0},function(e,t,n){"use strict";function r(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function i(e){return{ErrorType:e.type,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLivePersonaCard=function(e,t,o){if(!v&&h)return h;var y=p.a.getOrCreate(e);return v=!1,(h=new Promise(function(h,v){try{var g,m,w=new f.a;n.i(l.a)(e).then(function(){return n.i(s.a)(e.authToken,e.getAuthToken)}).then(function(t){return w.measureFromStart(f.b.getAuthToken),m=n.i(s.b)(t),e.tenantAadObjectId=m.tenantId,e.userAadObjectId=m.userAadId,e.userPuid=m.userPuid,n.i(a.a)(t,e)}).then(function(e){return w.measureFromStart(f.b.getLokiConfig),g=e,y.updateContextWithLokiDataAsync(g,p.a.AriaLPCBootstrapperTenantToken).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})}).then(function(){return n.i(c.a)(g)}).then(function(){return w.measureFromStart(f.b.getLpcBundles),n.i(u.a)(g,e,w)}).then(function(){var e=r(w.getAllTimings());e.RootCorrelationId=g.RootCorrelationId,y.logEventAsync({name:"initializeLivePersonaCard_success",properties:e},p.a.AriaLPCBootstrapperTenantToken),t&&t(),h()}).catch(function(e){var t=r(w.getAllTimings());y.logEventAsync({name:"initializeLivePersonaCard_failure",properties:d({},i(e),t)},p.a.AriaLPCBootstrapperTenantToken),o&&o("Failed to initialize Live Persona Card: "+e.type),v("Failed to initialize Live Persona Card: "+e.type)})}catch(e){y.logEventAsync({name:"initializeLivePersonaCard_failure",properties:{IsCatastrophic:!0,Reason:e.toString()}},p.a.AriaLPCBootstrapperTenantToken),o&&o("Failed to initialize Live Persona Card: "+e.name+" "+e.message),v("Failed to initialize Live Persona Card: "+e.name+" "+e.message)}})).catch(function(){setTimeout(function(){v=!0},g)}),h},t.fetchLokiConfig=function(e){return n.i(s.a)(e.authToken,e.getAuthToken).then(function(t){return n.i(a.a)(t,e)})};var o=n(5),a=(n.n(o),n(10)),s=n(2),u=n(12),c=n(11),l=n(18),f=n(15),p=n(1),d=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};n.i(o.polyfill)();var h,v=!1,g=3e5},function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(0,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function o(){return void 0!==X?function(){X(s)}:a()}function a(){var e=setTimeout;return function(){return e(s,1)}}function s(){for(var e=0;e<F;e+=2)(0,V[e])(V[e+1]),V[e]=void 0,V[e+1]=void 0;F=0}function u(e,t){var n=arguments,r=this,i=new this.constructor(l);void 0===i[J]&&L(i);var o=r._state;return o?function(){var e=n[o-1];D(function(){return x(o,i,e,r._result)})}():S(r,i,e,t),i}function c(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(l);return m(n,e),n}function l(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function d(e){try{return e.then}catch(e){return Q.error=e,Q}}function h(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function v(e,t,n){D(function(e){var r=!1,i=h(n,t,function(n){r||(r=!0,t!==n?m(e,n):b(e,n))},function(t){r||(r=!0,C(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,C(e,i))},e)}function g(e,t){t._state===$?b(e,t._result):t._state===K?C(e,t._result):S(t,void 0,function(t){return m(e,t)},function(t){return C(e,t)})}function y(e,t,n){t.constructor===e.constructor&&n===u&&t.constructor.resolve===c?g(e,t):n===Q?(C(e,Q.error),Q.error=null):void 0===n?b(e,t):i(n)?v(e,t,n):b(e,t)}function m(t,n){t===n?C(t,f()):e(n)?y(t,n,d(n)):b(t,n)}function w(e){e._onerror&&e._onerror(e._result),P(e)}function b(e,t){e._state===Y&&(e._result=t,e._state=$,0!==e._subscribers.length&&D(P,e))}function C(e,t){e._state===Y&&(e._state=K,e._result=t,D(w,e))}function S(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+$]=n,i[o+K]=r,0===o&&e._state&&D(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?x(n,r,i,o):i(o);e._subscribers.length=0}}function k(){this.error=null}function T(e,t){try{return e(t)}catch(e){return Z.error=e,Z}}function x(e,t,n,r){var o=i(n),a=void 0,s=void 0,u=void 0,c=void 0;if(o){if((a=T(n,r))===Z?(c=!0,s=a.error,a.error=null):u=!0,t===a)return void C(t,p())}else a=r,u=!0;t._state!==Y||(o&&u?m(t,a):c?C(t,s):e===$?b(t,a):e===K&&C(t,a))}function A(e,t){try{t(function(t){m(e,t)},function(t){C(e,t)})}catch(t){C(e,t)}}function _(){return ee++}function L(e){e[J]=ee++,e._state=void 0,e._result=void 0,e._subscribers=[]}function O(e,t){this._instanceConstructor=e,this.promise=new e(l),this.promise[J]||L(this.promise),R(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&b(this.promise,this._result))):C(this.promise,I())}function I(){return new Error("Array Methods must be provided an Array")}function E(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(e){this[J]=_(),this._result=this._state=void 0,this._subscribers=[],l!==e&&("function"!=typeof e&&E(),this instanceof U?A(this,e):M())}var j=void 0,R=j=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},F=0,X=void 0,B=void 0,D=function(e,t){V[F]=e,V[F+1]=t,2===(F+=2)&&(B?B(s):W())},z="undefined"!=typeof window?window:void 0,N=z||{},H=N.MutationObserver||N.WebKitMutationObserver,G="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3),W=void 0;W=G?function(){return t.nextTick(s)}:H?function(){var e=0,t=new H(s),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():q?function(){var e=new MessageChannel;return e.port1.onmessage=s,function(){return e.port2.postMessage(0)}}():void 0===z?function(){try{var e=n(21);return X=e.runOnLoop||e.runOnContext,o()}catch(e){return a()}}():a();var J=Math.random().toString(36).substring(16),Y=void 0,$=1,K=2,Q=new k,Z=new k,ee=0;return O.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===Y&&n<e;n++)this._eachEntry(t[n],n)},O.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===c){var i=d(e);if(i===u&&e._state!==Y)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===U){var o=new n(l);y(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},O.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===Y&&(this._remaining--,e===K?C(r,n):this._result[t]=n),0===this._remaining&&b(r,this._result)},O.prototype._willSettleAt=function(e,t){var n=this;S(e,void 0,function(e){return n._settledAt($,t,e)},function(e){return n._settledAt(K,t,e)})},U.all=function(e){return new O(this,e).promise},U.race=function(e){var t=this;return new t(R(e)?function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},U.resolve=c,U.reject=function(e){var t=new this(l);return C(t,e),t},U._setScheduler=function(e){B=e},U._setAsap=function(e){D=e},U._asap=D,U.prototype={constructor:U,then:u,catch:function(e){return this.then(null,e)}},U.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=U},U.Promise=U,U})}).call(t,n(9),n(19))},function(e,t){function n(e){this.message=e}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,a=0,s=0,u="";o=t.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)?u+=String.fromCharCode(255&i>>(-2*a&6)):0)o=r.indexOf(o);return u}},function(e,t,n){function r(e){return decodeURIComponent(i(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}var i=n(6);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return r(t)}catch(e){return i(t)}}},function(e,t,n){"use strict";function r(e){this.message=e}var i=n(7);(r.prototype=new Error).name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?h=d.concat(h):g=-1,h.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=h.length;t;){for(d=h,h=[];++g<t;)d&&d[g].run();g=-1,t=h.length}d=null,v=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,p=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,h=[],v=!1,g=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||v||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){"use strict";function r(e,t){return l(this,void 0,void 0,function(){var o,a;return f(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,8]),[4,i(e,t)];case 1:return o=s.sent(),[3,8];case 2:return(a=s.sent()).statusCode&&401===a.statusCode?[4,n.i(c.a)(void 0,t.getAuthToken)]:[3,4];case 3:e=s.sent(),s.label=4;case 4:return m<y?(m++,[4,r(e,t)]):[3,6];case 5:return o=s.sent(),[3,7];case 6:throw a.numberOfRetries=m,a;case 7:return[3,8];case 8:return[2,o]}})})}function i(e,t){return new Promise(function(r,i){var c=new XMLHttpRequest,l=o(t);c.open("GET",l,!0),c.setRequestHeader("authToken",e),c.setRequestHeader("Accept","application/json");var f=n.i(s.a)();c.setRequestHeader("X-RootCorrelationId",f),c.setRequestHeader("X-CorrelationId",f),c.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),c.setRequestHeader("X-ClientType",t.clientType);var p=n.i(a.a)(v);p&&c.setRequestHeader(v,p),c.addEventListener("load",function(){if(200===c.status)try{var e=JSON.parse(c.response);e.RootCorrelationId=f,e.LokiVersion=c.getResponseHeader("x-serverversion")||"",r(e)}catch(e){i(new u.a("GetLokiConfigError","Failed to parse initialization config.",f))}else i(new u.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+c.status,f,c.status))}),c.addEventListener("error",function(){i(new u.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",f))}),c.addEventListener("timeout",function(){i(new u.a("GetLokiConfigError","Loki config request timed out after "+h+" ms.",f))}),c.timeout=h,c.send()})}function o(e){var t=n.i(a.a)(g)||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?p.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):d.replace("{0}",e.clientType).replace("{1}",t)}t.a=r;var a=n(14),s=n(13),u=n(0),c=n(2),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},p="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",d="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",h=6e4,v="LivePersonaCardVersionOverride",g="LivePersonaCardCultureOverride",y=2,m=0},function(e,t,n){"use strict";t.a=function(e){var t,s=e.Resources[a];return t="OwaPeopleHub"===e.Workload?e.Resources[o]:e.Resources[i],Promise.all([n.i(r.a)(s),n.i(r.a)(t)])};var r=n(3),i="livepersonacard_with-react",o="livepersonacard_without-react",a="livepersonacardstrings"},function(e,t,n){"use strict";function r(e,t,n){return{refreshAuthToken:i(t),logToExternalApplication:t.logMessage,logToExternalAria:function(e,n){a.a.getOrCreate(t).logEventAsync(e,n)},contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,performanceTimings:n.getAllTimings(),isDebug:!1,region:t.region,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,privateActionCallbacks:t.privateActionCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:t.tenantAadObjectId,userAadObjectId:t.userAadObjectId,userPuid:t.userPuid}}function i(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}t.a=function(e,t,n){return new Promise(function(i,a){setTimeout(function(){window.LPC||a(new o.a("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||a(new o.a("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));try{var s=r(e,t,n);window.LPC.start(s),i()}catch(e){a(new o.a("StartLivePersonaCardError",e.name+" "+e.message))}},0)})};var o=n(0),a=n(1)},function(e,t,n){"use strict";t.a=function(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})};var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"},function(e,t,n){"use strict";t.a=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r;!function(e){e.getAuthToken="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesFromStartDuration"}(r||(r={}));var i=function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.getAllTimings=function(){var e=this;if(window.performance&&"function"==typeof window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";t.a=function(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}},function(e,t,n){"use strict";t.a=function(e){return void 0===e||"string"!=typeof e||""===e||null===e},t.b=function(e){return void 0===e||"function"!=typeof e}},function(e,t,n){"use strict";function r(e){var t="";if(e){var r=[];n.i(i.a)(e.culture)&&r.push("culture"),n.i(i.a)(e.clientType)&&r.push("clientType"),n.i(i.a)(e.clientContextType)&&r.push("clientContextType"),n.i(i.a)(e.clientCorrelationId)&&r.push("clientCorrelationId"),n.i(i.b)(e.logMessage)&&r.push("logMessage"),n.i(i.b)(e.getAuthToken)&&r.push("getAuthToken"),r.length>0&&(t="Invalid required parameter(s): "+r.join(", ")+". Check the values and types you're passing."),e.region&&-1===a.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+a.join(", ")+" for pre-production environments.")}else t="Config must be defined.";return t}t.a=function(e){return new Promise(function(t,n){var i=r(e);i?n(new o.a("ValidateBootstrapperConfigError",i)):t()})};var i=n(17),o=n(0),a=["msit","df","ppe"]},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports="1.5.2"},function(e,t){},function(e,t,n){e.exports=n(4)}])})},1695:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=this;Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},s=function(e,t){return function(n,a){return void 0===a&&(a=!1),r(o,void 0,void 0,function(){var r;return i(this,function(i){return(r=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:r.id,withVideo:a,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},u=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var o=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:o,externalId:null,draftObjectId:null,inlineImages:null})}},c=function(e,t,n,a,s){return function(u,c){return r(o,void 0,void 0,function(){var r,o,l,f,p;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),r=e.scenarios.people.livePersonaCardStartChat,[4,n.getAllLatestPeopleProfile([u.hostAppPersonaId],r,!1)];case 1:return o=i.sent()[0],l=a.getPrivateChatUserMri(o,r),[4,s({groupName:o.displayName,peopleSlug:l,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),c(!0),[3,4];case 3:return f=i.sent(),p="Failed to navigate to chat",t.error(p),c(!1,p),[3,4];case 4:return[2]}})})}},l=function(e,t,n,a,s){return function(a,u){return r(o,void 0,void 0,function(){var r,o,c,l;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),r=e.scenarios.people.livePersonaCardOrgChart,[4,n.getAllLatestPeopleProfile([a.HostAppPersonaId],r,!1)];case 1:return o=i.sent()[0],[4,s({groupName:o.displayName,slug:a.HostAppPersonaId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),u(!0),[3,4];case 3:return c=i.sent(),l="Failed to navigate to org chat",t.error(l),u(!1,l),[3,4];case 4:return[2]}})})}},f=function(e,t){return function(n,a){return r(o,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(n.HostAppPersonaId)];case 1:return i.sent(),a(!0),[3,3];case 2:return r=i.sent(),o="Failed to start audio call with",e.error(o),a(!1,o),[3,3];case 3:return[2]}})})}},p=function(e,t){return function(n,a){return r(o,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(n.HostAppPersonaId,!0)];case 1:return i.sent(),a(!0),[3,3];case 2:return r=i.sent(),o="Failed to start video call with",e.error(o),a(!1,o),[3,3];case 3:return[2]}})})}},d=function(e,t){return function(n,a,s){return r(o,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",a&&a.length),[4,t(n.HostAppPersonaId,a)];case 1:return i.sent(),s(!0),[3,3];case 2:return r=i.sent(),o="Failed to send message",e.error(o),s(!1,o),[3,3];case 3:return[2]}})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,o,h,v){var g=a(t,e,o),y=s(i,h),m=u(i,v);return{startChat:c(t,n,r,i,g),showOrgChart:l(t,n,r,0,g),sendQuickMessage:d(n,m),startVideoCall:p(n,y),startAudioCall:f(n,y)}}},1696:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1697),i=function(e){return function(e,t){t(void 0)}},o=function(e){switch(e){case SkypeX.Services.UserStatus.Online:return r.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Unknown:return r.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return r.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return r.PersonaPresence.busy;case SkypeX.Services.UserStatus.Presenting:return r.PersonaPresence.dnd;default:return r.PersonaPresence.offline}},a=function(e,t,n,r,i,o,a){var s=e.status,u=e.calendarData,c=e.lastSeenAt;if(t.valueAsBoolean(i.settings.names.enableOutOfOfficeInfo)&&t.valueAsBoolean(i.settings.names.enableOutOfOfficeUpdates)&&u&&u.isOutOfOffice)switch(s){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:return r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(s),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:return a.transformIntoTimeago(c);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(s){case SkypeX.Services.UserStatus.Away:return a.transformIntoTimeago(c);default:return n.GetTranslatedStatusText(s)}},s=function(e,t,n,r,i){var o="";return t.valueAsBoolean(n.settings.names.enableOutOfOfficeInfo)&&(e.status===SkypeX.Services.UserStatus.OutOfOffice||t.valueAsBoolean(n.settings.names.enableOutOfOfficeUpdates))&&e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o},u=function(e,t,n,r,i,o){var a={message:"",publishTime:""};if(t.valueAsBoolean(n.settings.names.enableCustomNote)&&e.note){var u=e.note.message,c=e.note.publishTime;if(c){var l=new Date(c);c=o.getMessageDisplayableDateTime(l)}if(u){var f=r.stripHtml(i.sanitizeHtml(u)).trim(),p=s(e,t,n,r,i);f.length&&!p.length&&(a.message=f),a.publishTime=c||""}}return a},c=function(e,t,n,r,i,c,l,f,p,d){return function(h,v){var g=e.getPresence(h.HostAppPersonaId);v({presence:o(g.status),oofMessage:s(g,i,c,t,n),presenceText:a(g,i,l,f,c,p,d),statusNote:u(g,i,c,t,n,r)},void 0)}};t.LPCDataCallbackFactory=function(e,t,n,r,o,a,s,u,l,f,p){return{getAndPrefetchPersonaImageUri:i(),getRichPresence:c(t,n,r,o,a,s,u,l,f,p)}}},1697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}))}},[1692]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/lazy-ng1-mod-lpc-services.min.js-af1f0c52.map